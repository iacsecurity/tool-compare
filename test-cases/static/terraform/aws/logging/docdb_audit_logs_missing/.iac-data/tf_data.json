{"builtins":[{"decl":{"args":[{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"abs"},{"decl":{"args":[{"of":[{"of":{"type":"any"},"type":"set"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"all"},{"decl":{"args":[{"of":{"type":"any"},"type":"set"},{"of":{"type":"any"},"type":"set"}],"result":{"of":{"type":"any"},"type":"set"},"type":"function"},"infix":"\u0026","name":"and"},{"decl":{"args":[{"of":[{"of":{"type":"any"},"type":"set"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"any"},{"decl":{"args":[{"dynamic":{"type":"any"},"type":"array"},{"dynamic":{"type":"any"},"type":"array"}],"result":{"dynamic":{"type":"any"},"type":"array"},"type":"function"},"name":"array.concat"},{"decl":{"args":[{"dynamic":{"type":"any"},"type":"array"},{"type":"number"},{"type":"number"}],"result":{"dynamic":{"type":"any"},"type":"array"},"type":"function"},"name":"array.slice"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":":=","name":"assign"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"base64.decode"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"base64.encode"},{"decl":{"args":[{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"base64.is_valid"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"base64url.decode"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"base64url.encode"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"base64url.encode_no_pad"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"bits.and"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"bits.lsh"},{"decl":{"args":[{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"bits.negate"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"bits.or"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"bits.rsh"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"bits.xor"},{"decl":{"args":[{"type":"any"}],"result":{"dynamic":{"type":"any"},"type":"array"},"type":"function"},"name":"cast_array"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"cast_boolean"},{"decl":{"args":[{"type":"any"}],"result":{"type":"null"},"type":"function"},"name":"cast_null"},{"decl":{"args":[{"type":"any"}],"result":{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},"type":"function"},"name":"cast_object"},{"decl":{"args":[{"type":"any"}],"result":{"of":{"type":"any"},"type":"set"},"type":"function"},"name":"cast_set"},{"decl":{"args":[{"type":"any"}],"result":{"type":"string"},"type":"function"},"name":"cast_string"},{"decl":{"args":[{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"ceil"},{"decl":{"args":[{"type":"string"},{"of":[{"of":{"type":"string"},"type":"set"},{"dynamic":{"type":"string"},"type":"array"}],"type":"any"}],"result":{"type":"string"},"type":"function"},"name":"concat"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"contains"},{"decl":{"args":[{"of":[{"of":{"type":"any"},"type":"set"},{"dynamic":{"type":"any"},"type":"array"},{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"type":"string"}],"type":"any"}],"result":{"type":"number"},"type":"function"},"name":"count"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"crypto.md5"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"crypto.sha1"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"crypto.sha256"},{"decl":{"args":[{"type":"string"}],"result":{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"},"type":"function"},"name":"crypto.x509.parse_certificate_request"},{"decl":{"args":[{"type":"string"}],"result":{"dynamic":{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"},"type":"array"},"type":"function"},"name":"crypto.x509.parse_certificates"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"infix":"/","name":"div"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"endswith"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":"=","name":"eq"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":"==","name":"equal"},{"decl":{"args":[{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"floor"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"string"},"type":"function"},"name":"format_int"},{"decl":{"args":[{"type":"string"},{"dynamic":{"type":"string"},"type":"array"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"glob.match"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"glob.quote_meta"},{"decl":{"args":[{"dynamic":{"key":{"type":"any"},"value":{"of":[{"of":{"type":"any"},"type":"set"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}},"type":"object"},{"of":[{"of":{"type":"any"},"type":"set"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}],"result":{"of":{"type":"any"},"type":"set"},"type":"function"},"name":"graph.reachable"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":"\u003e","name":"gt"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":"\u003e=","name":"gte"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"hex.decode"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"hex.encode"},{"decl":{"args":[{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"}],"result":{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},"type":"function"},"name":"http.send"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"number"},"type":"function"},"name":"indexof"},{"decl":{"args":[{"of":{"of":{"type":"any"},"type":"set"},"type":"set"}],"result":{"of":{"type":"any"},"type":"set"},"type":"function"},"name":"intersection"},{"decl":{"args":[{"type":"string"}],"result":{"static":[{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"type":"string"}],"type":"array"},"type":"function"},"name":"io.jwt.decode"},{"decl":{"args":[{"type":"string"},{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"}],"result":{"static":[{"type":"boolean"},{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"}],"type":"array"},"type":"function"},"name":"io.jwt.decode_verify"},{"decl":{"args":[{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"},{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"},{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"}],"result":{"type":"string"},"type":"function"},"name":"io.jwt.encode_sign"},{"decl":{"args":[{"type":"string"},{"type":"string"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"io.jwt.encode_sign_raw"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_es256"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_es384"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_es512"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_hs256"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_hs384"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_hs512"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_ps256"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_ps384"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_ps512"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_rs256"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_rs384"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"io.jwt.verify_rs512"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"is_array"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"is_boolean"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"is_null"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"is_number"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"is_object"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"is_set"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"is_string"},{"decl":{"args":[{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"of":[{"dynamic":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"array"},{"of":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"set"}],"type":"any"}],"result":{"type":"any"},"type":"function"},"name":"json.filter"},{"decl":{"args":[{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"json.is_valid"},{"decl":{"args":[{"type":"any"}],"result":{"type":"string"},"type":"function"},"name":"json.marshal"},{"decl":{"args":[{"type":"any"},{"dynamic":{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"static":[{"key":"op","value":{"type":"string"}},{"key":"path","value":{"type":"any"}}],"type":"object"},"type":"array"}],"result":{"type":"any"},"type":"function"},"name":"json.patch"},{"decl":{"args":[{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"of":[{"dynamic":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"array"},{"of":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"set"}],"type":"any"}],"result":{"type":"any"},"type":"function"},"name":"json.remove"},{"decl":{"args":[{"type":"string"}],"result":{"type":"any"},"type":"function"},"name":"json.unmarshal"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"lower"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":"\u003c","name":"lt"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":"\u003c=","name":"lte"},{"decl":{"args":[{"of":[{"of":{"type":"any"},"type":"set"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}],"result":{"type":"any"},"type":"function"},"name":"max"},{"decl":{"args":[{"of":[{"of":{"type":"any"},"type":"set"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}],"result":{"type":"any"},"type":"function"},"name":"min"},{"decl":{"args":[{"of":[{"type":"number"},{"of":{"type":"any"},"type":"set"}],"type":"any"},{"of":[{"type":"number"},{"of":{"type":"any"},"type":"set"}],"type":"any"}],"result":{"of":[{"type":"number"},{"of":{"type":"any"},"type":"set"}],"type":"any"},"type":"function"},"infix":"-","name":"minus"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"infix":"*","name":"mul"},{"decl":{"args":[{"type":"any"},{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"infix":"!=","name":"neq"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"net.cidr_contains"},{"decl":{"args":[{"of":[{"type":"string"},{"dynamic":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"array"},{"of":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"set"},{"dynamic":{"key":{"type":"string"},"value":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}},"type":"object"}],"type":"any"},{"of":[{"type":"string"},{"dynamic":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"array"},{"of":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"},"type":"set"},{"dynamic":{"key":{"type":"string"},"value":{"of":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"type":"any"}},"type":"object"}],"type":"any"}],"result":{"of":{"static":[{"type":"any"},{"type":"any"}],"type":"array"},"type":"set"},"type":"function"},"name":"net.cidr_contains_matches"},{"decl":{"args":[{"type":"string"}],"result":{"of":{"type":"string"},"type":"set"},"type":"function"},"name":"net.cidr_expand"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"net.cidr_intersects"},{"decl":{"args":[{"of":[{"dynamic":{"of":[{"type":"string"}],"type":"any"},"type":"array"},{"of":{"type":"string"},"type":"set"}],"type":"any"}],"result":{"of":{"type":"string"},"type":"set"},"type":"function"},"name":"net.cidr_merge"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"net.cidr_overlap"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"dynamic":{"type":"number"},"type":"array"},"type":"function"},"name":"numbers.range"},{"decl":{"args":[{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"of":[{"dynamic":{"type":"any"},"type":"array"},{"of":{"type":"any"},"type":"set"},{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"}],"type":"any"}],"result":{"type":"any"},"type":"function"},"name":"object.filter"},{"decl":{"args":[{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"type":"any"},{"type":"any"}],"result":{"type":"any"},"type":"function"},"name":"object.get"},{"decl":{"args":[{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"of":[{"dynamic":{"type":"any"},"type":"array"},{"of":{"type":"any"},"type":"set"},{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"}],"type":"any"}],"result":{"type":"any"},"type":"function"},"name":"object.remove"},{"decl":{"args":[{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"},{"dynamic":{"key":{"type":"any"},"value":{"type":"any"}},"type":"object"}],"result":{"type":"any"},"type":"function"},"name":"object.union"},{"decl":{"result":{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"},"type":"function"},"name":"opa.runtime"},{"decl":{"args":[{"of":{"type":"any"},"type":"set"},{"of":{"type":"any"},"type":"set"}],"result":{"of":{"type":"any"},"type":"set"},"type":"function"},"infix":"|","name":"or"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"infix":"+","name":"plus"},{"decl":{"args":[{"of":[{"of":{"type":"number"},"type":"set"},{"dynamic":{"type":"number"},"type":"array"}],"type":"any"}],"result":{"type":"number"},"type":"function"},"name":"product"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"re_match"},{"decl":{"args":[{"type":"string"},{"type":"string"},{"type":"number"}],"result":{"dynamic":{"dynamic":{"type":"string"},"type":"array"},"type":"array"},"type":"function"},"name":"regex.find_all_string_submatch_n"},{"decl":{"args":[{"type":"string"},{"type":"string"},{"type":"number"}],"result":{"dynamic":{"type":"string"},"type":"array"},"type":"function"},"name":"regex.find_n"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"regex.globs_match"},{"decl":{"args":[{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"regex.is_valid"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"regex.match"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"dynamic":{"type":"string"},"type":"array"},"type":"function"},"name":"regex.split"},{"decl":{"args":[{"type":"string"},{"type":"string"},{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"regex.template_match"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"dynamic":{"key":{"type":"string"},"value":{"type":"any"}},"type":"object"},"type":"function"},"name":"rego.parse_module"},{"decl":{"args":[{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"infix":"%","name":"rem"},{"decl":{"args":[{"type":"string"},{"type":"string"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"replace"},{"decl":{"args":[{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"round"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"number"},"type":"function"},"name":"semver.compare"},{"decl":{"args":[{"type":"any"}],"result":{"type":"boolean"},"type":"function"},"name":"semver.is_valid"},{"decl":{"args":[{"of":{"type":"any"},"type":"set"},{"of":{"type":"any"},"type":"set"}],"result":{"of":{"type":"any"},"type":"set"},"type":"function"},"name":"set_diff"},{"decl":{"args":[{"of":[{"dynamic":{"type":"any"},"type":"array"},{"of":{"type":"any"},"type":"set"}],"type":"any"}],"result":{"dynamic":{"type":"any"},"type":"array"},"type":"function"},"name":"sort"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"dynamic":{"type":"string"},"type":"array"},"type":"function"},"name":"split"},{"decl":{"args":[{"type":"string"},{"dynamic":{"type":"any"},"type":"array"}],"result":{"type":"string"},"type":"function"},"name":"sprintf"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"startswith"},{"decl":{"args":[{"dynamic":{"key":{"type":"string"},"value":{"type":"string"}},"type":"object"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"strings.replace_n"},{"decl":{"args":[{"type":"string"},{"type":"number"},{"type":"number"}],"result":{"type":"string"},"type":"function"},"name":"substring"},{"decl":{"args":[{"of":[{"of":{"type":"number"},"type":"set"},{"dynamic":{"type":"number"},"type":"array"}],"type":"any"}],"result":{"type":"number"},"type":"function"},"name":"sum"},{"decl":{"args":[{"type":"number"},{"type":"number"},{"type":"number"},{"type":"number"}],"result":{"type":"number"},"type":"function"},"name":"time.add_date"},{"decl":{"args":[{"of":[{"type":"number"},{"static":[{"type":"number"},{"type":"string"}],"type":"array"}],"type":"any"}],"result":{"static":[{"type":"number"},{"type":"number"},{"type":"number"}],"type":"array"},"type":"function"},"name":"time.clock"},{"decl":{"args":[{"of":[{"type":"number"},{"static":[{"type":"number"},{"type":"string"}],"type":"array"}],"type":"any"}],"result":{"static":[{"type":"number"},{"type":"number"},{"type":"number"}],"type":"array"},"type":"function"},"name":"time.date"},{"decl":{"result":{"type":"number"},"type":"function"},"name":"time.now_ns"},{"decl":{"args":[{"type":"string"}],"result":{"type":"number"},"type":"function"},"name":"time.parse_duration_ns"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"number"},"type":"function"},"name":"time.parse_ns"},{"decl":{"args":[{"type":"string"}],"result":{"type":"number"},"type":"function"},"name":"time.parse_rfc3339_ns"},{"decl":{"args":[{"of":[{"type":"number"},{"static":[{"type":"number"},{"type":"string"}],"type":"array"}],"type":"any"}],"result":{"type":"string"},"type":"function"},"name":"time.weekday"},{"decl":{"args":[{"of":[{"type":"number"},{"type":"string"},{"type":"boolean"},{"type":"null"}],"type":"any"}],"result":{"type":"number"},"type":"function"},"name":"to_number"},{"decl":{"args":[{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"trace"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"trim"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"trim_left"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"trim_prefix"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"trim_right"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"trim_space"},{"decl":{"args":[{"type":"string"},{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"trim_suffix"},{"decl":{"args":[{"of":[{"type":"any"}],"type":"any"}],"result":{"type":"string"},"type":"function"},"name":"type_name"},{"decl":{"args":[{"of":{"of":{"type":"any"},"type":"set"},"type":"set"}],"result":{"of":{"type":"any"},"type":"set"},"type":"function"},"name":"union"},{"decl":{"args":[{"type":"string"}],"result":{"type":"number"},"type":"function"},"name":"units.parse_bytes"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"upper"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"urlquery.decode"},{"decl":{"args":[{"type":"string"}],"result":{"dynamic":{"key":{"type":"string"},"value":{"dynamic":{"type":"string"},"type":"array"}},"type":"object"},"type":"function"},"name":"urlquery.decode_object"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"urlquery.encode"},{"decl":{"args":[{"dynamic":{"key":{"type":"string"},"value":{"of":[{"type":"string"},{"dynamic":{"type":"string"},"type":"array"},{"of":{"type":"string"},"type":"set"}],"type":"any"}},"type":"object"}],"result":{"type":"string"},"type":"function"},"name":"urlquery.encode_object"},{"decl":{"args":[{"type":"string"}],"result":{"type":"string"},"type":"function"},"name":"uuid.rfc4122"},{"decl":{"args":[{"type":"any"}],"result":{"static":[{"dynamic":{"type":"any"},"type":"array"},{"type":"any"}],"type":"array"},"type":"function"},"name":"walk","relation":true},{"decl":{"args":[{"type":"string"}],"result":{"type":"boolean"},"type":"function"},"name":"yaml.is_valid"},{"decl":{"args":[{"type":"any"}],"result":{"type":"string"},"type":"function"},"name":"yaml.marshal"},{"decl":{"args":[{"type":"string"}],"result":{"type":"any"},"type":"function"},"name":"yaml.unmarshal"}],"default_decision":"/schemas/terraform/aws/deny","ecosystems":{"aws":{"SNYK_CC_TF_1":{"id":"101","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-1","references":["https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html"],"remediation":{"cloudformation":"Set `Properties.SecurityGroupIngress.CidrIp` attribute with a more restrictive IP, for example `192.16.0.0/24`","terraform":"Set `cidr_block` attribute with a more restrictive IP, for example `192.16.0.0/24`"},"severity":"medium","subType":"VPC","title":"Security Group allows open ingress","type":"terraform"},"SNYK_CC_TF_10":{"id":"110","impact":"Your password is not following the recommended security practices and is not as strong as it should be","issue":"Your password does not contain numbers","policyEngineType":"opa","publicId":"SNYK-CC-TF-10","references":[],"resolve":"Set the `require_numbers` attribute to be `true` to increase the strength of your password","severity":"medium","subType":"IAM","title":"IAM password should contain numbers","type":"terraform"},"SNYK_CC_TF_106":{"id":"206","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"DynamoDB Acceleration (DAX) is not encrypted","policyEngineType":"opa","publicId":"SNYK-CC-TF-106","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption","https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html"],"resolve":"Set `server_side_encryption.enable` attribute to `true`.","severity":"medium","subType":"DynamoDB Accelerator (DAX)","title":"Non-encrypted DynamoDB DAX","type":"terraform"},"SNYK_CC_TF_107":{"id":"207","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"EKS cluster secrets are not encrypted","policyEngineType":"opa","publicId":"SNYK-CC-TF-107","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config","https://aws.amazon.com/blogs/containers/using-eks-encryption-provider-support-for-defense-in-depth/"],"resolve":"Set the `encryption_config` object with the relevant `provider` \u0026 `resources`.","severity":"medium","subType":"EKS","title":"EKS cluster has non-encrypted secrets at rest","type":"terraform"},"SNYK_CC_TF_108":{"id":"208","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"Redshift DB is not encrypted","policyEngineType":"opa","publicId":"SNYK-CC-TF-108","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted","https://docs.aws.amazon.com/redshift/latest/mgmt/security-server-side-encryption.html"],"resolve":"Set `encrypted` attribute to `true`.","severity":"medium","subType":"Redshift","title":"Non-encrypted Redshift DB at rest","type":"terraform"},"SNYK_CC_TF_109":{"id":"209","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"DocDB is not encrypted","policyEngineType":"opa","publicId":"SNYK-CC-TF-109","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted","https://docs.aws.amazon.com/documentdb/latest/developerguide/encryption-at-rest.html"],"resolve":"Set `storage_encrypted` attribute to `true`.","severity":"medium","subType":"DocumentDB","title":"Non-encrypted DocDB at rest","type":"terraform"},"SNYK_CC_TF_11":{"id":"111","impact":"Your password is not following the recommended security practices and is not as strong as it should be","issue":"Your password does not enforce a minimum length","policyEngineType":"opa","publicId":"SNYK-CC-TF-11","references":[],"resolve":"Set the `minimum_password_length` attribute to be at least `14` to increase the strength of your password","severity":"medium","subType":"IAM","title":"IAM requires minimum password length","type":"terraform"},"SNYK_CC_TF_110":{"id":"210","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"Athena DB is not encrypted","policyEngineType":"opa","publicId":"SNYK-CC-TF-110","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration","https://docs.aws.amazon.com/athena/latest/ug/encryption.html"],"resolve":"Set `encryption_configuration` object.","severity":"medium","subType":"Athena","title":"Non-encrypted Athena DB at rest","type":"terraform"},"SNYK_CC_TF_111":{"id":"211","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"CodeBuild project encryption is explicitly disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-111","references":["https://docs.aws.amazon.com/codebuild/latest/userguide/security-encryption.html"],"resolve":"Set `artifacts.encryption_disabled` or `secondary_artifacts.encryption_disabled` attributes to `false`, or remove the attribute from configuration","severity":"medium","subType":"CodeBuild","title":"Non-Encrypted CodeBuild artifacts","type":"terraform"},"SNYK_CC_TF_113":{"id":"213","impact":"Encryption of the results can be disabled by the client, and in an event of unauthorized access to the data they would be able to read the contents","issue":"Athena workgroup settings can be overridden by client","policyEngineType":"opa","publicId":"SNYK-CC-TF-113","references":["https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html","https://docs.aws.amazon.com/athena/latest/ug/encryption.html","https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings.html"],"resolve":"Set `configuration.enforce_workgroup_configuration` attribute to `true`","severity":"medium","subType":"Athena","title":"Athena workgroup does not enforce service settings","type":"terraform"},"SNYK_CC_TF_116":{"id":"216","impact":"Increases the security management overhead","issue":"The IAM policy is directly attached to an user","policyEngineType":"opa","publicId":"SNYK-CC-TF-116","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html","https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#use-groups-for-permissions"],"resolve":"Attach policy to a group or role, instead of user. For example use `aws_iam_group_policy_attachment` resource","severity":"low","subType":"IAM","title":"IAM Policy attached to user","type":"terraform"},"SNYK_CC_TF_117":{"id":"217","impact":"Anyone will be allowed to assume the role, and perform actions granted in attached policies","issue":"The IAM role can be assumed by any service or principal","policyEngineType":"opa","publicId":"SNYK-CC-TF-117","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_permissions-to-switch.html","https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_compare-resource-policies.html"],"resolve":"Set `Principal` attribute to specific service or account, e.g. `Service: ec2.amazonaws.com`","severity":"high","subType":"IAM","title":"IAM Role can be assumed by anyone","type":"terraform"},"SNYK_CC_TF_118":{"id":"218","impact":"Any principal in the account will be able to use the permissions granted by the attached policies","issue":"The IAM role can be assumed by any principal in the account","policyEngineType":"opa","publicId":"SNYK-CC-TF-118","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_permissions-to-switch.html","https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_compare-resource-policies.html"],"resolve":"Set `Principal` attribute to specific principal, e.g. `arn:aws:iam::1234:role/role-name`","severity":"medium","subType":"IAM","title":"IAM Role can be assumed by anyone in the account","type":"terraform"},"SNYK_CC_TF_119":{"id":"219","impact":"Any identity with this policy will have full administrative rights in the account","issue":"The IAM Policy grants all permissions to all resources","policyEngineType":"opa","publicId":"SNYK-CC-TF-119","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html"],"resolve":"Set `Actions` and `Resources` attributes to limited subset, e.g `Actions: ['s3:Create*']`","severity":"medium","subType":"IAM","title":"IAM Policy grants full administrative rights","type":"terraform"},"SNYK_CC_TF_12":{"id":"112","impact":"Your password is not following the recommended security practices and is not as strong as it should be","issue":"Your password could be reused","policyEngineType":"opa","publicId":"SNYK-CC-TF-12","references":[],"resolve":"Set the `password_reuse_prevention` attribute to be `24` to ensure the previous 24 passwords cannot be reused","severity":"medium","subType":"IAM","title":"IAM password reuse prevention is missing","type":"terraform"},"SNYK_CC_TF_121":{"id":"221","impact":"Anyone will be able to read and write to the bucket","issue":"The S3 policy grants all permissions to any principal","policyEngineType":"opa","publicId":"SNYK-CC-TF-121","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-access-control.html"],"resolve":"Set `Actions` and `Principals` attributes of the policy to limited set, e.g `Principals: {AWS: ['arn:aws:iam::1234:root]}`","severity":"high","subType":"S3","title":"S3 Policy grants full rights to anyone","type":"terraform"},"SNYK_CC_TF_122":{"id":"222","impact":"The secret value will readable to anyone with access to VCS","issue":"Secret value has been declared in environment variable","policyEngineType":"opa","publicId":"SNYK-CC-TF-122","references":["https://docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html"],"resolve":"Remove secret value from `environment` definition","severity":"high","subType":"Lambda","title":"Potentially sensitive variable in lambda environment","type":"terraform"},"SNYK_CC_TF_123":{"id":"223","impact":"Anyone with access to VCS will be able to obtain the secret keys, and access the unauthorized resources","issue":"Secret keys have been hardcoded in user_data script","policyEngineType":"opa","publicId":"SNYK-CC-TF-123","references":["https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html"],"resolve":"Remove secret value from `user_data` attribute","severity":"high","subType":"EC2","title":"Hard coded secrets in EC2 metadata","type":"terraform"},"SNYK_CC_TF_124":{"id":"224","impact":"Changes or deletion of objects will not be reversible","issue":"S3 bucket versioning is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-124","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html"],"resolve":"Set `versioning.enabled` attribute to `true`","severity":"low","subType":"S3","title":"S3 bucket versioning disabled","type":"terraform"},"SNYK_CC_TF_125":{"id":"225","impact":"No automated backups of DynamoDB data","issue":"DynamoDB does not have Point-in-Time Recovery enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-125","references":["https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery_Howitworks.html","https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery"],"resolve":"Set `point_in_time_recovery.enabled` attribute to `true`","severity":"medium","subType":"DynamoDB","title":"DynamoDB point-in-time recovery disabled","type":"terraform"},"SNYK_CC_TF_126":{"id":"226","impact":"Image tags can be modified post deployment","issue":"The AWS ECR registry does not enforce immutable tags","policyEngineType":"opa","publicId":"SNYK-CC-TF-126","references":["https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-tag-mutability.html"],"resolve":"Set `image_tag_mutability` attribute to `IMMUTABLE`","severity":"low","subType":"ECR","title":"ECR Registry allows mutable tags","type":"terraform"},"SNYK_CC_TF_127":{"id":"227","impact":"Object could be deleted without stronger MFA authorization","issue":"S3 bucket will not enforce MFA login on delete requests","policyEngineType":"opa","publicId":"SNYK-CC-TF-127","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html","https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMFADelete.html"],"resolve":"Set `versioning.mfa_delete` attribute to `true`","severity":"low","subType":"S3","title":"S3 bucket MFA delete control disabled","type":"terraform"},"SNYK_CC_TF_128":{"id":"228","impact":"Performance log events will not be collected and displayed in CloudWatch","issue":"ECS ContainerInsights will not be enabled on the cluster","policyEngineType":"opa","publicId":"SNYK-CC-TF-128","references":["https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html"],"resolve":"Set `settings.name` attribute to `containerInsights`, and `settings.value` to `enabled`","severity":"low","subType":"ECS","title":"ECS ContainerInsights disabled","type":"terraform"},"SNYK_CC_TF_129":{"id":"229","impact":"Traces will not be collected for this api gateway, which can impede incident management","issue":"X-Ray tracing is not enabled for this api gateway stage","policyEngineType":"opa","publicId":"SNYK-CC-TF-129","references":["https://docs.aws.amazon.com/xray/latest/devguide/xray-services-apigateway.html","https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-enabling-xray.html","https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-understanding-xray-traces.html"],"resolve":"Set `xray_tracing_enabled` attribute to `true`","severity":"low","subType":"API Gateway (REST APIs)","title":"API Gateway X-Ray tracing disabled","type":"terraform"},"SNYK_CC_TF_13":{"id":"113","impact":"That if your password is leaked, your exposure window is much longer","issue":"Your password has a long or no expiry time","policyEngineType":"opa","publicId":"SNYK-CC-TF-13","references":[],"resolve":"Set the `max_password_age` attribute to be less than `90` therefore reducing your exposure window","severity":"medium","subType":"IAM","title":"IAM should have max password age","type":"terraform"},"SNYK_CC_TF_130":{"id":"230","impact":"Metadata service may be vulnerable to reverse proxy/open firewall misconfigurations and server side request forgery attacks","issue":"Instance Metadata Service v2 is not enforced","policyEngineType":"opa","publicId":"SNYK-CC-TF-130","references":["https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html","https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html","https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html","https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/"],"resolve":"Set `metadata_options.http_tokens` attribute to `required`","severity":"low","subType":"EC2","title":"EC2 instance accepts IMDSv1","type":"terraform"},"SNYK_CC_TF_131":{"id":"231","impact":"Audit records may not be available during investigation","issue":"Amazon EKS control plane logging is not enabled for all log types","policyEngineType":"opa","publicId":"SNYK-CC-TF-131","references":["https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html"],"resolve":"Set `enabled_cluster_log_types` attribute to `['api;, 'audit', 'authenticator', 'controllerManager', 'scheduler' ]`","severity":"low","subType":"EKS","title":"EKS control plane logging insufficient","type":"terraform"},"SNYK_CC_TF_132":{"id":"232","impact":"Audit records may not be available during investigation","issue":"Amazon MQ Broker logging is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-132","references":["https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/security-logging-monitoring-cloudwatch.html"],"resolve":"Set `logs.general` attribute to `true`","severity":"low","subType":"MQ","title":"MQ broker general logs are disabled","type":"terraform"},"SNYK_CC_TF_133":{"id":"233","impact":"Trace logs will not be available during investigation","issue":"Amazon X-Ray tracing is not enabled for Lambda function","policyEngineType":"opa","publicId":"SNYK-CC-TF-133","references":["https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html"],"resolve":"Set `tracing_config.mode` attribute to `Active` or `PassThrough`","severity":"low","subType":"Lambda","title":"X-ray tracing is disabled for Lambda function","type":"terraform"},"SNYK_CC_TF_134":{"id":"234","impact":"Logs will be kept indefinitely and incur AWS costs","issue":"Amazon CloudWatch log group does not specify retention period","policyEngineType":"opa","publicId":"SNYK-CC-TF-134","references":["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html"],"resolve":"Set `retention_in_days` attribute to required value, e.g. set `365`","severity":"low","subType":"CloudWatch","title":"CloudWatch Log group retention period not set","type":"terraform"},"SNYK_CC_TF_135":{"id":"235","impact":"Logs will only be capture for current region (region specified in terraform provider)","issue":"Amazon CloudTrail is not enabled for all regions","policyEngineType":"opa","publicId":"SNYK-CC-TF-135","references":["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html"],"resolve":"Set `is_multi_region_trail` attribute to `true`","severity":"low","subType":"CloudTrail","title":"CloudTrail does not include all regions","type":"terraform"},"SNYK_CC_TF_136":{"id":"236","impact":"Audit records may not be available during investigation","issue":"Amazon Redshift cluster logging is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-136","references":["https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html"],"resolve":"Set `logging.enabled` attribute to `true`","severity":"low","subType":"Redshift","title":"Redshift cluster logging disabled","type":"terraform"},"SNYK_CC_TF_137":{"id":"237","impact":"Audit records may not be available during investigation","issue":"Amazon Global Accelerator flow logs are disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-137","references":["https://docs.aws.amazon.com/global-accelerator/latest/dg/monitoring-global-accelerator.flow-logs.html"],"resolve":"Set `attributes.flow_logs_enabled` attribute to `true`","severity":"low","subType":"Global Accelerator","title":"Global Accelerator flow logs disabled","type":"terraform"},"SNYK_CC_TF_138":{"id":"238","impact":"Audit records may not be available during investigation","issue":"Amazon Api Gateway access logging is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-138","references":["https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-logging.html"],"resolve":"Set `access_log_settings` attribute","severity":"low","subType":"API Gateway (REST APIs)","title":"API Gateway access logging disabled","type":"terraform"},"SNYK_CC_TF_139":{"id":"239","impact":"Audit records may not be available during investigation","issue":"Amazon MSK Cluster logs are not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-139","references":["https://docs.aws.amazon.com/msk/latest/developerguide/msk-logging.html"],"resolve":"Set at least one of available `logging_info.broker_logs` attributes to `enabled`","severity":"low","subType":"Managed Streaming for Kafka (MSK)","title":"MSK Cluster logging disabled","type":"terraform"},"SNYK_CC_TF_14":{"id":"114","impact":"That data is being encrypted with a key which is valid for a longer period of time, resulting in a greater exposure window should that key be leaked","issue":"That your encryption keys are not being rotated by AWS","policyEngineType":"opa","publicId":"SNYK-CC-TF-14","references":[],"remediation":{"cloudformation":"Set `Properties.EnableKeyRotation` attribute to `true`","terraform":"Set `enable_key_rotation` attribute to `true`"},"severity":"low","subType":"KMS","title":"KMS key does not have key rotation enabled","type":"terraform"},"SNYK_CC_TF_140":{"id":"240","impact":"Audit records may not be available during investigation","issue":"Amazon Elasticsearch domain logging is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-140","references":["https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createdomain-configure-slow-logs.html"],"resolve":"Set `log_publishing_options` attribute","severity":"low","subType":"ElasticSearch","title":"Elasticsearch domain logging disabled","type":"terraform"},"SNYK_CC_TF_141":{"id":"241","impact":"Audit records may not be available during investigation","issue":"Amazon DocDB logging is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-141","references":["https://docs.aws.amazon.com/documentdb/latest/developerguide/logging-and-monitoring.html"],"resolve":"Set `enabled_cloudwatch_logs_exports` attribute to `['profiler', 'audit']`","severity":"low","subType":"DocumentDB","title":"DocDB logging disabled","type":"terraform"},"SNYK_CC_TF_142":{"id":"242","impact":"Audit records may not be available during investigation","issue":"Amazon CloudFront distribution access logging is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-142","references":["https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/logging_using_cloudtrail.html"],"resolve":"Set `logging_config` attribute","severity":"low","subType":"CloudFront","title":"CloudFront access logging disabled","type":"terraform"},"SNYK_CC_TF_15":{"id":"115","impact":"That you cannot keep a record of all access and events on your account","issue":"Logs are not being kept for your CloudTrail activity","policyEngineType":"opa","publicId":"SNYK-CC-TF-15","references":[],"remediation":{"cloudformation":"Set the `Properties.IsLogging` attribute to `true`","terraform":"Set the `enable_logging` attribute to `true`"},"severity":"high","subType":"CloudTrail","title":"CloudTrail has logging disabled","type":"terraform"},"SNYK_CC_TF_16":{"id":"116","impact":"You cannot trust the integrity of the log files and determine whether they have been tampered with.","issue":"The CloudTrail logs integrity is not been enforced","policyEngineType":"opa","publicId":"SNYK-CC-TF-16","references":[],"remediation":{"cloudformation":"Set the `Properties.EnableLogFileValidation` attribute to `true`","terraform":"Set the `enable_log_file_validation` attribute to `true`"},"severity":"medium","subType":"CloudTrail","title":"CloudTrail does not have log file validation enabled","type":"terraform"},"SNYK_CC_TF_17":{"id":"117","impact":"IAM policies cannot be used to control access to the decryption keys","issue":"The CloudTrail logs are not encrypted with managed key","policyEngineType":"opa","publicId":"SNYK-CC-TF-17","references":["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html"],"remediation":{"cloudformation":"Set `KMSKeyId` attribute to valid KMS key id","terraform":"Set `kms_key_id` attribute to valid KMS key id"},"severity":"low","subType":"CloudTrail","title":"CloudTrail logs are not encrypted with managed key","type":"terraform"},"SNYK_CC_TF_18":{"id":"118","impact":"That you may be leaking sensitive information to members of the public without realizing.","issue":"That this S3 bucket is publicly readable without any authentication or authorization. ","policyEngineType":"opa","publicId":"SNYK-CC-TF-18","references":["https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl"],"remediation":{"cloudformation":"Set `AccessControl` attribute to `private`, or remove the attribute","terraform":"Set `acl` attribute to `private`, or remove the attribute"},"severity":"medium","subType":"S3","title":"S3 Bucket is publicly readable","type":"terraform"},"SNYK_CC_TF_19":{"id":"119","impact":"That you may be leaking sensitive information to members of the public and this data could be modified with your knowledge.","issue":"That this S3 bucket is publicly writeable without any authentication or authorization. ","policyEngineType":"opa","publicId":"SNYK-CC-TF-19","references":["https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl"],"remediation":{"cloudformation":"Set the `Properties.AccessControl` attribute to `private`, or remove the attribute","terraform":"Set the `acl` attribute to `private`, or remove the attribute"},"severity":"high","subType":"S3","title":"S3 Bucket is publicly readable and writable","type":"terraform"},"SNYK_CC_TF_2":{"id":"102","impact":"That should someone gain unauthorized access to the data they would be able to read the contents. ","issue":"That this EBS snapshot is not encrypted. The default behavior is for EBS snapshot to be encrypted. ","policyEngineType":"opa","publicId":"SNYK-CC-TF-2","references":[],"resolve":"Adding or updating the attribute `encrypted` and setting it to `true` to ensure the snapshots are now encrypted. ","severity":"medium","subType":"EC2","title":"Non-encrypted EBS snapshot","type":"terraform"},"SNYK_CC_TF_201":{"id":"201","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The DB instance storage encrypted set by default to false","policyEngineType":"opa","publicId":"SNYK-CC-TF-201","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#storage_encrypted"],"resolve":"Set `storage_encrypted` attribute to true","severity":"medium","subType":"RDS","title":"Non-encrypted RDS instance at rest","type":"terraform"},"SNYK_CC_TF_204":{"id":"204","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"EFS system file is not encrypted","policyEngineType":"opa","publicId":"SNYK-CC-TF-204","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#encrypted","https://docs.aws.amazon.com/efs/latest/ug/encryption-at-rest.html"],"resolve":"Set `encrypted` attribute to `true`.","severity":"medium","subType":"EFS","title":"Non-encrypted EFS at rest","type":"terraform"},"SNYK_CC_TF_205":{"id":"205","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The Neptune Cluster storage encrypted set by default to false","policyEngineType":"opa","publicId":"SNYK-CC-TF-205","references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted","https://docs.aws.amazon.com/neptune/latest/userguide/encrypt.html"],"resolve":"Set `storage_encrypted` attribute to true","severity":"medium","subType":"Neptune","title":"Non-encrypted Neptune cluster at rest","type":"terraform"},"SNYK_CC_TF_214":{"id":"214","impact":"The data could be read in transit.","issue":"Data in the Elasticache Replication Group is not securely encrypted in transit","policyEngineType":"opa","publicId":"SNYK-CC-TF-214","references":["https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/in-transit-encryption.html"],"resolve":"Set `transit_encryption_enabled` attribute to `true`","severity":"medium","subType":"ElastiCache","title":"Non-Encrypted ElastiCache data in transit","type":"terraform"},"SNYK_CC_TF_215":{"id":"215","impact":"The data could be read in transit.","issue":"Data in the Elasticache Replication Group is not securely encrypted in transit and is not protected with authentication.","policyEngineType":"opa","publicId":"SNYK-CC-TF-215","references":["https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/in-transit-encryption.html","https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/auth.html"],"resolve":"Set `transit_encryption_enabled` attribute to `true` and then add an external reference to `auth_token`. Do not add the secret directly into the file.","severity":"medium","subType":"ElastiCache","title":"Non-Authenticated and Non-Encrypted ElastiCache data in transit","type":"terraform"},"SNYK_CC_TF_256":{"id":"356","impact":"Alarms cannot be configured to alert on CloudTrail events","issue":"CloudTrail does not deliver logs to CloudWatch","policyEngineType":"opa","publicId":"SNYK-CC-TF-256","references":["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html"],"resolve":"Set `cloud_watch_logs_group_arn` attribute to cloudwatch log group ARN","severity":"low","subType":"CloudTrail","title":"CloudTrail not integrated with CloudWatch","type":"terraform"},"SNYK_CC_TF_3":{"id":"103","impact":"That should someone gain unauthorized access to the data they would be able to read the contents. ","issue":"That this EBS volume is not encrypted. The default behavior is for EBS volumes to be encrypted. ","policyEngineType":"opa","publicId":"SNYK-CC-TF-3","references":[],"remediation":{"cloudformation":"Set `Properties.Encrypted` attribute to `true`","terraform":"Set `encrypted` attribute to `true`"},"severity":"medium","subType":"EC2","title":"Non-encrypted EBS volume","type":"terraform"},"SNYK_CC_TF_37":{"id":"137","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-37","references":[],"remediation":{"cloudformation":"Set `CidrIp` attribute to specific IP range only, e.g. `192.168.1.0/24`","terraform":"Set `cidr_blocks` attribute to specific IP range only, e.g. `192.168.1.0/24`"},"severity":"medium","subType":"VPC","title":"AWS Security Group Rule allows public access","type":"terraform"},"SNYK_CC_TF_38":{"id":"138","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-38","references":["https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-security-groups.html"],"remediation":{"cloudformation":"Set `CIDRIP` attribute to specific IP range only, for example `192.168.1.0/24`","terraform":"Set `cidr` attribute to specific IP range only, for example `192.168.1.0/24`"},"severity":"medium","subType":"Redshift","title":"AWS Redshift Security Group allows public access","type":"terraform"},"SNYK_CC_TF_39":{"id":"139","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-39","references":["https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_AuthorizeDBSecurityGroupIngress.html"],"remediation":{"cloudformation":"Set `Properties.CIDRIP` attribute to specific IP range only, for example `192.168.1.0/24`","terraform":"Set `cidr` attribute to specific IP range only, for example `192.168.1.0/24`"},"severity":"medium","subType":"RDS","title":"AWS DB Security Group allows public access","type":"terraform"},"SNYK_CC_TF_4":{"id":"104","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"That by default S3 buckets do not encrypt the objects that are stored.","policyEngineType":"opa","publicId":"SNYK-CC-TF-4","references":[],"remediation":{"cloudformation":"Set `BucketEncryption` attribute","terraform":"Set `server_side_encryption_configuration` block attribute"},"severity":"medium","subType":"S3","title":"Non-encrypted S3 Bucket","type":"terraform"},"SNYK_CC_TF_40":{"id":"140","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-40","references":[],"resolve":"Set cidr_block to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"VPC","title":"AWS Default Network ACL allows public access","type":"terraform"},"SNYK_CC_TF_41":{"id":"141","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-41","references":["https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html"],"remediation":{"cloudformation":"Set `Properties.CidrBlock` or `Properties.Ipv6CidrBlock` attribute to specific IP range only, for example `192.168.0.0/24`","terraform":"Set `cidr_block` attribute to specific IP range only, for example `192.168.1.0/24`"},"severity":"medium","subType":"VPC","title":"AWS Network ACL allows public access","type":"terraform"},"SNYK_CC_TF_42":{"id":"142","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-42","references":[],"resolve":"Set cidr_block to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"VPC","title":"AWS Network ACL Rule allows public access","type":"terraform"},"SNYK_CC_TF_45":{"id":"145","impact":"There will be no audit trail of access to s3 objects","issue":"The s3 access logs will not be collected","policyEngineType":"opa","publicId":"SNYK-CC-TF-45","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html"],"remediation":{"cloudformation":"Set `Properties.LoggingConfiguration` attribute","terraform":"Add `logging` block attribute"},"severity":"low","subType":"S3","title":"S3 server access logging is disabled","type":"terraform"},"SNYK_CC_TF_46":{"description":"","id":"146","impact":"Increases attack vector reachability","issue":"The EC2-Classic resources run in shared environment","policyEngineType":"opa","publicId":"SNYK-CC-TF-46","references":["https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html"],"resolve":"Migrate the resource to VPC mode","severity":"low","subType":"EC2-Classic","title":"AWS EC2-Classic resource detected","type":"terraform"},"SNYK_CC_TF_47":{"id":"147","impact":"The content could be intercepted and manipulated in transit","issue":"Load balancer endpoint does not enforce HTTPS","policyEngineType":"opa","publicId":"SNYK-CC-TF-47","references":["https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html"],"remediation":{"cloudformation":"Set the `Properties.Protocol` attribute to `HTTPS` or `TLS`","terraform":"Set the `protocol` attribute to `HTTPS` or `TLS`"},"severity":"medium","subType":"Elastic Load Balancing v2 (ALB/NLB)","title":"Load balancer endpoint does not enforce HTTPS","type":"terraform"},"SNYK_CC_TF_48":{"id":"148","impact":"Increases attack vector reachability","issue":"Load balancer is internet facing","policyEngineType":"opa","publicId":"SNYK-CC-TF-48","references":["https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-internet-facing-load-balancers.html"],"resolve":"Set `internal` attribute to `true`","severity":"low","subType":"Elastic Load Balancing (ELB Classic)","title":"Load balancer is internet facing","type":"terraform"},"SNYK_CC_TF_49":{"id":"149","impact":"Older cipher suites could be vulnerable to hijacking and information disclosure","issue":"The load balancer will accept older TLS/SSL cipher suits","policyEngineType":"opa","publicId":"SNYK-CC-TF-49","references":["https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html#describe-ssl-policies"],"resolve":"Set `ssl_policy` attribute to latest AWS predefined security policy","severity":"low","subType":"Elastic Load Balancing v2 (ALB/NLB)","title":"ELB does not enforce latest TLS/SSL policy","type":"terraform"},"SNYK_CC_TF_5":{"id":"105","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-5","references":[],"resolve":"Updating the `cidr_block` attribute with a more restrictive IP range or a specific IP address to ensure traffic can only come from known sources. ","severity":"medium","subType":"VPC","title":"Default VPC Security Group allows open ingress","type":"terraform"},"SNYK_CC_TF_50":{"description":"","id":"150","impact":"Increases attack vector reachability","issue":"AWS resource is publicly accessible","policyEngineType":"opa","publicId":"SNYK-CC-TF-50","references":["https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.WorkingWithRDSInstanceinaVPC.html","https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html"],"resolve":"Set `publicly_accessible` attribute to `false`","severity":"high","subType":"Public Access","title":"Resource is publicly accessible","type":"terraform"},"SNYK_CC_TF_51":{"id":"151","impact":"Increases attack vector reachability","issue":"AWS resource could be accessed externally via public IP","policyEngineType":"opa","publicId":"SNYK-CC-TF-51","references":["https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html","https://docs.aws.amazon.com/autoscaling/ec2/userguide/asg-in-vpc.html"],"resolve":"Set `associate_public_ip_address` attribute to `false`","severity":"low","subType":"EC2","title":"Resource has public IP assigned","type":"terraform"},"SNYK_CC_TF_52":{"id":"152","impact":"The secret value will readable to anyone with access to VCS","issue":"Secret value has been declared in variable definition","policyEngineType":"opa","publicId":"SNYK-CC-TF-52","references":["https://docs.aws.amazon.com/AmazonECS/latest/developerguide/specifying-sensitive-data.html"],"resolve":"Remove secret value from `environment` definition","severity":"medium","subType":"ECS","title":"Potentially sensitive variable in task definition","type":"terraform"},"SNYK_CC_TF_53":{"id":"153","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The root block device for ec2 instance is not encrypted","policyEngineType":"opa","publicId":"SNYK-CC-TF-53","references":["https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html","https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html"],"resolve":"Set `root_block_device.encrypted` attribute to `true`","severity":"medium","subType":"EC2","title":"Non-Encrypted root block device","type":"terraform"},"SNYK_CC_TF_54":{"id":"154","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The SQS queue is not encrypted at rest","policyEngineType":"opa","publicId":"SNYK-CC-TF-54","references":["https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html"],"resolve":"Set `kms_master_key_id` attribute to KMS key","severity":"medium","subType":"SQS","title":"Non-Encrypted SQS Queue","type":"terraform"},"SNYK_CC_TF_55":{"id":"155","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The SNS topic is not encrypted at rest","policyEngineType":"opa","publicId":"SNYK-CC-TF-55","references":["https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html"],"resolve":"Set `kms_master_key_id` attribute to KMS key","severity":"medium","subType":"SNS","title":"Non-Encrypted SNS Topic","type":"terraform"},"SNYK_CC_TF_56":{"id":"156","impact":"Increases the security management overhead","issue":"The description field is missing in the security group","policyEngineType":"opa","publicId":"SNYK-CC-TF-56","references":["https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security-groups.html"],"resolve":"Set `description` attribute to meaningful statement","severity":"low","subType":"VPC","title":"Missing description","type":"terraform"},"SNYK_CC_TF_57":{"id":"157","impact":"The content could be intercepted and manipulated in transit","issue":"Cloudfront distribution does not enforce HTTPS","policyEngineType":"opa","publicId":"SNYK-CC-TF-57","references":["https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-web-values-specify.html#DownloadDistValuesViewerProtocolPolicy","https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https-viewers-to-cloudfront.html"],"resolve":"Set `default_cache_behavior.viewer_protocol_policy` attribute to `redirect-to-https`","severity":"medium","subType":"CloudFront","title":"Cloudfront distribution does not enforce HTTPS","type":"terraform"},"SNYK_CC_TF_58":{"id":"158","impact":"Older cipher suites could be vulnerable to hijacking and information disclosure","issue":"The cloudfront distribution will accept older TLS/SSL cipher suits","policyEngineType":"opa","publicId":"SNYK-CC-TF-58","references":["https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-web-values-specify.html#DownloadDistValues-security-policy","https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html"],"resolve":"Set `viewer_certificate.minimum_protocol_version` attribute to `TLSv1.2_2019`","severity":"low","subType":"CloudFront","title":"Distribution does not enforce latest TLS/SSL policy","type":"terraform"},"SNYK_CC_TF_59":{"id":"159","impact":"The content could be intercepted and manipulated in transit","issue":"The client traffic will not be encrypted in transit","policyEngineType":"opa","publicId":"SNYK-CC-TF-59","references":["https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html"],"resolve":"Set `encryption_info.encryption_in_transit.client_broker` attribute to `TLS`","severity":"medium","subType":"Managed Streaming for Kafka (MSK)","title":"MSK allows client plaintext traffic","type":"terraform"},"SNYK_CC_TF_6":{"id":"106","impact":"That traffic from a resource could reach any destination, in the event of a breach this means data could be uploaded externally or additional resources targeted","issue":"That outbound traffic is not restricted to a specific range from a resource","policyEngineType":"opa","publicId":"SNYK-CC-TF-6","references":[],"resolve":"Updating the `cidr_block` attribute with a more restrictive IP range or a specific IP address to ensure traffic can only reach known destinations. ","severity":"medium","subType":"VPC","title":"Default VPC Security Group allows open egress","type":"terraform"},"SNYK_CC_TF_60":{"id":"160","impact":"The content could be intercepted and manipulated in transit","issue":"The inter-cluster traffic will not be encrypted in transit","policyEngineType":"opa","publicId":"SNYK-CC-TF-60","references":["https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html"],"resolve":"Set `encryption_info.encryption_in_transit.in_cluster` attribute to `true`","severity":"medium","subType":"Managed Streaming for Kafka (MSK)","title":"MSK allows in cluster plaintext traffic","type":"terraform"},"SNYK_CC_TF_61":{"id":"161","impact":"The known vulnerabilities will not be automatically discovered","issue":"The ECR image scan for known vulnerabilities is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-61","references":["https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html"],"resolve":"Set `image_scanning_configuration.scan_on_push` attribute to `true`","severity":"low","subType":"ECR","title":"ECR image scanning is disabled","type":"terraform"},"SNYK_CC_TF_62":{"id":"162","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The AWS kinesis server-side encryption is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-62","references":["https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.htm://docs.aws.amazon.com/streams/latest/dev/server-side-encryption.html"],"resolve":"Set `encryption_type` attribute to `KMS`","severity":"medium","subType":"Kinesis","title":"Non-Encrypted Kinesis Stream","type":"terraform"},"SNYK_CC_TF_63":{"id":"163","impact":"Older cipher suites could be vulnerable to hijacking and information disclosure","issue":"The API gateway will accept older TLS cipher suits","policyEngineType":"opa","publicId":"SNYK-CC-TF-63","references":["https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html"],"resolve":"Set `security_policy` attribute to `TLS_1_2`","severity":"low","subType":"API Gateway (REST APIs)","title":"API Gateway does not enforce latest TLS/SSL policy","type":"terraform"},"SNYK_CC_TF_64":{"id":"164","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The elasticsearch cluster is not encrypted at rest","policyEngineType":"opa","publicId":"SNYK-CC-TF-64","references":["https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html","https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/aes-supported-instance-types.html"],"resolve":"Set `encrypt_at_rest.enabled` attribute to `true`","severity":"medium","subType":"ElasticSearch","title":"Encryption at rest is disabled","type":"terraform"},"SNYK_CC_TF_65":{"id":"165","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The instance type does not support encryption at rest","policyEngineType":"opa","publicId":"SNYK-CC-TF-65","references":["https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html","https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/aes-supported-instance-types.html"],"resolve":"Set `cluster_config.instance_type` attribute to supported instance type e.g. `c5.large.elasticsearch`, and set `encrypt_at_rest.enabled` attribute to `true`","severity":"medium","subType":"ElasticSearch","title":"Encryption at rest is not supported by instance type","type":"terraform"},"SNYK_CC_TF_66":{"id":"166","impact":"The content could be intercepted and manipulated in transit","issue":"The inter-cluster traffic will not be encrypted in transit","policyEngineType":"opa","publicId":"SNYK-CC-TF-66","references":["https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/ntn.html"],"resolve":"Set `node_to_node_encryption.enabled` attribute to `true`","severity":"medium","subType":"ElasticSearch","title":"Node-to-node encryption is disabled","type":"terraform"},"SNYK_CC_TF_67":{"id":"167","impact":"The content could be intercepted and manipulated in transit","issue":"The HTTPS is not enforced for elasticsearch cluster","policyEngineType":"opa","publicId":"SNYK-CC-TF-67","references":["https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-data-protection.html"],"resolve":"Set `domain_endpoint_options.enforce_https` attribute to `true`","severity":"medium","subType":"ElasticSearch","title":"Cluster does not enforce HTTPS","type":"terraform"},"SNYK_CC_TF_68":{"id":"168","impact":"Older cipher suites could be vulnerable to hijacking and information disclosure","issue":"The elasticsearch cluster will accept older TLS/SSL cipher suits","policyEngineType":"opa","publicId":"SNYK-CC-TF-68","references":["https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-data-protection.html"],"resolve":"Set `domain_endpoint_options.tls_security_policy` attribute to `Policy-Min-TLS-1-2-2019-07`","severity":"medium","subType":"ElasticSearch","title":"Cluster does not enforce latest TLS/SSL policy","type":"terraform"},"SNYK_CC_TF_69":{"description":"","id":"169","impact":"Granting permission to perform any action is against 'least privilege' principle","issue":"The IAM policy allows all actions on resource","policyEngineType":"opa","publicId":"SNYK-CC-TF-69","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_action.html","https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_grammar.html"],"resolve":"Set `statement.action` attribute to specific actions e.g. `s3:ListBucket`","severity":"high","subType":"IAM","title":"Wildcard action in IAM Policy","type":"terraform"},"SNYK_CC_TF_7":{"id":"107","impact":"Your password is not following the recommended security practices and is not as strong as it should be","issue":"Your password does not contain uppercase characters","policyEngineType":"opa","publicId":"SNYK-CC-TF-7","references":[],"resolve":"Set the `require_uppercase` attribute to be `true` to increase the strength of your password","severity":"medium","subType":"IAM","title":"IAM password should contain uppercase","type":"terraform"},"SNYK_CC_TF_70":{"id":"170","impact":"Granting permission to perform any action is against 'least privilege' principle","issue":"The SQS queue policy allows all actions on the resource","policyEngineType":"opa","publicId":"SNYK-CC-TF-70","references":["https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-authentication-and-access-control.html"],"resolve":"Set `Action` in policy heredoc to specific actions e.g. `sqs:SendMessage`","severity":"high","subType":"SQS","title":"Wildcard action in SQS Policy","type":"terraform"},"SNYK_CC_TF_71":{"id":"171","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The ElastiCache replication group is not encrypted at rest","policyEngineType":"opa","publicId":"SNYK-CC-TF-71","references":["https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/at-rest-encryption.html"],"resolve":"Set `at_rest_encryption_enabled` attribute to `true`","severity":"medium","subType":"ElastiCache","title":"Non-Encrypted ElastiCache Replication Group","type":"terraform"},"SNYK_CC_TF_72":{"id":"172","impact":"Open egress can be used to exfiltrate data to unauthorized destinations, and enable access to potentially malicious resources","issue":"The security group rule allows open egress","policyEngineType":"opa","publicId":"SNYK-CC-TF-72","references":["https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html","https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-best-practices.html"],"resolve":"Set `cidr_blocks` attribute to specific ranges e.g. `192.168.1.0/24`","severity":"low","subType":"VPC","title":"Rule allows open egress","type":"terraform"},"SNYK_CC_TF_73":{"id":"173","impact":"Open egress can be used to exfiltrate data to unauthorized destinations, and enable access to potentially malicious resources","issue":"The inline security group rule allows open egress","policyEngineType":"opa","publicId":"SNYK-CC-TF-73","references":["https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html","https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-best-practices.html"],"resolve":"Set `egress.cidr_blocks` attribute to specific ranges e.g. `192.168.1.0/24`","severity":"low","subType":"VPC","title":"AWS Security Group allows open egress","type":"terraform"},"SNYK_CC_TF_74":{"description":"","id":"174","impact":"The credentials may be committed into version control system, or stored in terraform state file","issue":"Static credentials are configured via provider attributes","policyEngineType":"opa","publicId":"SNYK-CC-TF-74","references":["https://docs.aws.amazon.com/AmazonECS/latest/developerguide/specifying-sensitive-data.html","https://registry.terraform.io/providers/hashicorp/aws/latest/docs"],"resolve":"Set access credentials via environment variables","severity":"high","subType":"Provider","title":"Static credentials used in provider","type":"terraform"},"SNYK_CC_TF_75":{"id":"175","impact":"The WAF service will not protect the application from common web based attacks such as SQL injections","issue":"The AWS WAF is not in front of cloudfront distribution","policyEngineType":"opa","publicId":"SNYK-CC-TF-75","references":["https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-web-awswaf.html","https://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html"],"resolve":"Set `web_acl_id` attribute to existing AWS WAF acl ARN","severity":"low","subType":"CloudFront","title":"Cloudfront distribution without WAF","type":"terraform"},"SNYK_CC_TF_8":{"id":"108","impact":"Your password is not following the recommended security practices and is not as strong as it should be","issue":"Your password does not contain lowercase characters","policyEngineType":"opa","publicId":"SNYK-CC-TF-8","references":[],"resolve":"Set the `require_lowercase` attribute to be `true` to increase the strength of your password","severity":"medium","subType":"IAM","title":"IAM password should contain lowercase","type":"terraform"},"SNYK_CC_TF_9":{"id":"109","impact":"Your password is not following the recommended security practices and is not as strong as it should be","issue":"Your password does not contain symbols","policyEngineType":"opa","publicId":"SNYK-CC-TF-9","references":[],"resolve":"Set the `require_symbols` attribute to be `true` to increase the strength of your password","severity":"medium","subType":"IAM","title":"IAM password should contain symbols","type":"terraform"},"SNYK_CC_TF_93":{"id":"193","impact":"Any AWS account will be able to perform actions specified in the policy","issue":"The ECR policy allows access to any account","policyEngineType":"opa","publicId":"SNYK-CC-TF-93","references":["https://docs.aws.amazon.com/AmazonECR/latest/userguide/repository-policies.html"],"resolve":"Set `statement.principal` attribute of policy document to specific accounts only e.g. `arn:aws:iam::account-id:root`","severity":"high","subType":"ECR","title":"ECR policy allows public access","type":"terraform"},"SNYK_CC_TF_94":{"id":"194","impact":"Anyone may be able to establish network connectivity to the API server","issue":"API endpoint of the EKS cluster is public","policyEngineType":"opa","publicId":"SNYK-CC-TF-94","references":["https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html"],"resolve":"Set `vpc_config.public_access_cidrs` attribute to specific net address e.g. `192.168.0.0/24`, or set `vpc_config.endpoint_public_access` attribute to `false`","severity":"high","subType":"EKS","title":"EKS cluster allows public access","type":"terraform"},"SNYK_CC_TF_95":{"id":"195","impact":"Anyone who can manage bucket's ACLs will be able to grant public access to the bucket","issue":"Bucket does not prevent creation of public ACLs","policyEngineType":"opa","publicId":"SNYK-CC-TF-95","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html","https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html","https://docs.aws.amazon.com/AmazonS3/latest/user-guide/block-public-access.html"],"resolve":"Set `block_public_acls` attribute to `true`","severity":"high","subType":"S3","title":"S3 block public ACLs control is disabled","type":"terraform"},"SNYK_CC_TF_96":{"id":"196","impact":"Anyone who can manage bucket's policies will be able to grant public access to the bucket.","issue":"Bucket does not prevent creation of public policies","policyEngineType":"opa","publicId":"SNYK-CC-TF-96","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html","https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html","https://docs.aws.amazon.com/AmazonS3/latest/user-guide/block-public-access.html"],"resolve":"Set `block_public_policy` attribute to `true`","severity":"high","subType":"S3","title":"S3 block public policy control is disabled","type":"terraform"},"SNYK_CC_TF_97":{"id":"197","impact":"If public ACL is attached to the bucket, anyone will be able to read and/or write to the bucket.","issue":"Bucket will recognize public ACLs and allow public access","policyEngineType":"opa","publicId":"SNYK-CC-TF-97","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html","https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html","https://docs.aws.amazon.com/AmazonS3/latest/user-guide/block-public-access.html"],"resolve":"Set `ignore_public_acls` attribute to `true`","severity":"high","subType":"S3","title":"S3 ignore public ACLs control is disabled","type":"terraform"},"SNYK_CC_TF_98":{"id":"198","impact":"If public policy is attached to the bucket, anyone will be able to read and/or write to the bucket.","issue":"Bucket will recognize public policies and allow public access","policyEngineType":"opa","publicId":"SNYK-CC-TF-98","references":["https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html","https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html","https://docs.aws.amazon.com/AmazonS3/latest/user-guide/block-public-access.html"],"resolve":"Set `restrict_public_buckets` attribute to `true`","severity":"high","subType":"S3","title":"S3 restrict public bucket control is disabled","type":"terraform"},"SNYK_CC_TF_99":{"id":"199","impact":"Anyone could potentially access resources behind the gateway","issue":"API gateway will accept http methods without authorization header","policyEngineType":"opa","publicId":"SNYK-CC-TF-99","references":["https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-method-settings-method-request.html"],"resolve":"Set `authorization` attribute to value other than `NONE`","severity":"high","subType":"API Gateway (REST APIs)","title":"API Gateway allows anonymous access","type":"terraform"}},"azure":{"SNYK_CC_TF_144":{"id":"244","impact":"The content could be intercepted and manipulated in transit","issue":"Azure App Service does not enforce HTTPS traffic only","policyEngineType":"opa","publicId":"SNYK-CC-TF-144","references":["https://docs.microsoft.com/en-us/azure/app-service/security-recommendations"],"resolve":"Set `https_only` attribute to `true`","severity":"medium","subType":"App Service (Web Apps)","title":"Azure App Service allows HTTP traffic","type":"terraform"},"SNYK_CC_TF_145":{"id":"245","impact":"Older cipher suites could be vulnerable to hijacking and information disclosure","issue":"Azure App Service does not enforce latest TLS cipher suites","policyEngineType":"opa","publicId":"SNYK-CC-TF-145","references":["https://docs.microsoft.com/en-us/azure/app-service/security-recommendations"],"resolve":"Set `site_config.min_tls_version` attribute to `true`","severity":"low","subType":"App Service (Web Apps)","title":"Azure APP Service does not enforce latest TLS","type":"terraform"},"SNYK_CC_TF_146":{"id":"246","impact":"The content could be intercepted and manipulated in transit","issue":"Azure MySQL Server does not enforce SSL traffic only","policyEngineType":"opa","publicId":"SNYK-CC-TF-146","references":["https://docs.microsoft.com/en-us/azure/mysql/concepts-security"],"resolve":"Set `ssl_enforcement_enabled` attribute to `true`","severity":"medium","subType":"Database","title":"Azure MySQL Server does not enforce SSL","type":"terraform"},"SNYK_CC_TF_147":{"id":"247","impact":"The content could be intercepted and manipulated in transit","issue":"Azure Postgresql Server does not enforce SSL traffic only","policyEngineType":"opa","publicId":"SNYK-CC-TF-147","references":["https://docs.microsoft.com/en-us/azure/postgresql/concepts-ssl-connection-security"],"resolve":"Set `ssl_enforcement_enabled` attribute to `true`","severity":"medium","subType":"Database","title":"Azure Postgresql Server does not enforce SSL","type":"terraform"},"SNYK_CC_TF_148":{"id":"248","impact":"The content could be intercepted and manipulated in transit","issue":"Azure Storage Account does not enforce HTTPS traffic only","policyEngineType":"opa","publicId":"SNYK-CC-TF-148","references":["https://docs.microsoft.com/en-us/azure/storage/common/storage-require-secure-transfer"],"resolve":"Set `enable_https_traffic_only` attribute to `true`","severity":"medium","subType":"Storage","title":"Storage Account does not enforce HTTPS","type":"terraform"},"SNYK_CC_TF_149":{"id":"249","impact":"Older cipher suites could be vulnerable to hijacking and information disclosure","issue":"Azure Storage Account does not enforce latest TLS version","policyEngineType":"opa","publicId":"SNYK-CC-TF-149","references":["https://docs.microsoft.com/en-us/azure/storage/common/transport-layer-security-configure-minimum-version?tabs=portal"],"resolve":"Set `min_tls_version` attribute to `TLS1_2`","severity":"medium","subType":"Storage","title":"Storage Account does not enforce latest TLS","type":"terraform"},"SNYK_CC_TF_150":{"id":"250","impact":"Granting permission to perform any action is against the principal of least privilege","issue":"Custom role grants owner rights","policyEngineType":"opa","publicId":"SNYK-CC-TF-150","references":["https://docs.microsoft.com/en-us/azure/role-based-access-contro/role-definitions","https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices","https://docs.microsoft.com/en-us/azure/role-based-access-control/custom-roles","https://en.wikipedia.org/wiki/Principle_of_least_privilege"],"resolve":"Set `permissions` attribute to specific actions only, e.g `Microsoft.Storage/storageAccounts/blobServices/containers/read`","severity":"medium","subType":"Authorization","title":"Custom subscription owner role","type":"terraform"},"SNYK_CC_TF_152":{"id":"252","impact":"Audit records may not be available during investigation","issue":"Azure Network Security Group Flow log retention period is not greater than 90 days","policyEngineType":"opa","publicId":"SNYK-CC-TF-152","references":["https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview"],"resolve":"Set `retention_policy` attribute to `90` or greater","severity":"low","subType":"Network","title":"NSG Flow Log retention period is below 90 days","type":"terraform"},"SNYK_CC_TF_153":{"id":"253","impact":"Audit records may not be available during investigation","issue":"Azure SQL server audit retention period is below 90 days","policyEngineType":"opa","publicId":"SNYK-CC-TF-153","references":["https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview"],"resolve":"Set `retention_in_days` attribute to `90` or greater. Alternatively set the value to `0` to retain records indefinitely","severity":"low","subType":"Database","title":"Insufficient audit record retention period for SQL server","type":"terraform"},"SNYK_CC_TF_154":{"id":"254","impact":"Verbose logging information of database will not be collected","issue":"Azure PostgreSQL 'log_checkpoint' is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-154","references":["https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs"],"resolve":"Set `name` attribute to `log_checkpoints`, and `value` attribute to `on`","severity":"low","subType":"Database","title":"log_checkpoints is disabled on PostgreSQL DB","type":"terraform"},"SNYK_CC_TF_155":{"id":"255","impact":"Read requests to the storage queue will not be logged","issue":"Azure Storage Queue service logging of read requests is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-155","references":["https://docs.microsoft.com/en-us/azure/storage/queues/monitor-queue-storage"],"resolve":"Set `logging.read` attribute to `true`","severity":"low","subType":"Storage","title":"Storage Queue read logging is disabled","type":"terraform"},"SNYK_CC_TF_156":{"id":"256","impact":"Audit records may not be available during investigation","issue":"Azure Activity Log retention period is below 365 days","policyEngineType":"opa","publicId":"SNYK-CC-TF-156","references":["https://docs.microsoft.com/en-us/azure/azure-monitor/platform/activity-log"],"resolve":"Set `retention_policy.days` attribute to `365` or greater","severity":"low","subType":"Monitor","title":"Insufficient Activity Log retention period","type":"terraform"},"SNYK_CC_TF_157":{"id":"257","impact":"Audit records may not be available during investigation","issue":"Azure Activity Log profile does not capture logs for all categories","policyEngineType":"opa","publicId":"SNYK-CC-TF-157","references":["https://docs.microsoft.com/en-us/rest/api/monitor/logprofiles/createorupdate#logprofileresource"],"resolve":"Set `categories` attribute to `['Action', 'Delete', 'Write']`","severity":"low","subType":"Monitor","title":"Audit profile does not capture all categories","type":"terraform"},"SNYK_CC_TF_160":{"id":"260","impact":"Service may be accessible without authorization","issue":"Azure App Service authentication is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-160","references":["https://docs.microsoft.com/en-us/azure/app-service/overview-authentication-authorization"],"resolve":"Set `auth_settings.enabled` attribute to `true`","severity":"low","subType":"App Service (Web Apps)","title":"App Service authentication disabled","type":"terraform"},"SNYK_CC_TF_161":{"id":"261","impact":"Authentication and authorization will not be possible via Microsoft Identity platform","issue":"Azure App Service identity is not configured","policyEngineType":"opa","publicId":"SNYK-CC-TF-161","references":["https://docs.microsoft.com/en-us/azure/app-service/overview-authentication-authorization","https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app"],"resolve":"Set `identity` attribute","severity":"low","subType":"App Service (Web Apps)","title":"App Service identity missing","type":"terraform"},"SNYK_CC_TF_162":{"id":"262","impact":"Clients without authorized certificate may be allowed to connect to the application","issue":"Azure App Service does not enforce client side certificates","policyEngineType":"opa","publicId":"SNYK-CC-TF-162","references":["https://docs.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth"],"resolve":"Set `client_cert_enabled` attribute to `true`","severity":"low","subType":"App Service (Web Apps)","title":"App Service mutual TLS disabled","type":"terraform"},"SNYK_CC_TF_163":{"id":"263","impact":"No security impact. Provides performance improvement.","issue":"HTTP/2 is not enabled on the App Service","policyEngineType":"opa","publicId":"SNYK-CC-TF-163","references":["https://azure.microsoft.com/en-gb/blog/announcing-http-2-support-in-azure-app-service/"],"resolve":"Set `site_config.http2_enabled` attribute to `true`","severity":"low","subType":"App Service (Web Apps)","title":"App Service HTTP/2 disabled","type":"terraform"},"SNYK_CC_TF_164":{"id":"264","impact":"Most of Azure Security Center features are disabled under the Free tier","issue":"Azure Security Center standard tier pricing is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-164","references":["https://docs.microsoft.com/bs-cyrl-ba/azure/security-center/security-center-pricing"],"resolve":"Set `tier` attribute to `Standard`","severity":"low","subType":"Security Center","title":"Security Center Free Tier","type":"terraform"},"SNYK_CC_TF_165":{"id":"265","impact":"Increases security management overhead","issue":"Azure Security Center contact phone number is not set","policyEngineType":"opa","publicId":"SNYK-CC-TF-165","references":["https://docs.microsoft.com/en-us/azure/security-center/security-center-introduction"],"resolve":"Set `phone` attribute to point of contact phone number","severity":"low","subType":"Security Center","title":"Security Center missing phone number","type":"terraform"},"SNYK_CC_TF_166":{"id":"266","impact":"Point of contact will not be notified about critical security issues","issue":"Azure Security Center alert notifications are not enabled for the contact","policyEngineType":"opa","publicId":"SNYK-CC-TF-166","references":["https://docs.microsoft.com/en-us/azure/security-center/security-center-introduction","https://docs.microsoft.com/en-us/azure/security-center/security-center-managing-and-responding-alerts"],"resolve":"Set `alert_notifications` attribute to `true`","severity":"low","subType":"Security Center","title":"Security Center alert notification disabled","type":"terraform"},"SNYK_CC_TF_167":{"id":"267","impact":"Audit records may not be available during investigation","issue":"Azure SQL Server Auditing is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-167","references":["https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview"],"resolve":"Set `extended_auditing_policy` attribute","severity":"low","subType":"Database","title":"SQL Server auditing is disabled","type":"terraform"},"SNYK_CC_TF_168":{"id":"268","impact":"Disabled alert types will not be send to analyst for investigation","issue":"Azure SQL Threat detection type is explicitly disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-168","references":["https://docs.microsoft.com/en-us/azure/azure-sql/managed-instance/threat-detection-configure"],"resolve":"Remove `disabled_alerts` attribute","severity":"low","subType":"Database","title":"SQL Advanced Threat detection type is disabled","type":"terraform"},"SNYK_CC_TF_169":{"id":"269","impact":"Alerts may not be delivered to the analysts","issue":"Azure SQL Threat detection policy is missing email recipients","policyEngineType":"opa","publicId":"SNYK-CC-TF-169","references":["https://docs.microsoft.com/en-us/azure/azure-sql/managed-instance/threat-detection-configure"],"resolve":"Set `email_addresses` attribute","severity":"low","subType":"Database","title":"Missing email recipients for SQL threat alerts","type":"terraform"},"SNYK_CC_TF_170":{"id":"270","impact":"Alerts may not be delivered to the account administrator","issue":"Azure SQL Threat detection email notification is not enabled for account administrator","policyEngineType":"opa","publicId":"SNYK-CC-TF-170","references":["https://docs.microsoft.com/en-us/azure/azure-sql/managed-instance/threat-detection-configure"],"resolve":"Set `email_account_admin` attribute to `true`","severity":"low","subType":"Database","title":"SQL Advanced Threat alerts are not send to admins","type":"terraform"},"SNYK_CC_TF_171":{"id":"271","impact":"Abnormal spike in connections can lead to denial of service condition","issue":"Azure PostgreSQL 'connection_throttling' is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-171","references":["https://docs.microsoft.com/en-us/azure/postgresql/policy-reference"],"resolve":"Set `name` attribute to `connection_throttling` and `value` attribute to `ON`","severity":"low","subType":"Database","title":"The connection_throttling setting is disabled on PostgreSQL DB","type":"terraform"},"SNYK_CC_TF_172":{"id":"272","impact":"Services will not be able to access the storage account over network","issue":"Network access bypass for Trusted Microsoft Services is not enabled on the storage account","policyEngineType":"opa","publicId":"SNYK-CC-TF-172","references":["https://docs.microsoft.com/en-gb/azure/storage/common/storage-network-security#trusted-microsoft-services"],"resolve":"Set `network_rules.bypass` attribute to `['Azure Services']`","severity":"low","subType":"Storage","title":"Trusted Microsoft Service access to storage account is disabled","type":"terraform"},"SNYK_CC_TF_173":{"id":"273","impact":"Key rotation will not be enforced, which can lead to use of stale or compromised credentials","issue":"Expiration date is not set for Azure Vault key","policyEngineType":"opa","publicId":"SNYK-CC-TF-173","references":["https://docs.microsoft.com/en-us/azure/key-vault/general/basic-concepts"],"resolve":"Set `expiration_date` attribute to date in the future, with format `YYYY-MM-DD'T'H:M:S'Z'`, e.g `2019-01-01T01:02:03Z`","severity":"low","subType":"Key Vault","title":"Vault key expiration date not set","type":"terraform"},"SNYK_CC_TF_174":{"id":"274","impact":"Secret rotation will not be enforced, which can lead to use of stale or compromised credentials","issue":"Expiration date is not set for Azure Vault secret","policyEngineType":"opa","publicId":"SNYK-CC-TF-174","references":["https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates"],"resolve":"Set `expiration_date` attribute to date in the future, with format `Y-m-d'T'H:M:S'Z'`, e.g.`2019-01-01T01:02:03Z`","severity":"low","subType":"Key Vault","title":"Vault secret expiration date not set","type":"terraform"},"SNYK_CC_TF_175":{"id":"275","impact":"Accidentally deleted key material will not recoverable","issue":"Azure Key Vault soft-delete feature is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-175","references":["https://docs.microsoft.com/en-us/azure/key-vault/general/soft-delete-overview"],"resolve":"Set `purge_protection_enabled` attribute to `true`, and `soft_delete_enabled` attribute to `true`","severity":"low","subType":"Key Vault","title":"Vault accidental key deletion prevention disabled","type":"terraform"},"SNYK_CC_TF_176":{"id":"276","impact":"Cannot utilize network policies feature to provide network segmentation between services","issue":"Azure Kubernetes Service cluster has network policies disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-176","references":["https://docs.microsoft.com/en-us/azure/aks/use-network-policies"],"resolve":"Set `network_profile.network_policy` attribute to `azure` or `calico`","severity":"low","subType":"Container","title":"AKS Network Policies disabled","type":"terraform"},"SNYK_CC_TF_177":{"id":"277","impact":"Increases attack vectors of kubernetes cluster","issue":"Azure Kubernetes Service cluster has Kubernetes Dashboard enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-177","references":["https://docs.microsoft.com/en-us/azure/aks/kubernetes-dashboard"],"resolve":"Set `addon_profile.kube_dashboard` attribute to `false`","severity":"low","subType":"Container","title":"AKS Kubernetes Dashboard enabled","type":"terraform"},"SNYK_CC_TF_179":{"id":"279","impact":"Potentially anyone can access storage account over the network","issue":"Azure storage account network rules allow traffic by default","policyEngineType":"opa","publicId":"SNYK-CC-TF-179","references":["https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security"],"resolve":"Set `default_action` attribute to `Deny`","severity":"high","subType":"Storage","title":"Storage Account allows any traffic by default","type":"terraform"},"SNYK_CC_TF_181":{"id":"281","impact":"Potentially anyone can access data stored in container or blob","issue":"Azure Storage Container allows public access","policyEngineType":"opa","publicId":"SNYK-CC-TF-181","references":["https://docs.microsoft.com/en-us/azure/storage/blobs/anonymous-read-access-prevent"],"resolve":"Set `container_access_type` attribute to `private`","severity":"high","subType":"Storage","title":"Storage container allows public access","type":"terraform"},"SNYK_CC_TF_182":{"id":"282","impact":"The secret value will be readable to anyone with access to VCS, which can lead to unauthorized data disclosure or privilege escalation","issue":"Secret value has been declared in virtual machine configuration","policyEngineType":"opa","publicId":"SNYK-CC-TF-182","references":["https://docs.microsoft.com/en-gb/azure/key-vault/general/basic-concepts"],"resolve":"Remove secret value from configuration","severity":"high","subType":"Compute","title":"Secret value detected in VM declaration","type":"terraform"},"SNYK_CC_TF_20":{"id":"120","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-20","references":[],"resolve":"Set source_addresses to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Network","title":"Azure Firewall Network Rule Collection allows public access","type":"terraform"},"SNYK_CC_TF_21":{"id":"121","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-21","references":[],"resolve":"Set source_addresses to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Network","title":"Azure Firewall Application Rule allows public access","type":"terraform"},"SNYK_CC_TF_23":{"id":"123","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-23","references":[],"resolve":"Set start_ip_address to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Data Lake","title":"Azure Data Lake Analytics Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_24":{"id":"124","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-24","references":[],"resolve":"Set start_ip_address to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Data Lake","title":"Azure Data Lake Store Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_243":{"id":"343","impact":"Compromised credentials can be re-used for long period of time","issue":"Azure shared access signature has a long expiry time","policyEngineType":"opa","publicId":"SNYK-CC-TF-243","references":["https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview"],"resolve":"Set `expiry` attribute to 1h in the future","severity":"medium","subType":"Storage","title":"Long expiry for SAS token","type":"terraform"},"SNYK_CC_TF_244":{"id":"344","impact":"Signature can be exposed on non-encrypted channels","issue":"Azure shared access signature does not enforce HTTPS only","policyEngineType":"opa","publicId":"SNYK-CC-TF-244","references":["https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview"],"resolve":"Set `https_only` attribute to `true`","severity":"medium","subType":"Storage","title":"SAS token can be used over insecure HTTP","type":"terraform"},"SNYK_CC_TF_245":{"id":"345","impact":"Application cannot benefit from latest security improvements to runtime engine","issue":"Azure App Service is not running latest available .Net version","policyEngineType":"opa","publicId":"SNYK-CC-TF-245","references":["https://docs.microsoft.com/en-us/azure/app-service/configure-language-dotnet-framework"],"resolve":"Set `site_config.dotnet_framework_version` attribute to `v5.0`","severity":"low","subType":"App Service (Web Apps)","title":"App Service not running latest .Net version","type":"terraform"},"SNYK_CC_TF_246":{"id":"346","impact":"Application cannot benefit from latest security improvements to runtime engine","issue":"Azure App Service is not running latest available PHP version","policyEngineType":"opa","publicId":"SNYK-CC-TF-246","references":["https://docs.microsoft.com/en-us/azure/app-service/configure-language-php?pivots=platform-linux"],"resolve":"Set `site_config.php_version` attribute to `7.4`","severity":"low","subType":"App Service (Web Apps)","title":"App Service not running latest PHP version","type":"terraform"},"SNYK_CC_TF_247":{"id":"347","impact":"Application cannot benefit from latest security improvements to runtime engine","issue":"Azure App Service is not running latest available Python version","policyEngineType":"opa","publicId":"SNYK-CC-TF-247","references":["https://docs.microsoft.com/en-us/azure/app-service/configure-language-python"],"resolve":"Set `site_config.python_version` attribute to `3.4`","severity":"low","subType":"App Service (Web Apps)","title":"App Service not running latest Python version","type":"terraform"},"SNYK_CC_TF_248":{"id":"348","impact":"Application cannot benefit from latest security improvements to runtime engine","issue":"Azure App Service is not running latest available Java version","policyEngineType":"opa","publicId":"SNYK-CC-TF-248","references":["https://docs.microsoft.com/en-us/azure/app-service/configure-language-java?pivots=platform-linux"],"resolve":"Set `site_config.java_version` attribute to `11`","severity":"low","subType":"App Service (Web Apps)","title":"App Service not running latest Java version","type":"terraform"},"SNYK_CC_TF_25":{"id":"125","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-25","references":[],"resolve":"Set start_ip_address to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Database","title":"Azure MariaDB Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_257":{"id":"357","impact":"Connection logs will not be available for troubleshooting, or investigations","issue":"Azure Postgresql server log_connections setting is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-257","references":["https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-cli"],"resolve":"Set `name` attribute to `log_connections`, and `value` attribute to `on`","severity":"low","subType":"Database","title":"The log_connections setting is disabled on Postgresql Server","type":"terraform"},"SNYK_CC_TF_258":{"id":"358","impact":"Disconnection logs will not be available for troubleshooting, or investigations","issue":"Azure Postgresql server log_disconnects setting is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-258","references":["https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-cli"],"resolve":"Set `name` attribute to `log_disconnections`, and `value` attribute to `on`","severity":"low","subType":"Database","title":"The log_disconnections setting is disabled on Postgresql server","type":"terraform"},"SNYK_CC_TF_259":{"id":"359","impact":"Logs of session or statement execution duration will not be captured","issue":"Azure Postgresql server log_duration setting is not set","policyEngineType":"opa","publicId":"SNYK-CC-TF-259","references":["https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-cli"],"resolve":"Set `name` attribute to `log_duration`, and `value` attribute to `on`","severity":"low","subType":"Database","title":"The log_duration setting is not configured on Postgresql server","type":"terraform"},"SNYK_CC_TF_26":{"id":"126","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-26","references":[],"resolve":"Set start_ip_address to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Database","title":"Azure Mysql Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_260":{"id":"360","impact":"Logs will only be preserved for a short period of time which can impede troubleshooting or investigations","issue":"Azure Postgresql server log_retention_days is below 3 days","policyEngineType":"opa","publicId":"SNYK-CC-TF-260","references":["https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-cli"],"resolve":"Set `name` attribute to `log_retention_days`, and `value` to `4` or greater","severity":"low","subType":"Database","title":"The log_retention_days setting is below 3 days","type":"terraform"},"SNYK_CC_TF_263":{"id":"363","impact":"The secret value will be readable to anyone with access to VCS, which can lead to unauthorized data disclosure or privilege escalation","issue":"Administrative password has been set in terraform configuration file","policyEngineType":"opa","publicId":"SNYK-CC-TF-263","references":["https://docs.microsoft.com/en-us/azure/virtual-machines/linux/mac-create-ssh-keys"],"resolve":"Set `admin_ssh_key` attribute instead of password authentication","severity":"high","subType":"Compute","title":"Hardcoded admin password in VM configuration","type":"terraform"},"SNYK_CC_TF_27":{"id":"127","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-27","references":[],"resolve":"Set start_ip_address to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Database","title":"Azure Postgresql Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_28":{"id":"128","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-28","references":[],"resolve":"Set start_ip to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Redis","title":"Azure Redis Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_29":{"id":"129","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-29","references":[],"resolve":"Set start_ip_address to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Database","title":"Azure SQL Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_30":{"id":"130","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-30","references":[],"resolve":"Set start_ip_address to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Synapse","title":"Azure Synapse Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_33":{"id":"133","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-33","references":[],"resolve":"Set source_address_prefix to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Network","title":"Azure Network Security Group allows public access","type":"terraform"},"SNYK_CC_TF_35":{"id":"135","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-35","references":[],"resolve":"Set source_address_prefix to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Network","title":"Azure Network Security Rule allows public access","type":"terraform"},"SNYK_CC_TF_76":{"id":"176","impact":"Open egress can be used to exfiltrate data to unauthorized destinations, and enable access to potentially malicious resources","issue":"The security group rule allows open egress","policyEngineType":"opa","publicId":"SNYK-CC-TF-76","references":["https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview","https://docs.microsoft.com/en-us/azure/virtual-network/service-tags-overview"],"resolve":"Set `destination_address_prefix` attribute to specific ranges e.g. `192.168.1.0/24`","severity":"low","subType":"Network","title":"Azure Network Security Rule allows open egress","type":"terraform"},"SNYK_CC_TF_77":{"id":"177","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The disk is not encrypted at rest","policyEngineType":"opa","publicId":"SNYK-CC-TF-77","references":["https://azure.microsoft.com/en-gb/updates/azure-managed-disks-sse/","https://docs.microsoft.com/en-us/azure/virtual-machines/disk-encryption"],"resolve":"Set `encryption_settings.enabled` attribute to `true`","severity":"medium","subType":"Compute","title":"Encryption at rest is disabled","type":"terraform"},"SNYK_CC_TF_78":{"id":"178","impact":"That should someone gain unauthorized access to the data they would be able to read the contents.","issue":"The data lake store is not encrypted at rest","policyEngineType":"opa","publicId":"SNYK-CC-TF-78","references":["https://docs.microsoft.com/en-us/azure/storage/blobs/security-recommendations"],"resolve":"Set `encryption_state` attribute to `Enabled` or delete the attribute","severity":"medium","subType":"Data Lake","title":"Non-Encrypted Data Lake Store","type":"terraform"},"SNYK_CC_TF_79":{"id":"179","impact":"The password authentication is less resistant to brute force and educated guess attacks then SSH only","issue":"The password authentication for virtual machine has been enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-79","references":["https://docs.microsoft.com/en-us/azure/virtual-machines/security-policy"],"resolve":"Set `disable_password_authentication` attribute to `true` or remove the attribute","severity":"medium","subType":"Compute","title":"Password authentication enabled","type":"terraform"},"SNYK_CC_TF_80":{"id":"180","impact":"Administrators won't be able to configure role based access controls to resources","issue":"The Kubernetes RBAC is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-80","references":["https://docs.microsoft.com/en-us/azure/aks/concepts-identity"],"resolve":"Set `role_based_access_control.enabled` attribute to `true` or remove the attribute","severity":"high","subType":"Container","title":"RBAC is disabled","type":"terraform"},"SNYK_CC_TF_81":{"id":"181","impact":"Increases attack vector reachability","issue":"The Kubernetes API server could be accessible by anyone","policyEngineType":"opa","publicId":"SNYK-CC-TF-81","references":["https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges"],"resolve":"Set `api_server_authorized_ip_ranges` attribute to specific range e.g. 10.0.0.0/16","severity":"medium","subType":"Container","title":"API Server allows public access","type":"terraform"},"SNYK_CC_TF_82":{"id":"182","impact":"Performance of workloads cannot be monitored via Azure Monitoring","issue":"Login to Azure Monitoring is not configured","policyEngineType":"opa","publicId":"SNYK-CC-TF-82","references":["https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"],"resolve":"Set `addon_profile.oms_agent.enabled` attribute to `true`","severity":"low","subType":"Container","title":"Azure Monitor login addon not configured","type":"terraform"}},"gcp":{"SNYK_CC_GCP_195":{"id":"295","impact":"Increases the security management overhead","issue":"GKE node pool automatic upgrades are disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-195","references":["https://cloud.google.com/blog/products/gcp/toward-better-node-management-with-kubernetes-and-google-container-engine","https://cloud.google.com/kubernetes-engine/docs/how-to/node-pools"],"resolve":"Set `management.auto_upgrade` attribute to `true`","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE Node Pool auto upgrade disabled","type":"terraform"},"SNYK_CC_GCP_196":{"id":"296","impact":"Network policies cannot be used as part of defence in depth controls","issue":"GKE network policies enforcement is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-196","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy","https://cloud.google.com/kubernetes-engine/docs/tutorials/network-policy"],"resolve":"Set `network_policy.enabled` attribute to `true`","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE Network Policies enforcement disabled","type":"terraform"},"SNYK_CC_GCP_202":{"id":"302","impact":"Increases the security management overhead","issue":"GKE cluster does not have resource labels","policyEngineType":"opa","publicId":"SNYK-CC-TF-202","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/creating-managing-labels"],"resolve":"Set `resource_labels` attribute","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE cluster labels are missing","type":"terraform"},"SNYK_CC_GCP_203":{"id":"303","impact":"Increases the security management overhead","issue":"Container-optimized OS is not used as image for node pool","policyEngineType":"opa","publicId":"SNYK-CC-TF-203","references":["https://cloud.google.com/container-optimized-os","https://cloud.google.com/kubernetes-engine/docs/how-to/node-images"],"resolve":"Set `node_config.image_type` attribute to `cos` based image, or remove attribute","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE Node pool does not use COS","type":"terraform"},"SNYK_CC_GCP_231":{"id":"331","impact":"Metrics will not be collected into Stackdriver for visibility","issue":"GKE Stackdriver monitoring is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-231","references":["https://cloud.google.com/migrate/compute-engine/docs/4.9/how-to/monitoring/monitoring-overview"],"resolve":"Set `monitoring_service` attribute to  `monitoring.googleapis.com/kubernetes`, or remove attribute","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE Stackdriver monitoring disabled","type":"terraform"},"SNYK_CC_GCP_232":{"id":"332","impact":"Increases the security management overhead","issue":"GKE node pool automatic repair is disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-232","references":["https://cloud.google.com/blog/products/gcp/toward-better-node-management-with-kubernetes-and-google-container-engine","https://cloud.google.com/kubernetes-engine/docs/how-to/node-pools"],"resolve":"Set `management.auto_repair` attribute to `true`","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE Node Pool auto repair disabled","type":"terraform"},"SNYK_CC_GCP_269":{"id":"369","impact":"GCP will not perform anti-spoofing checks against traffic","issue":"GKE cluster does not have Alias IP range defined","policyEngineType":"opa","publicId":"SNYK-CC-TF-269","references":["https://cloud.google.com/vpc/docs/alias-ip#key_benefits_of_alias_ip_ranges"],"resolve":"Set `ip_allocation_policy` attribute with dedicated IP ranges","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE Alias IP disabled","type":"terraform"},"SNYK_CC_GCP_270":{"id":"370","impact":"Connections to the instance can be established on non-encrypted channel","issue":"SSL is not enabled on CloudSQL instance","policyEngineType":"opa","publicId":"SNYK-CC-GCP-270","references":["https://cloud.google.com/sql/docs/mysql/configure-ssl-instance#enforcing-ssl"],"resolve":"Set `settings.ip_configuration.require_ssl` attribute to `true`","severity":"medium","subType":"Cloud SQL","title":"SSL is not enabled on CloudSQL instance","type":"terraform"},"SNYK_CC_GCP_271":{"id":"371","impact":"The accidental or malicious changes to object will not be reversible","issue":"Object versioning is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-GCP-271","references":["https://cloud.google.com/storage/docs/object-versioning"],"resolve":"Set `versioning.enabled` attribute to `true`","severity":"low","subType":"Cloud Storage","title":"Object versioning is not enabled","type":"terraform"},"SNYK_CC_GCP_272":{"id":"372","impact":"Events for some users or services will not be collected","issue":"IAM audit logging setting is not configured correctly","policyEngineType":"opa","publicId":"SNYK-CC-GCP-272","references":["https://cloud.google.com/iam/docs/audit-logging"],"resolve":"Set `service` attribute to `allServices`, set `audit_log_config.log_type` for all `DATA_READ`, `DATA_WRITE`, and `ADMIN_READ`, and remove remove any `audit_log_config.exempted_members` attributes","severity":"low","subType":"Cloud Platform","title":"IAM audit logging configuration does not encompass all events and users","type":"terraform"},"SNYK_CC_GCP_273":{"id":"373","impact":"DNS responses may be subject to manipulation","issue":"DNSSEC extension is not enabled on managed zone","policyEngineType":"opa","publicId":"SNYK-CC-GCP-273","references":["CIS Google Cloud Platform Foundation v1.1.0 - 3.3 Ensure that DNSSEC is enabled for Cloud DNS","https://www.icann.org/resources/pages/dnssec-what-is-it-why-important-2019-03-05-en","https://cloud.google.com/dns/docs/dnssec"],"resolve":"Set `dnssec_config` block attribute","severity":"low","subType":"Cloud DNS","title":"DNSSEC is not enabled on managed zone","type":"terraform"},"SNYK_CC_GCP_274":{"id":"374","impact":"Usage information will not be collected. This may impact ability to determine who accessed data stored in the bucket","issue":"Logging is not enabled on storage bucket","policyEngineType":"opa","publicId":"SNYK-CC-GCP-274","references":["https://cloud.google.com/storage/docs/xml-api/put-bucket-logging","https://cloud.google.com/storage/docs/access-logs"],"resolve":"Set `logging` block attribute","severity":"low","subType":"Cloud Storage","title":"Logging is not enabled on storage bucket","type":"terraform"},"SNYK_CC_GCP_275":{"id":"375","impact":"Increases security management overhead","issue":"Default network will be automatically created for the project","policyEngineType":"opa","publicId":"SNYK-CC-GCP-275","references":["https://cloud.google.com/vpc/docs/vp://cloud.google.com/vpc/docs/vpc#default-networkc"],"resolve":"Set `auto_create_network` attribute to `false`","severity":"low","subType":"Cloud Platform","title":"Default network automatically created","type":"terraform"},"SNYK_CC_GCP_276":{"id":"376","impact":"The system may be subject to collision attack","issue":"DNSSEC is configured with weak algorithm","policyEngineType":"opa","publicId":"SNYK-CC-GCP-276","references":["https://cloud.google.com/dns/docs/dnssec-advanced","https://shattered.io/"],"resolve":"Set `dnssec_config.default_key_specs.algorithm` attribute to safe algorithm for example `rsasha512`","severity":"medium","subType":"Cloud DNS","title":"DNSSEC is configured with weak algorithm","type":"terraform"},"SNYK_CC_GCP_277":{"id":"377","impact":"Instance can be used for packet interception and sending spoofed requests","issue":"IP forwarding is enabled on compute instance","policyEngineType":"opa","publicId":"SNYK-CC-GCP-277","references":["CIS Google Cloud Platform Foundation v1.1.0 - 4.6 Ensure that IP forwarding is not enabled on Instances","https://cloud.google.com/vpc/docs/using-routes#canipforward","https://attack.mitre.org/techniques/T1557/002/"],"resolve":"Set `can_ip_forward` attribute to `false`","severity":"low","subType":"Compute Engine","title":"IP forwarding is enabled","type":"terraform"},"SNYK_CC_GCP_278":{"id":"378","impact":"Keys can become compromised over period of time which can lead to loss of privacy","issue":"KMS keys are not automatically rotated at least once a year","policyEngineType":"opa","publicId":"SNYK-CC-GCP-278","references":["https://cloud.google.com/kms/docs/key-rotation"],"resolve":"Set `rotation_period` attribute to number lower than `31536000s` (1 year)","severity":"low","subType":"Cloud Key Management Service","title":"KMS keys are not automatically rotated","type":"terraform"},"SNYK_CC_GCP_279":{"id":"379","impact":"GCP IAM role bindings cannot be used to manage SSH access to instances","issue":"OS Login is not enabled on compute project","policyEngineType":"opa","publicId":"SNYK-CC-GCP-279","references":["CIS Google Cloud Platform Foundation v1.1.0 - 4.4 Ensure oslogin is enabled for a Project","https://cloud.google.com/compute/docs/oslogin","https://cloud.google.com/compute/docs/instances/managing-instance-access"],"resolve":"Set `metadata.enable-oslogin` attribute to `true`","severity":"low","subType":"Compute Engine","title":"OS Login disabled","type":"terraform"},"SNYK_CC_GCP_280":{"id":"380","impact":"GCP IAM roles cannot be used to manage SSH access to the instance","issue":"OS Login authentication is disabled on compute instance","policyEngineType":"opa","publicId":"SNYK-CC-GCP-280","references":["https://cloud.google.com/compute/docs/instances/managing-instance-access","https://cloud.google.com/compute/docs/oslogin","https://cloud.google.com/compute/docs/storing-retrieving-metadata"],"resolve":"Set `metadata.enable-oslogin` attribute to `true`","severity":"low","subType":"Compute Engine","title":"OS Login disabled on instance","type":"terraform"},"SNYK_CC_GCP_281":{"id":"381","impact":"Anyone with access to generic key can access the instance","issue":"Project wide ssh keys grant access to compute instance","policyEngineType":"opa","publicId":"SNYK-CC-GCP-281","references":["https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys#block-project-keys"],"resolve":"Set `metadata.block-project-ssh-keys` attribute to `true`","severity":"low","subType":"Compute Engine","title":"Project wide ssh keys are allowed","type":"terraform"},"SNYK_CC_GCP_282":{"id":"382","impact":"Advanced security features such as secure boot and firmware integrity checks will not be enabled on the instance","issue":"Shielded VM feature is not enabled on compute instance","policyEngineType":"opa","publicId":"SNYK-CC-GCP-282","references":["CIS Google Cloud Platform Foundation v1.1.0 - 4.8 Ensure Compute instances are launched with Shielded VM enabled","https://cloud.google.com/security/shielded-cloud/shielded-vm","https://cloud.google.com/compute/docs/instances/modifying-shielded-vm","https://cloud.google.com/compute/docs/images/os-details#security-features"],"resolve":"Set `shielded_instance_config.enable_integrity_monitoring`, `shielded_instance_config.enable_secure_boot` and `shielded_instance_config.enable_vtpm` attributes to `true`","severity":"medium","subType":"Compute Engine","title":"Shielded VM disabled","type":"terraform"},"SNYK_CC_GCP_283":{"id":"383","impact":"Data will not be recoverable in the event of failure or malicious attack","issue":"Automated backup is explicitly disabled","policyEngineType":"opa","publicId":"SNYK-CC-GCP-283","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.7 Ensure that Cloud SQL database instances are configured with automated backups","https://cloud.google.com/sql/docs/sqlserver/backup-recovery/backups"],"resolve":"Set `settings.backup_configuration.enabled` attribute to `true`","severity":"medium","subType":"Cloud SQL","title":"Cloud SQL instance backup disabled","type":"terraform"},"SNYK_CC_GCP_284":{"id":"384","impact":"Default compute engine account grants editor role permissions to the instance","issue":"Default service account granted to the instance","policyEngineType":"opa","publicId":"SNYK-CC-GCP-284","references":["CIS Google Cloud Platform Foundation v1.1.0 - 4.1 Ensure that instances are not configured to use the default service account","https://cloud.google.com/compute/docs/access/service-accounts#default_service_account"],"resolve":"Set `service_account` attribute with custom service account information","severity":"high","subType":"Compute Engine","title":"Default service account used","type":"terraform"},"SNYK_CC_GCP_285":{"id":"385","impact":"Serial port grants direct access to instance boot manager, and may lead to bypass of operating system access controls","issue":"Serial port interface is enabled on the instance","policyEngineType":"opa","publicId":"SNYK-CC-GCP-285","references":["https://cloud.google.com/compute/docs/instances/interacting-with-serial-console"],"resolve":"Remove `metadata.serial-port-enabled` attribute","severity":"high","subType":"Compute Engine","title":"Serial port enabled","type":"terraform"},"SNYK_CC_GCP_286":{"id":"386","impact":"Older cipher suites could be vulnerable to hijacking and information disclosure","issue":"SSL policy allows weak algorithms","policyEngineType":"opa","publicId":"SNYK-CC-GCP-286","references":["https://cloud.google.com/load-balancing/docs/ssl-policies-concepts#profilefeaturesupport"],"resolve":"Set `profile` attribute to `RESTRICTED` or `MODERN`","severity":"low","subType":"Compute Engine","title":"SSL policy allows weak algorithms","type":"terraform"},"SNYK_CC_GCP_287":{"id":"387","impact":"Verbose logging information of database will not be collected","issue":"PostgreSQL 'log_checkpoints' is disabled","policyEngineType":"opa","publicId":"SNYK-CC-GCP-287","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.2.1 Ensure that the 'log_checkpoints' database flag for Cloud SQL PostgreSQL instance is set to 'on'","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set `settings.database_flags.name` attribute to `\"log_checkpoints\"`, and `settings.database_flags.value` attribute to `\"on\"`","severity":"low","subType":"Cloud SQL","title":"The log_checkpoints is disabled on PostgreSQL DB","type":"terraform"},"SNYK_CC_GCP_288":{"id":"388","impact":"Connection logs will not be available for troubleshooting or investigations","issue":"PostgreSQL 'log_connections' is disabled","policyEngineType":"opa","publicId":"SNYK-CC-GCP-288","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.2.2 Ensure that the 'log_connections' database flag for Cloud SQL PostgreSQL instance is set to 'on'","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set `settings.database_flags.name` attribute to `\"log_connections\"`, and `settings.database_flags.value` attribute to `\"on\"`","severity":"low","subType":"Cloud SQL","title":"The log_connections setting is disabled on Postgresql DB","type":"terraform"},"SNYK_CC_GCP_289":{"id":"389","impact":"Disconnection logs will not be available for troubleshooting or investigations","issue":"PostgreSQL 'log_disconnections' is disabled","policyEngineType":"opa","publicId":"SNYK-CC-GCP-289","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.2.3 Ensure that the 'log_disconnections' database flag for Cloud SQL PostgreSQL instance is set to 'on'","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set the `settings.database_flags.name` attribute to `\"log_disconnections\"` and `settings.database_flags.value` attribute to `\"on\"`","severity":"low","subType":"Cloud SQL","title":"The log_disconnections setting is disabled on PostgreSQL DB","type":"terraform"},"SNYK_CC_GCP_290":{"id":"390","impact":"Deadlock timeouts logs will not be available for troubleshooting, or investigations","issue":"PostgreSQL 'log_lock_waits' is disabled","policyEngineType":"opa","publicId":"SNYK-CC-GCP-290","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.2.4 Ensure that the 'log_lock_waits' database flag for Cloud SQL PostgreSQL instance is set to 'on' ","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set `settings.database_flags.name` attribute to `\"log_lock_waits\"`, and `settings.database_flags.value` attribute to `\"on\"`","severity":"low","subType":"Cloud SQL","title":"The log_lock_waits setting is disabled on PostgreSQL DB","type":"terraform"},"SNYK_CC_GCP_291":{"id":"391","impact":"Some temporary files information may not be logged, which may impact ability to identify potential performance issues","issue":"PostgreSQL 'log_temp_files' is not set to 0","policyEngineType":"opa","publicId":"SNYK-CC-GCP-291","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.2.6 Ensure that the 'log_temp_files' database flag for Cloud SQL PostgreSQL instance is set to '0'","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set the `settings.database_flags.name` attribute to `\"log_temp_files\"`, and `settings.database_flags.value` attribute to `0`","severity":"low","subType":"Cloud SQL","title":"Temporary file information is not logged","type":"terraform"},"SNYK_CC_GCP_292":{"id":"392","impact":"Some SQL statements may be logged and expose sensitive information","issue":"PostgreSQL 'log_min_duration_statement' is not set to -1","policyEngineType":"opa","publicId":"SNYK-CC-GCP-292","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.2.7 Ensure that the 'log_min_duration_statement' database flag for Cloud SQL PostgreSQL instance is set to '-1' (disabled)","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set the `settings.database_flags.name` attribute to `\"log_min_duration_statement\"` and `settings.database_flags.value` attribute to `-1`","severity":"low","subType":"Cloud SQL","title":"SQL statements may be logged","type":"terraform"},"SNYK_CC_GCP_293":{"id":"393","impact":"May lead to privilege escalation, or bypass of access controls if not all databases have to participate in the chaining","issue":"Microsoft SQL Server cross db ownership is enabled at server level","policyEngineType":"opa","publicId":"SNYK-CC-GCP-293","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.3.1 Ensure that the 'cross db ownership chaining' database flag for Cloud SQL SQL Server instance is set to 'off'","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set `settings.database_flags.name` attribute to `\"cross db ownership chaining\"`, and `settings.database_flags.value` attribute to `\"off\"`","severity":"medium","subType":"Cloud SQL","title":"Cross DB ownership chaining is enabled","type":"terraform"},"SNYK_CC_GCP_294":{"id":"394","impact":"Authorization to the database can be enabled on database and bypass Database Engine permissions","issue":"Contained database authentication is enabled on SQL server","policyEngineType":"opa","publicId":"SNYK-CC-GCP-294","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.3.2 Ensure that the 'contained database authentication' database flag for Cloud SQL on the SQL Server instance is set to 'off'","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Set `settings.database_flags.name` attribute to `\"contained database authentication\"`, and `settings.database_flags.value` attribute to `\"off\"`","severity":"medium","subType":"Cloud SQL","title":"Contained database authentication is enabled","type":"terraform"},"SNYK_CC_GCP_295":{"id":"395","impact":"SSH service may be accessible over the internet which defeats network segmentation controls","issue":"Compute firewall allows all access to the SSH port","policyEngineType":"opa","publicId":"SNYK-CC-GCP-295","references":["CIS Google Cloud Platform Foundation v1.1.0 - 3.6 Ensure that SSH access is restricted from the internet","https://cloud.google.com/vpc/docs/firewalls"],"resolve":"Set `source_ranges` attribute to specific IP range for example `192.168.0.0/24`","severity":"high","subType":"Compute Engine","title":"Unrestricted SSH access","type":"terraform"},"SNYK_CC_GCP_296":{"id":"396","impact":"RDP service may be accessible over the internet which defeats network segmentation controls","issue":"Compute firewall allows all access to the RDP port","policyEngineType":"opa","publicId":"SNYK-CC-GCP-296","references":["CIS Google Cloud Platform Foundation v1.1.0 - 3.7 Ensure that RDP access is restricted from the internet","https://cloud.google.com/vpc/docs/firewalls"],"resolve":"Set `source_ranges` attribute to specific IP range for example `192.168.0.0/24`","severity":"high","subType":"Compute Engine","title":"Unrestricted RDP access","type":"terraform"},"SNYK_CC_GCP_297":{"id":"397","impact":"The content could be intercepted and manipulated in transit","issue":"App Engine application does not enforce use of HTTPS protocol","policyEngineType":"opa","publicId":"SNYK-CC-GCP-297","references":["CIS Google Cloud Platform Foundation v1.1.0 - 4.10 Ensure that App Engine applications enforce HTTPS connections","https://cloud.google.com/appengine/docs/standard/nodejs/application-security","https://cloud.google.com/appengine/docs/admin-api/reference/rest/v1beta/apps.services.versions"],"resolve":"Set `handlers.security_level` attribute to `SECURE_ALWAYS`","severity":"medium","subType":"App Engine","title":"App Engine application does not enforce HTTPS","type":"terraform"},"SNYK_CC_GCP_298":{"id":"398","impact":"Users can impersonate service accounts and abuse the elevated permissions","issue":"IAM user has Service Account User or Service Account Token Creator role assigned at project level","policyEngineType":"opa","publicId":"SNYK-CC-GCP-298","references":["CIS Google Cloud Platform Foundation v1.1.0 - 1.6 Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level","https://cloud.google.com/iam/docs/service-accounts","https://cloud.google.com/iam/docs/understanding-service-accounts#granting_minimum"],"resolve":"Remove `roles/iam.serviceAccountUser` and `roles/iam.serviceAccountTokenCreator` from project level bindings","severity":"medium","subType":"IAM","title":"IAM user with privileged roles at project level","type":"terraform"},"SNYK_CC_GCP_299":{"id":"399","impact":"Compromised application will be able to perform privilege escalation attacks and abuse administrative permissions","issue":"Service account has role assigned which grants administrative permissions to resource","policyEngineType":"opa","publicId":"SNYK-CC-GCP-299","references":["CIS Google Cloud Platform Foundation v1.1.0 - 1.5 Ensure that Service Account has no Admin privileges","https://cloud.google.com/iam/docs/service-accounts","https://cloud.google.com/iam/docs/understanding-service-accounts#granting_minimum"],"resolve":"Remove any administrative roles from accounts with pattern `*@*.iam.gserviceaccount.com`","severity":"medium","subType":"IAM","title":"Service account with admin privileges","type":"terraform"},"SNYK_CC_GCP_300":{"id":"400","impact":"Compromised application may be able to access server-side information such as configuration or secrets files","issue":"MySQL server-side LOAD DATA LOCAL capability is not disabled","policyEngineType":"opa","publicId":"SNYK-CC-GCP-300","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.1.2 Ensure that the 'local_infile' database flag for a Cloud SQL Mysql instance is set to 'off'","https://cloud.google.com/sql/docs/mysql/flags"],"resolve":"Set the `settings.database_flags.name` attribute to `local_infile`, and `settings.database_flags.value` attribute to `off`","severity":"low","subType":"Cloud SQL","title":"MySQL allows loading local data","type":"terraform"},"SNYK_CC_GCP_301":{"id":"401","impact":"Data protected by the key can be accessed by anyone","issue":"KMS key can be accessed by any user","policyEngineType":"opa","publicId":"SNYK-CC-GCP-301","references":["CIS Google Cloud Platform Foundation v1.1.0 - 1.9 Ensure that Cloud KMS cryptokeys are not anonymously or publicly accessible","https://cloud.google.com/sql/docs/postgres/flags"],"resolve":"Remove `allUsers` and `allAuthenticatedUsers` from `members` attribute","severity":"high","subType":"Cloud Key Management Service","title":"KMS key openly accessible","type":"terraform"},"SNYK_CC_TF_183":{"id":"283","impact":"Google will store your keys on it's servers and could access the data without your authorization","issue":"Customer Supplied Encryption Keys are not used to encrypt compute disk","policyEngineType":"opa","publicId":"SNYK-CC-TF-183","references":["https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk#disk_encryption_key","https://cloud.google.com/compute/docs/disks/customer-supplied-encryption","https://cloud.google.com/security/encryption-at-rest/customer-supplied-encryption-keys"],"resolve":"Ensure encrypting your VM with Customer Supplied Encryption Keys","severity":"low","subType":"Compute Engine","title":"Customer supplied encryption keys are not used to encrypt compute disk","type":"terraform"},"SNYK_CC_TF_184":{"id":"284","impact":"Google will store your keys on it's servers and could access the data without your authorization","issue":"Customer Supplied Encryption Keys are not used to encrypt VM compute instance","policyEngineType":"opa","publicId":"SNYK-CC-TF-184","references":["https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#disk_encryption_key_raw","https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#kms_key_self_link","https://cloud.google.com/compute/docs/disks/customer-supplied-encryption","https://cloud.google.com/security/encryption-at-rest/customer-supplied-encryption-keys"],"resolve":"Ensure encrypting your VM with Customer Supplied Encryption Keys","severity":"low","subType":"Compute Engine","title":"Customer supplied encryption keys are not used to encrypt VM compute instance","type":"terraform"},"SNYK_CC_TF_185":{"id":"285","impact":"Google will store your keys on it's servers and could access the data without your authorization","issue":"Customer Managed Keys are not used to encrypt storage bucket","policyEngineType":"opa","publicId":"SNYK-CC-TF-185","references":["https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#encryption","https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#default_kms_key_name","https://cloud.google.com/storage/docs/encryption","https://cloud.google.com/storage/docs/encryption/using-customer-managed-keys"],"resolve":"Ensure encrypting your Storage bucket with Customer Managed Keys (CMK).","severity":"low","subType":"Cloud Storage","title":"CMKs are not used to encrypt storage bucket","type":"terraform"},"SNYK_CC_TF_193":{"id":"293","impact":"No visibility into traffic within this cluster","issue":"Logging is disabled on Kubernetes Engine Cluster","policyEngineType":"opa","publicId":"SNYK-CC-TF-193","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging","https://cloud.google.com/stackdriver/docs/solutions/gke/managing-logs","https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#logging_service"],"resolve":"Ensure `logging_service` field is set to `logging.googleapis.com/kubernetes`","severity":"low","subType":"Kubernetes (Container) Engine","title":"Logging is disabled on Kubernetes Engine Clusters","type":"terraform"},"SNYK_CC_TF_194":{"id":"294","impact":"No visibility into network traffic within this subnet","issue":"Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network","policyEngineType":"opa","publicId":"SNYK-CC-TF-194","references":["https://cloud.google.com/vpc/docs/using-flow-logs","https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#log_config"],"resolve":"Define a `flow_logs` field with `aggregation_interval`, `flow_sampling` and `metadata` subfields.","severity":"low","subType":"Compute Engine","title":"VPC Flow Logs for VPC Network Subnets Disabled","type":"terraform"},"SNYK_CC_TF_235":{"id":"335","impact":"Potentially anyone can establish network connectivity to the database instance","issue":"Cloud SQL database instance allows public access","policyEngineType":"opa","publicId":"SNYK-CC-TF-235","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.5 Ensure that Cloud SQL database instances are not open to the world","https://cloud.google.com/sql/docs/mysql/configure-ip","https://cloud.google.com/sql/docs/mysql/configure-private-ip"],"resolve":"Set `settings.ip_configuration.authorized_networks` attribute to specific value e.g. `192.168.0.0/24`","severity":"high","subType":"Cloud SQL","title":"Cloud SQL instance is publicly accessible","type":"terraform"},"SNYK_CC_TF_236":{"id":"336","impact":"Potentially anyone can access data in the dataset","issue":"BigQuery dataset is publicly accessible","policyEngineType":"opa","publicId":"SNYK-CC-TF-236","references":["CIS Google Cloud Platform Foundation v1.1.0 - 7.1 Ensure that BigQuery datasets are not anonymously or publicly accessible","https://cloud.google.com/bigquery/public-data"],"resolve":"Remove `allAuthenticatedUsers` and `allUsers` values from `access.special_group` attribute","severity":"high","subType":"BigQuery","title":"BigQuery dataset is publicly accessible","type":"terraform"},"SNYK_CC_TF_237":{"id":"337","impact":"Potentially anyone can access the GKE administrative endpoint","issue":"GKE control plane endpoint is publicly accessible","policyEngineType":"opa","publicId":"SNYK-CC-TF-237","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks"],"resolve":"Set `master_authorized_networks_config.cidr_blocks` to specific ranges only .e.g `192.168.0.0/24`","severity":"high","subType":"Kubernetes (Container) Engine","title":"GKE control plane is publicly accessible","type":"terraform"},"SNYK_CC_TF_238":{"id":"338","impact":"Master endpoints and nodes may be configured with public addresses","issue":"GKE private cluster only configuration is not set","policyEngineType":"opa","publicId":"SNYK-CC-TF-238","references":["https://cloud.google.com/kubernetes-engine/docs/concepts/control-plane-security","https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters"],"resolve":"Set `private_cluster_config` attribute","severity":"medium","subType":"Kubernetes (Container) Engine","title":"GKE private cluster options is not enabled","type":"terraform"},"SNYK_CC_TF_239":{"id":"339","impact":"Potentially anyone can access data stored in the bucket","issue":"Cloud Storage bucket grants all users access","policyEngineType":"opa","publicId":"SNYK-CC-TF-239","references":["CIS Google Cloud Platform Foundation v1.1.0 - 5.1 Ensure that Cloud Storage bucket is not anonymously or publicly accessible","https://cloud.google.com/storage/docs/creating-buckets","https://cloud.google.com/storage/docs/access-control/making-data-public"],"resolve":"Remove `allUsers` and `allAuthenticatedUsers` values from `members` attribute","severity":"high","subType":"Cloud Storage","title":"Cloud Storage bucket is publicly accessible","type":"terraform"},"SNYK_CC_TF_240":{"id":"340","impact":"Both bucket ACLs and IAM permissions can be used to grant permissions","issue":"Cloud Storage uniform bucket-level access is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-240","references":["CIS Google Cloud Platform Foundation v1.1.0 - 5.2 Ensure that Cloud Storage buckets have uniform bucket-level access enabled","https://cloud.google.com/storage/docs/uniform-bucket-level-access"],"resolve":"Set `uniform_bucket_level_access` attribute to `true","severity":"medium","subType":"Cloud Storage","title":"Uniform bucket-level access disabled","type":"terraform"},"SNYK_CC_TF_241":{"id":"341","impact":"Instance can be accessed remotely over public Internet","issue":"Public IP will be assigned to the compute instance","policyEngineType":"opa","publicId":"SNYK-CC-TF-241","references":["CIS Google Cloud Platform Foundation v1.1.0 - 4.9 Ensure that Compute instances do not have public IP addresses","https://cloud.google.com/compute/docs/ip-addresses","https://cloud.google.com/sdk/gcloud/reference/compute/instances/create#--no-address"],"resolve":"Remove `access_config` attribute","severity":"high","subType":"Compute Engine","title":"Public IP assigned to compute instance","type":"terraform"},"SNYK_CC_TF_242":{"id":"342","impact":"Database can be accessed remotely over public Internet","issue":"Public IP will be assigned to the SQL database","policyEngineType":"opa","publicId":"SNYK-CC-TF-242","references":["CIS Google Cloud Platform Foundation v1.1.0 - 6.6 Ensure that Cloud SQL database instances do not have public IPs","https://cloud.google.com/sql/docs/mysql/configure-private-ip","https://cloud.google.com/sql/docs/sqlserver/configure-ip"],"resolve":"Set `settings.ip_configuration.ipv4_enabled` attribute to `false`","severity":"high","subType":"Cloud SQL","title":"Public IP assigned to SQL database instance","type":"terraform"},"SNYK_CC_TF_31":{"id":"131","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-31","references":[],"resolve":"Set source_range to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"App Engine","title":"GCP App Engine Firewall Rule allows public access","type":"terraform"},"SNYK_CC_TF_32":{"id":"132","impact":"That potentially everyone can access your resource","issue":"That inbound traffic is allowed to a resource from any source instead of a restricted range","policyEngineType":"opa","publicId":"SNYK-CC-TF-32","references":[],"resolve":"Set source_ranges to specific IP range only, e.g. `192.168.1.0/24`","severity":"medium","subType":"Compute Engine","title":"GCP Compute Firewall allows public access","type":"terraform"},"SNYK_CC_TF_83":{"id":"183","impact":"The ABAC may conflict with RBAC authorization and lead to unintended access violations","issue":"The legacy ABAC authorization is enabled on the cluster","policyEngineType":"opa","publicId":"SNYK-CC-TF-83","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster","https://kubernetes.io/docs/reference/access-authn-authz/abac/"],"resolve":"Set `enable_legacy_abac` attribute to `false`, or remove the attribute","severity":"high","subType":"Kubernetes (Container) Engine","title":"Legacy ABAC is enabled","type":"terraform"},"SNYK_CC_TF_84":{"id":"184","impact":"The pods may be able to access sensitive information from node's metadata service","issue":"The Workload Identity is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-84","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity","https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster"],"resolve":"Set `workload_metadata_config.node_metadata` attribute to `GKE_METADATA_SERVER`","severity":"medium","subType":"Kubernetes (Container) Engine","title":"GKE Workload Identity is disabled","type":"terraform"},"SNYK_CC_TF_85":{"id":"185","impact":"The legacy endpoints do not enforce metadata query headers, and can leak sensitive information","issue":"The legacy endpoints are enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-85","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster","https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#disable-legacy-apis"],"resolve":"Set `metadata.disable-legacy-endpoints` attribute to `true`","severity":"medium","subType":"Kubernetes (Container) Engine","title":"GKE legacy endpoint enabled","type":"terraform"},"SNYK_CC_TF_86":{"id":"186","impact":"HTTP basic authentication is supported by the latest GKE version, potentially allowing secret passwords to be stored in the state file","issue":"The basic authentication is not disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-86","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster","https://cloud.google.com/kubernetes-engine/docs/how-to/api-server-authentication#legacy-auth"],"resolve":"Set `master_auth.username` and `master_auth.password` attributes to `\"\"`","severity":"high","subType":"Kubernetes (Container) Engine","title":"GKE Basic Auth is enabled","type":"terraform"},"SNYK_CC_TF_87":{"id":"187","impact":"The client certificate authentication methods is considered legacy and increase the attack surface for the cluster","issue":"The client certificate authentication is not disabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-87","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster","https://cloud.google.com/kubernetes-engine/docs/how-to/api-server-authentication#legacy-auth"],"resolve":"Set `master_auth.issue_client_certificate` attribute to `false`","severity":"high","subType":"Kubernetes (Container) Engine","title":"GKE client certificate auth is enabled","type":"terraform"},"SNYK_CC_TF_88":{"id":"188","impact":"The Pods cannot be constrained with PodSecurityPolicies, which increases the security management overhead","issue":"The PodSecurityPolicy controller is not enabled on the cluster","policyEngineType":"opa","publicId":"SNYK-CC-TF-88","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/pod-security-policies","https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster"],"resolve":"Set `pod_security_policy_config.enabled` attribute to `true`","severity":"medium","subType":"Kubernetes (Container) Engine","title":"GKE PodSecurityPolicy controller is disabled","type":"terraform"},"SNYK_CC_TF_89":{"id":"189","impact":"Node verification will be disabled which increases the attacker's ability to impersonate a node in the cluster","issue":"The Shield GKE feature is not enabled","policyEngineType":"opa","publicId":"SNYK-CC-TF-89","references":["https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes"],"resolve":"Set `enable_shielded_nodes` attribute to `true`","severity":"low","subType":"Kubernetes (Container) Engine","title":"GKE Shield is disabled","type":"terraform"},"SNYK_CC_TF_90":{"description":"","id":"190","impact":"Increases the security management overhead","issue":"The IAM permission is directly assigned to user account","policyEngineType":"opa","publicId":"SNYK-CC-TF-90","references":["https://cloud.google.com/billing/docs/reference/rest/v1/Policy#Binding"],"resolve":"Do not include users in `members` attribute","severity":"low","subType":"IAM","title":"IAM permission assigned to user","type":"terraform"},"SNYK_CC_TF_91":{"id":"191","impact":"Open egress can be used to exfiltrate data to unauthorized destinations, and enable access to potentially malicious resources","issue":"The security group rule allows open egress","policyEngineType":"opa","publicId":"SNYK-CC-TF-91","references":[],"resolve":"Set `destination_ranges` attribute to specific net addresses e.g. `192.168.0.0/16`","severity":"low","subType":"Compute Engine","title":"GCP Compute Firewall allows open egress","type":"terraform"}},"kubernetes":{"SNYK_CC_K8S_1":{"description":"","id":"1","impact":"Compromised container could potentially modify the underlying hosts kernel by loading unauthorized modules (i.e. drivers).","issue":"Container is running in privileged mode","policyEngineType":"opa","publicId":"SNYK-CC-K8S-1","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.1 Minimize the admission of privileged containers","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privileged","https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/"],"resolve":"Remove `securityContext.privileged` attribute, or set value to `false`","severity":"high","subType":"Deployment","title":"Container is running in privileged mode","type":"k8s"},"SNYK_CC_K8S_10":{"description":"","id":"10","impact":"Container could be running with full administrative privileges","issue":"Container is running without root user control","policyEngineType":"opa","publicId":"SNYK-CC-K8S-10","references":["CIS Docker Benchmark 1.2.0 - 5.5 Ensure sensitive host system directories are not mounted on containers","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#users-and-groups","https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/"],"resolve":"Set `securityContext.runAsNonRoot` to `true`","severity":"medium","subType":"Deployment","title":"Container is running without root user control","type":"k8s"},"SNYK_CC_K8S_11":{"description":"","id":"11","impact":"UID of the container processes could clash with host's UIDs and lead to unintentional authorization bypass","issue":"`RunAsUser` value is set to low UID","policyEngineType":"opa","publicId":"SNYK-CC-K8S-11","references":["https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-container","https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/"],"resolve":"Set `securityContext.RunAsUser` value","severity":"low","subType":"Deployment","title":"Container's UID could clash with host's UID","type":"k8s"},"SNYK_CC_K8S_12":{"description":"","id":"12","impact":"Might cause unexpected network connectivity issues","issue":"hostAliases is set with custom mapping","policyEngineType":"opa","publicId":"SNYK-CC-K8S-12","references":["https://kubernetes.io/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/","https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/"],"resolve":"Remove `hostAliases` attribute","severity":"low","subType":"Deployment","title":"Container is running with custom hosts file configuration","type":"k8s"},"SNYK_CC_K8S_13":{"description":"","id":"13","impact":"Containers will be able to communicate with host's shared channels. This breaks container security boundary.","issue":"The pod is sharing host's IPC namespace","policyEngineType":"opa","publicId":"SNYK-CC-K8S-13","references":["CIS Docker Benchmark 1.2.0 - 5.16 Ensure that the host's IPC namespace is not shared","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces","https://tldp.org/LDP/tlk/ipc/ipc.html","https://tldp.org/LDP/lpg/node7.html"],"resolve":"Remove `hostIPC` attribute, or set value to `false`","severity":"medium","subType":"Deployment","title":"Container is running in host's IPC namespace","type":"k8s"},"SNYK_CC_K8S_14":{"description":"","id":"14","impact":"Containers will be able to access host's networking resources. This breaks container security boundary.","issue":"The pod is sharing host's Network namespace","policyEngineType":"opa","publicId":"SNYK-CC-K8S-14","references":["CIS Docker Benchmark 1.2.0 - 5.9 Ensure that the host's network namespace is not shared","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces","https://kubernetes.io/docs/concepts/configuration/overview/"],"resolve":"Remove `hostNetwork` attribute, or set value to `false`","severity":"medium","subType":"Deployment","title":"Container is running in host's Network namespace","type":"k8s"},"SNYK_CC_K8S_15":{"description":"","id":"15","impact":"This allows access to any traffic to the Node Security Group(s), potentially meaning everyone can access your service.","issue":"Defining a Load balancer Service without setting the loadBalancerSourceRanges property will use the default value of 0.0.0.0/0.","policyEngineType":"opa","publicId":"SNYK-CC-K8S-15","references":["https://kubernetes.io/docs/concepts/services-networking/service/","https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/"],"resolve":"Set `loadBalancerSourceRanges` attribute value to specific IP addresses","severity":"medium","subType":"Service","title":"Service does not restrict ingress sources","type":"k8s"},"SNYK_CC_K8S_16":{"description":"","id":"16","impact":"Pods will be able to run with `privileged` mode.","issue":"Privileged containers are explicitly allowed","policyEngineType":"opa","publicId":"SNYK-CC-K8S-16","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.1 Minimize the admission of privileged containers","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privileged","https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/"],"resolve":"Remove `privileged` attribute, or set vault to `false`","severity":"high","subType":"Pod Security Policy","title":"Policy allows `privileged` containers","type":"k8s"},"SNYK_CC_K8S_17":{"description":"","id":"17","impact":"Pods will be able to run with `allowPrivilegeEscalation` set to true (default value).","issue":"Privilege escalation is not explicitly forbidden via `allowPrivilegeEscalation` attribute","policyEngineType":"opa","publicId":"SNYK-CC-K8S-17","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.5 Minimize the admission of containers with allowPrivilegeEscalation","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation"],"resolve":"Set `allowPrivilegeEscalation` to `false`","severity":"low","subType":"Pod Security Policy","title":"Policy allows privilege escalation","type":"k8s"},"SNYK_CC_K8S_18":{"description":"","id":"18","impact":"All containers will be allowed to escalate privileges, unless `allowPrivilegeEscalation` attribute is enforced to `false`","issue":"Default privilege escalation control is set to `false`","policyEngineType":"opa","publicId":"SNYK-CC-K8S-18","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.5 Minimize the admission of containers with allowPrivilegeEscalation","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation"],"resolve":"Set `defaultAllowPrivilegeEscalation` value to `false`","severity":"low","subType":"Pod Security Policy","title":"Policy sets insecure default privilege escalation control","type":"k8s"},"SNYK_CC_K8S_19":{"description":"","id":"19","impact":"Containers will be able to enumerate and interact with host's processes. This breaks container security boundary","issue":"Policy does not prevent containers from running processes inside of host's PID namespace","policyEngineType":"opa","publicId":"SNYK-CC-K8S-19","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.2 Minimize the admission of containers wishing to share the host process ID namespace","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces"],"resolve":"Remove `hostPID` attribute, or set value to `false`","severity":"medium","subType":"Pod Security Policy","title":"Policy allows sharing of host's PID namespace","type":"k8s"},"SNYK_CC_K8S_2":{"description":"","id":"2","impact":"Access to docker socket from container can lead to container escape attacks and privilege escalation on the host","issue":"Docker socket has been mounted inside the pod","policyEngineType":"opa","publicId":"SNYK-CC-K8S-2","references":["CIS Docker Benchmark 1.2.0 - 5.31 Ensure that the Docker socket is not mounted inside any containers","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html","https://aws.github.io/aws-eks-best-practices/pods/#never-run-docker-in-docker-or-mount-the-socket-in-the-container"],"resolve":"Remove `docker.sock` hostPath volume","severity":"high","subType":"Deployment","title":"Container is running with docker socket mount","type":"k8s"},"SNYK_CC_K8S_20":{"description":"","id":"20","impact":"Containers will be able to communicate with host's shared channels. This breaks container security boundary.","issue":"Policy does not prevent containers from running processes inside of host's IPC namespace","policyEngineType":"opa","publicId":"SNYK-CC-K8S-20","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.3 Minimize the admission of containers wishing to share the host IPC namespace","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces"],"resolve":"Remove the `hostIPC` attribute, or set value to `false`","severity":"medium","subType":"Pod Security Policy","title":"Policy allows sharing of host's IPC namespace","type":"k8s"},"SNYK_CC_K8S_21":{"description":"","id":"21","impact":"Containers will be able to access host's networking resources. This breaks container security boundary.","issue":"Policy does not prevent containers from running processes inside of host's Network namespace","policyEngineType":"opa","publicId":"SNYK-CC-K8S-21","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.4 Minimize the admission of containers wishing to share the host network namespace","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces"],"resolve":"Remove `hostNetwork` attribute, or set value to `false`","severity":"medium","subType":"Pod Security Policy","title":"Policy allows sharing of host's Network namespace","type":"k8s"},"SNYK_CC_K8S_22":{"description":"","id":"22","impact":"Pods will be able to run with root UID.","issue":"Policy explicitly allows `RunAsAny` user which allows container to run in root UID context","policyEngineType":"opa","publicId":"SNYK-CC-K8S-22","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.6 Minimize the admission of root containers","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#users-and-groups"],"resolve":"Set `runAsUser` to `MustRunAsNonRoot`, or exclude UID `0` from `MustRunAs` range","severity":"medium","subType":"Pod Security Policy","title":"Policy does not prevent use of root user","type":"k8s"},"SNYK_CC_K8S_23":{"description":"","id":"23","impact":"The pods will be allowed to add any capability at runtime, including SYS_ADMIN","issue":"The whitelist of allowed capability is set to all","policyEngineType":"opa","publicId":"SNYK-CC-K8S-23","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.8 Minimize the admission of containers with added capabilities","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#capabilities","https://kubernetes.io/docs/concepts/security/pod-security-standards/"],"resolve":"Remove `allowedCapabilities` attribute, or set value to `[]`","severity":"medium","subType":"Pod Security Policy","title":"Policy allows all capabilities","type":"k8s"},"SNYK_CC_K8S_24":{"description":"","id":"24","impact":"Pods will be allowed to run with too many permissions, including RAW network resource access","issue":"Default insecure capabilities are not restricted","policyEngineType":"opa","publicId":"SNYK-CC-K8S-24","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.7 Minimize the admission of containers with the NET_RAW capability","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#capabilities"],"resolve":"Add `ALL` or `NET_RAW` to  `requiredDropCapabilities` attribute","severity":"medium","subType":"Pod Security Policy","title":"Policy does not restrict default capabilities","type":"k8s"},"SNYK_CC_K8S_25":{"description":"","id":"25","impact":"This can expose the sensitive endpoints to the wider range of threat actors.","issue":"All ingress sources are allowed access","policyEngineType":"opa","publicId":"SNYK-CC-K8S-25","references":["https://kubernetes.io/docs/concepts/services-networking/network-policies/","https://kubernetes.io/docs/tasks/administer-cluster/declare-network-policy/"],"resolve":"Add specific `from` attributes","severity":"medium","subType":"Network Policy","title":"Policy does not restrict ingress sources","type":"k8s"},"SNYK_CC_K8S_26":{"description":"","id":"26","impact":"This can allow the compromised container to exfiltrate information","issue":"Traffic to all destinations is allowed","policyEngineType":"opa","publicId":"SNYK-CC-K8S-26","references":["https://kubernetes.io/docs/concepts/services-networking/network-policies/","https://kubernetes.io/docs/tasks/administer-cluster/declare-network-policy/"],"resolve":"Add specific `to` attributes","severity":"medium","subType":"Network Policy","title":"Policy does not restrict egress destinations","type":"k8s"},"SNYK_CC_K8S_27":{"description":"","id":"27","impact":"Pods will be able to run with root GID","issue":"Policy explicitly allows `RunAsAny` group which allows container to run in root GID context","policyEngineType":"opa","publicId":"SNYK-CC-K8S-27","references":["CIS Kubernetes Benchmark 1.6.0 - 5.2.6 Minimize the admission of root containers","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#users-and-groups"],"resolve":"Set `runAsGroup` to `MustRunAs` to range which does not include GID `0`","severity":"medium","subType":"Pod Security Policy","title":"Policy does not prevent use of root group","type":"k8s"},"SNYK_CC_K8S_28":{"description":"","id":"28","impact":"Pods will be able to start with seccomp disabled.","issue":"Seccomp profile whitelist contains insecure entries","policyEngineType":"opa","publicId":"SNYK-CC-K8S-28","references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#seccomp","https://kubernetes.io/docs/tutorials/clusters/seccomp/","https://docs.docker.com/engine/security/seccomp/"],"resolve":"Set `seccomp.security.alpha.kubernetes.io/allowedProfileNames` to `runtime/default` only","severity":"medium","subType":"Pod Security Policy","title":"Policy allows insecure seccomp profiles","type":"k8s"},"SNYK_CC_K8S_29":{"description":"","id":"29","impact":"Containers will run with seccomp disabled","issue":"Default seccomp profile is set to `unconfined`","policyEngineType":"opa","publicId":"SNYK-CC-K8S-29","references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#seccomp","https://kubernetes.io/docs/tutorials/clusters/seccomp/","https://docs.docker.com/engine/security/seccomp/"],"resolve":"Set `seccomp.security.alpha.kubernetes.io/defaultProfileName` annotation to `runtime/default`","severity":"medium","subType":"Pod Security Policy","title":"Policy sets insecure default seccomp profile","type":"k8s"},"SNYK_CC_K8S_3":{"description":"","id":"3","impact":"Containers will be able to enumerate and interact with host's processes. This breaks container security boundary","issue":"The pod is sharing host's PID namespace","policyEngineType":"opa","publicId":"SNYK-CC-K8S-3","references":["CIS Docker Benchmark 1.2.0 - 5.15 Ensure that the host's process namespace is not shared","https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/"],"resolve":"Remove `hostPID` attribute, or set value to `false`","severity":"medium","subType":"Deployment","title":"Container is running in host's PID namespace","type":"k8s"},"SNYK_CC_K8S_30":{"description":"","id":"30","impact":"The containers will be allowed to mount any type, and source of volumes. This can lead to information disclosure and privilege escalation.","issue":"All volume types are allowed, including `hostPath`","policyEngineType":"opa","publicId":"SNYK-CC-K8S-30","references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#volumes-and-file-systems","https://kubernetes.io/docs/concepts/security/pod-security-standards/","https://kubernetes.io/docs/concepts/storage/volumes/"],"resolve":"Set value to specific volume types, or remove the attribute","severity":"medium","subType":"Pod Security Policy","title":"Policy allows all volume types","type":"k8s"},"SNYK_CC_K8S_31":{"description":"","id":"31","impact":"Pods will run with AppArmor disabled by default","issue":"Default profile name is set to `unconfined`","policyEngineType":"opa","publicId":"SNYK-CC-K8S-31","references":["https://kubernetes.io/docs/tutorials/clusters/apparmor/","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#apparmor"],"resolve":"Set `apparmor.security.beta.kubernetes.io/defaultProfileNam` annotation to `runtime/default`","severity":"medium","subType":"Pod Security Policy","title":"Policy allows any apparmor profile","type":"k8s"},"SNYK_CC_K8S_32":{"description":"","id":"32","impact":"AppArmor will not enforce mandatory access control, which can increase the attack vectors.","issue":"The AppArmor profile is not set correctly","policyEngineType":"opa","publicId":"SNYK-CC-K8S-32","references":["CIS Docker Benchmark 1.2.0 - 5.1 Ensure that, if applicable, an AppArmor Profile is enabled","https://kubernetes.io/docs/tutorials/clusters/apparmor/","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#apparmor"],"resolve":"Add `container.apparmor.security.beta.kubernetes.io/\u003ccontainer-name\u003e` annotation with value `runtime/default` or `localhost/\u003cname-of-profile`","severity":"low","subType":"Deployment","title":"Container is running without AppArmor profile","type":"k8s"},"SNYK_CC_K8S_33":{"description":"","id":"33","impact":"SELinux mandatory access controls may be bypassed, due to clashes in labeling.","issue":"Custom SELinux label is defined","policyEngineType":"opa","publicId":"SNYK-CC-K8S-33","references":["CIS Docker Benchmark 1.2.0 - 5.2 Ensure that, if applicable, SELinux security options are set","https://kubernetes.io/docs/concepts/security/pod-security-standards/","https://aws.github.io/aws-eks-best-practices/hosts/#run-selinux"],"resolve":"Remove `securityContext.seLinuxOptions`","severity":"low","subType":"Deployment","title":"Container is running with custom SELinux options","type":"k8s"},"SNYK_CC_K8S_34":{"description":"","id":"34","impact":"Increases the security management overhead","issue":"SSH port is declared in `ports` attribute","policyEngineType":"opa","publicId":"SNYK-CC-K8S-34","references":["CIS Docker Benchmark 1.2.0 - 5.6 Ensure sshd is not run within containers","https://kubernetes.io/docs/tasks/debug-application-cluster/get-shell-running-container/"],"resolve":"Remove ssh from `ports` array","severity":"low","subType":"Deployment","title":"Container is exposing SSH port","type":"k8s"},"SNYK_CC_K8S_36":{"description":"","id":"36","impact":"Increases the attack surface of the application and the container.","issue":"Container is declaring more than 2 listening ports","policyEngineType":"opa","publicId":"SNYK-CC-K8S-36","references":["CIS Docker Benchmark 1.2.0 - 5.8 Ensure that only needed ports are open on the container"],"resolve":"Reduce `ports` count to 2","severity":"low","subType":"Deployment","title":"Container is running with multiple open ports","type":"k8s"},"SNYK_CC_K8S_37":{"description":"","id":"37","impact":"Increases the attack surface, and can lead to privilege escalation","issue":"Host's `/dev` path has been mounted inside the pod","policyEngineType":"opa","publicId":"SNYK-CC-K8S-37","references":["CIS Docker Benchmark 1.2.0 - 5.17 Ensure that host devices are not directly exposed to containers","https://kubernetes.io/docs/concepts/storage/volumes/#hostpath"],"resolve":"Remove `hostPath` volume mount","severity":"medium","subType":"Deployment","title":"Container is running with host device path mount","type":"k8s"},"SNYK_CC_K8S_38":{"description":"","id":"38","impact":"Shared volumes can overwrite data on the host, and are considered dangerous.","issue":"Bidirectional volume mount propagation has been set","policyEngineType":"opa","publicId":"SNYK-CC-K8S-38","references":["CIS Docker Benchmark 1.2.0 - 5.19 Ensure mount propagation mode is not set to shared","https://kubernetes.io/docs/concepts/storage/volumes/#mount-propagation"],"resolve":"Remove `mountPropagation` attribute, or set value to `None`","severity":"low","subType":"Deployment","title":"Container is running with shared mount propagation","type":"k8s"},"SNYK_CC_K8S_4":{"description":"","id":"4","impact":"Containers without memory limits are more likely to be terminated when the node runs out of memory","issue":"Memory limit is not defined","policyEngineType":"opa","publicId":"SNYK-CC-K8S-4","references":["CIS Docker Benchmark 1.2.0 - 5.10 Ensure that the memory usage for containers is limited","https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/","https://kubernetes.io/docs/tasks/administer-cluster/manage-resources/memory-default-namespace/"],"resolve":"Set `resources.limits.memory` value","severity":"low","subType":"Deployment","title":"Container is running without memory limit","type":"k8s"},"SNYK_CC_K8S_41":{"description":"","id":"41","impact":"Kubernetes will not be able to detect if application is able to service requests, and will not restart unhealthy pods","issue":"Liveness probe is not defined","policyEngineType":"opa","publicId":"SNYK-CC-K8S-41","references":["CIS Docker Benchmark v1.2.0 - 5.26 Ensure that container health is checked at runtime","https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/","https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/","https://cloud.google.com/blog/products/gcp/kubernetes-best-practices-setting-up-health-checks-with-readiness-and-liveness-probes"],"resolve":"Add `livenessProbe` attribute","severity":"low","subType":"Deployment","title":"Container is running without liveness probe","type":"k8s"},"SNYK_CC_K8S_42":{"description":"","id":"42","impact":"The container may run with outdated or unauthorized image","issue":"The image policy does not prevent image reuse","policyEngineType":"opa","publicId":"SNYK-CC-K8S-42","references":["5.27 Ensure that Docker commands always make use of the latest version of their image","https://kubernetes.io/docs/concepts/containers/images/","https://kubernetes.io/docs/concepts/configuration/overview/#container-images"],"resolve":"Set `imagePullPolicy` attribute to `Always`","severity":"low","subType":"Deployment","title":"Container could be running with outdated image","type":"k8s"},"SNYK_CC_K8S_43":{"description":"","id":"43","impact":"External IPs can be abused to perform man in the middle attacks on the service","issue":"The service has specified the use of an external IP address. CVE-2020-8554","policyEngineType":"opa","publicId":"SNYK-CC-K8S-43","references":["https://github.com/kubernetes/kubernetes/issues/97076"],"resolve":"Remove `spec.externalIPs` or `spec.loadBalancerIP` attributes","severity":"high","subType":"Service","title":"Service is using an external IP","type":"k8s"},"SNYK_CC_K8S_44":{"description":"","id":"44","impact":"The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.","issue":"The role uses wildcards, which grant the role permissions to the whole cluster","policyEngineType":"opa","publicId":"SNYK-CC-K8S-44","references":["CWE-272","https://kubernetes.io/docs/reference/access-authn-authz/rbac/","CIS Kubernetes Benchmark 1.7.0 - 5.1.3 Minimize wildcard use in Roles and ClusterRoles"],"resolve":"Set only the necessary permissions required","severity":"medium","subType":"Role","title":"Role with too wide permissions","type":"k8s"},"SNYK_CC_K8S_45":{"description":"","id":"45","impact":"The use of default service account is discouraged","issue":"A binding was found between a role and the default service account","policyEngineType":"opa","publicId":"SNYK-CC-K8S-45","references":["CWE-272","https://kubernetes.io/docs/reference/access-authn-authz/rbac/","CIS Kubernetes Benchmark 1.7.0 - 5.1.5 Ensure that default service accounts are not actively used."],"resolve":"Create specific service account instead of using the default one","severity":"medium","subType":"RoleBinding","title":"RoleBinding to the default service account","type":"k8s"},"SNYK_CC_K8S_46":{"description":"","id":"46","impact":"Using default role give over permissive permissions","issue":"A binding was found using one of the default roles","policyEngineType":"opa","publicId":"SNYK-CC-K8S-46","references":["CWE-272","https://kubernetes.io/docs/reference/access-authn-authz/rbac/","CIS Kubernetes Benchmark 1.7.0 - 5.1.1 Ensure that the cluster-admin role is only used where required."],"resolve":"Create specific role with only the required permissions","severity":"medium","subType":"RoleBinding","title":"Binding using a pre-defined role","type":"k8s"},"SNYK_CC_K8S_47":{"description":"","id":"47","impact":"Using this role grants dangerous permissions","issue":"A role was found using a dangerous permissions","policyEngineType":"opa","publicId":"SNYK-CC-K8S-47","references":["https://kubernetes.io/docs/reference/access-authn-authz/rbac/","CIS Kubernetes Benchmark 1.7.0 - 5.1.2 Minimize access to secrets.","CIS Kubernetes Benchmark 1.7.0 - 5.1.4 Minimize access to create pods."],"resolve":"Consider removing this permissions","severity":"medium","subType":"RoleBinding","title":"Role with dangerous permissions","type":"k8s"},"SNYK_CC_K8S_48":{"description":"","id":"48","impact":"Those namespaces should be used only by cluster operators, and should be treated as sensitive","issue":"A role was found that grant permission over system reserved namespace (either default or kube-system)","policyEngineType":"opa","publicId":"SNYK-CC-K8S-48","references":["https://kubernetes.io/docs/reference/access-authn-authz/rbac/","https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/","CIS Kubernetes Benchmark 1.7.0 - 5.7.4 The default namespace should not be used."],"resolve":"Consider creating different namespace and use it instead","severity":"medium","subType":"RoleBinding","title":"Role that grant permissions to system reserved namespace","type":"k8s"},"SNYK_CC_K8S_5":{"description":"","id":"5","impact":"Containers without limits can exceed the capacity of the node, and affect availability/performance of the host and other containers.","issue":"CPU limit is not defined","policyEngineType":"opa","publicId":"SNYK-CC-K8S-5","references":["CIS Docker Benchmark 1.2.0 - 5.11 Ensure that CPU priority is set appropriately on containers","https://kubernetes.io/docs/tasks/configure-pod-container/assign-cpu-resource/","https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/","https://kubernetes.io/docs/tasks/administer-cluster/manage-resources/cpu-default-namespace/"],"resolve":"Add `resources.limits.cpu` field with required CPU limit value","severity":"low","subType":"Deployment","title":"Container is running without cpu limit","type":"k8s"},"SNYK_CC_K8S_6":{"description":"","id":"6","impact":"Containers are running with potentially unnecessary privileges","issue":"Default capabilities are not explicitly dropped","policyEngineType":"opa","publicId":"SNYK-CC-K8S-6","references":["https://kubernetes.io/docs/tasks/configure-pod-container/security-context/","https://linux-audit.com/linux-capabilities-hardening-linux-binaries-by-removing-setuid/"],"resolve":"Add `ALL` to `securityContext.capabilities.drop` list","severity":"medium","subType":"Deployment","title":"Container is running with default set of capabilities","type":"k8s"},"SNYK_CC_K8S_7":{"description":"","id":"7","impact":"SYS_ADMIN capability grants the container almost full administrative privileges","issue":"SYS_ADMIN privileges are assigned to the container","policyEngineType":"opa","publicId":"SNYK-CC-K8S-7","references":["https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-capabilities-for-a-container","https://man7.org/linux/man-pages/man7/capabilities.7.html","https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities"],"resolve":"Remove `CAP_SYS_ADMIN` from `securityContext.capabilities.add` list","severity":"high","subType":"Deployment","title":"Container is running with SYS_ADMIN capability","type":"k8s"},"SNYK_CC_K8S_8":{"description":"","id":"8","impact":"Compromised process could abuse writable root filesystem to elevate privileges","issue":"`readOnlyRootFilesystem` attribute is not set to `true`","policyEngineType":"opa","publicId":"SNYK-CC-K8S-8","references":["CIS Docker Benchmark 1.2.0 - Ensure that the container's root filesystem is mounted as read only","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#volumes-and-file-systems","https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/"],"resolve":"Set `securityContext.readOnlyRootFilesystem` to `true`","severity":"low","subType":"Deployment","title":"Container is running with writable root filesystem","type":"k8s"},"SNYK_CC_K8S_9":{"description":"","id":"9","impact":"Processes could elevate current privileges via known vectors, for example SUID binaries","issue":"`allowPrivilegeEscalation` attribute is not set to `false`","policyEngineType":"opa","publicId":"SNYK-CC-K8S-9","references":["CIS Docker Benchmark 1.2.0 - 5.25 Ensure that the container is restricted from acquiring additional privileges","https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation","https://www.kernel.org/doc/html/latest/userspace-api/no_new_privs.html"],"resolve":"Set `securityContext.allowPrivilegeEscalation` to `false`","severity":"medium","subType":"Deployment","title":"Container is running without privilege escalation control","type":"k8s"}}},"ignores":["docker-compose.*","*_test.yaml","cspell.json","*_test.rego",".*","node_modules","scripts","public-docs"],"prepared_queries":{"all_metadata":"all_meta_res := data.lib.all_policies_metadata","kubernetes":"k8s_res := data.schemas.kubernetes.deny","kubernetes_metadata":"k8s_meta_res := data.lib.policies_metadata(\"kubernetes\")","terraform":"tf_res := data.schemas.terraform.deny","terraform_metadata":"tf_meta_res := data.lib.terraform_policies_metadata"},"schemas":{"kubernetes":{"SNYK_CC_K8S_44":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","metadata":{"name":"pod-reader","namespace":"default"},"rules":[{"apiGroups":[""],"resources":["*"],"verbs":["get","watch","list"]},{"apiGroups":[""],"resources":["pods"],"verbs":["*"]}]},"SNYK_CC_K8S_45":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"name":"read-pods","namespace":"ns"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"pod-reader"},"subjects":[{"kind":"ServiceAccount","name":"default","namespace":"ns"}]},"SNYK_CC_K8S_46":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"name":"read-pods","namespace":"ns"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"admin"},"subjects":[{"kind":"ServiceAccount","name":"some-sa","namespace":"ns"}]},"SNYK_CC_K8S_47":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","metadata":{"name":"pod-reader","namespace":"ns"},"rules":[{"apiGroups":[""],"resources":["secrets"],"verbs":["get","watch","list"]}]},"SNYK_CC_K8S_48":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"name":"pod-reader","namespace":"kube-system"},"rules":[{"apiGroups":[""],"resources":["services"],"verbs":["get","watch","list"]}]}}},"wasm_abi_versions":[{"minor_version":1,"version":1}]}

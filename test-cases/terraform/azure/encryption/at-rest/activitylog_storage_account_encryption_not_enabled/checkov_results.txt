terraform scan results:

Passed checks: 7, Failed checks: 7, Skipped checks: 0

Check: CKV_AZURE_3: "Ensure that 'Secure transfer required' is set to 'Enabled'"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:18-27
	Guide: https://docs.bridgecrew.io/docs/ensure-secure-transfer-required-is-enabled

		18 | resource "azurerm_storage_account" "storacc" {
		19 |   name                     = "${local.resource_prefix}tststacc"
		20 |   resource_group_name      = azurerm_resource_group.rg.name
		21 |   location                 = azurerm_resource_group.rg.location
		22 |   account_tier             = "Standard"
		23 |   account_replication_type = "LRS"
		24 |   identity {
		25 |     type = "SystemAssigned"
		26 |   }
		27 | }


Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:18-27
	Guide: https://docs.bridgecrew.io/docs/set-default-network-access-rule-for-storage-accounts-to-deny

		18 | resource "azurerm_storage_account" "storacc" {
		19 |   name                     = "${local.resource_prefix}tststacc"
		20 |   resource_group_name      = azurerm_resource_group.rg.name
		21 |   location                 = azurerm_resource_group.rg.location
		22 |   account_tier             = "Standard"
		23 |   account_replication_type = "LRS"
		24 |   identity {
		25 |     type = "SystemAssigned"
		26 |   }
		27 | }


Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:18-27
	Guide: https://docs.bridgecrew.io/docs/bc_azr_storage_2

		18 | resource "azurerm_storage_account" "storacc" {
		19 |   name                     = "${local.resource_prefix}tststacc"
		20 |   resource_group_name      = azurerm_resource_group.rg.name
		21 |   location                 = azurerm_resource_group.rg.location
		22 |   account_tier             = "Standard"
		23 |   account_replication_type = "LRS"
		24 |   identity {
		25 |     type = "SystemAssigned"
		26 |   }
		27 | }


Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:18-27
	Guide: https://docs.bridgecrew.io/docs/enable-requests-on-storage-logging-for-queue-service

		18 | resource "azurerm_storage_account" "storacc" {
		19 |   name                     = "${local.resource_prefix}tststacc"
		20 |   resource_group_name      = azurerm_resource_group.rg.name
		21 |   location                 = azurerm_resource_group.rg.location
		22 |   account_tier             = "Standard"
		23 |   account_replication_type = "LRS"
		24 |   identity {
		25 |     type = "SystemAssigned"
		26 |   }
		27 | }


Check: CKV_AZURE_109: "Ensure that key vault allows firewall rules settings"
	FAILED for resource: azurerm_key_vault.kv
	File: /main.tf:29-52
	Guide: https://docs.bridgecrew.io/docs/ensure-that-key-vault-allows-firewall-rules-settings

		29 | resource "azurerm_key_vault" "kv" {
		30 |   name                        = "${local.resource_prefix}-keyvault"
		31 |   location                    = azurerm_resource_group.rg.location
		32 |   resource_group_name         = azurerm_resource_group.rg.name
		33 |   #enabled_for_disk_encryption = true
		34 |   tenant_id                   = data.azurerm_client_config.current.tenant_id
		35 |   soft_delete_retention_days  = 7
		36 |   purge_protection_enabled    = true
		37 |   sku_name = "standard"
		38 | 
		39 |   access_policy {
		40 |     tenant_id = data.azurerm_client_config.current.tenant_id
		41 |     object_id = data.azurerm_client_config.current.object_id
		42 |     key_permissions = [
		43 |       "Get", "List", "create", "delete", "recover",
		44 |     ]
		45 |     secret_permissions = [
		46 |       "Get", "List", "set",
		47 |     ]
		48 |     storage_permissions = [
		49 |       "Get",
		50 |     ]
		51 |   }
		52 | }


Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:18-27
	Guide: https://docs.bridgecrew.io/docs/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key

		18 | resource "azurerm_storage_account" "storacc" {
		19 |   name                     = "${local.resource_prefix}tststacc"
		20 |   resource_group_name      = azurerm_resource_group.rg.name
		21 |   location                 = azurerm_resource_group.rg.location
		22 |   account_tier             = "Standard"
		23 |   account_replication_type = "LRS"
		24 |   identity {
		25 |     type = "SystemAssigned"
		26 |   }
		27 | }


Check: CKV2_AZURE_18: "Ensure that Storage Accounts use customer-managed key for encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:18-27
	Guide: https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-use-customer-managed-key-for-encryption

		18 | resource "azurerm_storage_account" "storacc" {
		19 |   name                     = "${local.resource_prefix}tststacc"
		20 |   resource_group_name      = azurerm_resource_group.rg.name
		21 |   location                 = azurerm_resource_group.rg.location
		22 |   account_tier             = "Standard"
		23 |   account_replication_type = "LRS"
		24 |   identity {
		25 |     type = "SystemAssigned"
		26 |   }
		27 | }



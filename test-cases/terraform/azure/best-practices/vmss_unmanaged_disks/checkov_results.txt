terraform scan results:

Passed checks: 7, Failed checks: 10, Skipped checks: 0

Check: CKV_AZURE_3: "Ensure that 'Secure transfer required' is set to 'Enabled'"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/ensure-secure-transfer-required-is-enabled

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/set-default-network-access-rule-for-storage-accounts-to-deny

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/bc_azr_storage_2

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/enable-requests-on-storage-logging-for-queue-service

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_95: "Ensure that automatic OS image patching is enabled for Virtual Machine Scale Sets"
	FAILED for resource: azurerm_virtual_machine_scale_set.vmss1
	File: /main.tf:55-100
	Guide: https://docs.bridgecrew.io/docs/ensure-that-automatic-os-image-patching-is-enabled-for-virtual-machine-scale-sets

		55  | resource "azurerm_virtual_machine_scale_set" "vmss1" {
		56  |   name                = "${local.resource_prefix}-vmss1"
		57  |   location            = azurerm_resource_group.rg.location
		58  |   resource_group_name = azurerm_resource_group.rg.name
		59  |   upgrade_policy_mode = "Manual"
		60  | 
		61  |   sku {
		62  |     name     = "Standard_B2s"
		63  |     capacity = 1
		64  |   }
		65  | 
		66  |   storage_profile_image_reference {
		67  |     publisher = "Canonical"
		68  |     offer     = "UbuntuServer"
		69  |     sku       = "16.04-LTS"
		70  |     version   = "latest"
		71  |   }
		72  | 
		73  |   storage_profile_os_disk {
		74  |     name              = "myosdisk1"
		75  |     vhd_containers    = ["${azurerm_storage_account.storacc.primary_blob_endpoint}${azurerm_storage_container.container.name}/myosdisk1.vhd"]
		76  |     caching           = "ReadWrite"
		77  |     create_option     = "FromImage"    
		78  |   }
		79  | 
		80  |   os_profile {
		81  |     computer_name_prefix = "testvm"
		82  |     admin_username = "testadmin"
		83  |     admin_password = "Pas1sword1234!"
		84  |   }
		85  | 
		86  |   os_profile_linux_config {
		87  |     disable_password_authentication = false
		88  |   }
		89  | 
		90  |   network_profile {
		91  |     name    = "networkprofile"
		92  |     primary = true
		93  | 
		94  |     ip_configuration {
		95  |       name        = "TestIPConfiguration"
		96  |       primary     = true
		97  |       subnet_id    = azurerm_subnet.snet.id
		98  |     }
		99  |   }
		100 | }


Check: CKV_AZURE_95: "Ensure that automatic OS image patching is enabled for Virtual Machine Scale Sets"
	FAILED for resource: azurerm_virtual_machine_scale_set.vmss2
	File: /main.tf:102-141
	Guide: https://docs.bridgecrew.io/docs/ensure-that-automatic-os-image-patching-is-enabled-for-virtual-machine-scale-sets

		102 | resource "azurerm_virtual_machine_scale_set" "vmss2" {
		103 |   name                = "${local.resource_prefix}-vmss2"
		104 |   location            = azurerm_resource_group.rg.location
		105 |   resource_group_name = azurerm_resource_group.rg.name
		106 |   upgrade_policy_mode = "Manual"
		107 | 
		108 |   sku {
		109 |     name     = "Standard_B2s"
		110 |     capacity = 1
		111 |   }
		112 | 
		113 |   storage_profile_os_disk {
		114 |     name              = "myosdisk1"
		115 |     image             = "https://donotdeletestoracc.blob.core.windows.net/vhds/myosdisk1.vhd"
		116 |     caching           = "ReadWrite"
		117 |     create_option     = "FromImage"
		118 |     os_type           = "linux"    
		119 |   }
		120 | 
		121 |   os_profile {
		122 |     computer_name_prefix = "testvm"
		123 |     admin_username = "testadmin"
		124 |     admin_password = "Pas1sword1234!"
		125 |   }
		126 | 
		127 |   os_profile_linux_config {
		128 |     disable_password_authentication = false
		129 |   }
		130 | 
		131 |   network_profile {
		132 |     name    = "networkprofile"
		133 |     primary = true
		134 | 
		135 |     ip_configuration {
		136 |       name         = "TestIPConfiguration"
		137 |       primary     = true
		138 |       subnet_id   = azurerm_subnet.snet.id
		139 |     }
		140 |   }
		141 | }


Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV2_AZURE_18: "Ensure that Storage Accounts use customer-managed key for encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-use-customer-managed-key-for-encryption

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV2_AZURE_21: "Ensure Storage logging is enabled for Blob service for read requests"
	FAILED for resource: azurerm_storage_container.container
	File: /main.tf:49-53
	Guide: https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-blob-service-for-read-requests

		49 | resource "azurerm_storage_container" "container" {
		50 |   name                  = "vhds"
		51 |   storage_account_name  = azurerm_storage_account.storacc.name
		52 |   container_access_type = "private"
		53 | }


Check: CKV2_AZURE_8: "Ensure the storage container storing the activity logs is not publicly accessible"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/ensure-the-storage-container-storing-the-activity-logs-is-not-publicly-accessible

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }



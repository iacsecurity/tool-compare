terraform scan results:

Passed checks: 9, Failed checks: 12, Skipped checks: 0

Check: CKV_AZURE_3: "Ensure that 'Secure transfer required' is set to 'Enabled'"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:42-48
	Guide: https://docs.bridgecrew.io/docs/ensure-secure-transfer-required-is-enabled

		42 | resource "azurerm_storage_account" "storacc" {
		43 |   name                     = "${local.resource_prefix}tstsa"
		44 |   resource_group_name      = azurerm_resource_group.rg.name
		45 |   location                 = azurerm_resource_group.rg.location
		46 |   account_tier             = "Standard"
		47 |   account_replication_type = "LRS"
		48 | }


Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:42-48
	Guide: https://docs.bridgecrew.io/docs/set-default-network-access-rule-for-storage-accounts-to-deny

		42 | resource "azurerm_storage_account" "storacc" {
		43 |   name                     = "${local.resource_prefix}tstsa"
		44 |   resource_group_name      = azurerm_resource_group.rg.name
		45 |   location                 = azurerm_resource_group.rg.location
		46 |   account_tier             = "Standard"
		47 |   account_replication_type = "LRS"
		48 | }


Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:42-48
	Guide: https://docs.bridgecrew.io/docs/bc_azr_storage_2

		42 | resource "azurerm_storage_account" "storacc" {
		43 |   name                     = "${local.resource_prefix}tstsa"
		44 |   resource_group_name      = azurerm_resource_group.rg.name
		45 |   location                 = azurerm_resource_group.rg.location
		46 |   account_tier             = "Standard"
		47 |   account_replication_type = "LRS"
		48 | }


Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:42-48
	Guide: https://docs.bridgecrew.io/docs/enable-requests-on-storage-logging-for-queue-service

		42 | resource "azurerm_storage_account" "storacc" {
		43 |   name                     = "${local.resource_prefix}tstsa"
		44 |   resource_group_name      = azurerm_resource_group.rg.name
		45 |   location                 = azurerm_resource_group.rg.location
		46 |   account_tier             = "Standard"
		47 |   account_replication_type = "LRS"
		48 | }


Check: CKV_AZURE_1: "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)"
	FAILED for resource: azurerm_virtual_machine.main
	File: /main.tf:56-86
	Guide: https://docs.bridgecrew.io/docs/bc_azr_networking_1

		56 | resource "azurerm_virtual_machine" "main" {
		57 |   name                  = "${local.resource_prefix}-vm"
		58 |   location              = azurerm_resource_group.rg.location
		59 |   resource_group_name   = azurerm_resource_group.rg.name
		60 |   network_interface_ids = [azurerm_network_interface.nic.id]
		61 |   vm_size               = "Standard_B2s"
		62 | 
		63 |   delete_os_disk_on_termination = true
		64 |   delete_data_disks_on_termination = true
		65 | 
		66 |   storage_image_reference {
		67 |     publisher = "Canonical"
		68 |     offer     = "UbuntuServer"
		69 |     sku       = "16.04-LTS"
		70 |     version   = "latest"
		71 |   }
		72 |   storage_os_disk {
		73 |     name              = "myosdisk1"
		74 |     vhd_uri           = "${azurerm_storage_account.storacc.primary_blob_endpoint}${azurerm_storage_container.container.name}/myosdisk1.vhd"
		75 |     caching           = "ReadWrite"
		76 |     create_option     = "FromImage"
		77 |   }
		78 |   os_profile {
		79 |     computer_name  = "hostname"
		80 |     admin_username = "testadmin"
		81 |     admin_password = "Password1234!"
		82 |   }
		83 |   os_profile_linux_config {
		84 |     disable_password_authentication = false
		85 |   }
		86 | }


Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:42-48
	Guide: https://docs.bridgecrew.io/docs/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key

		42 | resource "azurerm_storage_account" "storacc" {
		43 |   name                     = "${local.resource_prefix}tstsa"
		44 |   resource_group_name      = azurerm_resource_group.rg.name
		45 |   location                 = azurerm_resource_group.rg.location
		46 |   account_tier             = "Standard"
		47 |   account_replication_type = "LRS"
		48 | }


Check: CKV2_AZURE_9: "Ensure Virtual Machines are utilizing Managed Disks"
	FAILED for resource: azurerm_virtual_machine.main
	File: /main.tf:56-86
	Guide: https://docs.bridgecrew.io/docs/ensure-virtual-machines-are-utilizing-managed-disks

		56 | resource "azurerm_virtual_machine" "main" {
		57 |   name                  = "${local.resource_prefix}-vm"
		58 |   location              = azurerm_resource_group.rg.location
		59 |   resource_group_name   = azurerm_resource_group.rg.name
		60 |   network_interface_ids = [azurerm_network_interface.nic.id]
		61 |   vm_size               = "Standard_B2s"
		62 | 
		63 |   delete_os_disk_on_termination = true
		64 |   delete_data_disks_on_termination = true
		65 | 
		66 |   storage_image_reference {
		67 |     publisher = "Canonical"
		68 |     offer     = "UbuntuServer"
		69 |     sku       = "16.04-LTS"
		70 |     version   = "latest"
		71 |   }
		72 |   storage_os_disk {
		73 |     name              = "myosdisk1"
		74 |     vhd_uri           = "${azurerm_storage_account.storacc.primary_blob_endpoint}${azurerm_storage_container.container.name}/myosdisk1.vhd"
		75 |     caching           = "ReadWrite"
		76 |     create_option     = "FromImage"
		77 |   }
		78 |   os_profile {
		79 |     computer_name  = "hostname"
		80 |     admin_username = "testadmin"
		81 |     admin_password = "Password1234!"
		82 |   }
		83 |   os_profile_linux_config {
		84 |     disable_password_authentication = false
		85 |   }
		86 | }


Check: CKV2_AZURE_12: "Ensure that virtual machines are backed up using Azure Backup"
	FAILED for resource: azurerm_virtual_machine.main
	File: /main.tf:56-86
	Guide: https://docs.bridgecrew.io/docs/ensure-that-virtual-machines-are-backed-up-using-azure-backup

		56 | resource "azurerm_virtual_machine" "main" {
		57 |   name                  = "${local.resource_prefix}-vm"
		58 |   location              = azurerm_resource_group.rg.location
		59 |   resource_group_name   = azurerm_resource_group.rg.name
		60 |   network_interface_ids = [azurerm_network_interface.nic.id]
		61 |   vm_size               = "Standard_B2s"
		62 | 
		63 |   delete_os_disk_on_termination = true
		64 |   delete_data_disks_on_termination = true
		65 | 
		66 |   storage_image_reference {
		67 |     publisher = "Canonical"
		68 |     offer     = "UbuntuServer"
		69 |     sku       = "16.04-LTS"
		70 |     version   = "latest"
		71 |   }
		72 |   storage_os_disk {
		73 |     name              = "myosdisk1"
		74 |     vhd_uri           = "${azurerm_storage_account.storacc.primary_blob_endpoint}${azurerm_storage_container.container.name}/myosdisk1.vhd"
		75 |     caching           = "ReadWrite"
		76 |     create_option     = "FromImage"
		77 |   }
		78 |   os_profile {
		79 |     computer_name  = "hostname"
		80 |     admin_username = "testadmin"
		81 |     admin_password = "Password1234!"
		82 |   }
		83 |   os_profile_linux_config {
		84 |     disable_password_authentication = false
		85 |   }
		86 | }


Check: CKV2_AZURE_18: "Ensure that Storage Accounts use customer-managed key for encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:42-48
	Guide: https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-use-customer-managed-key-for-encryption

		42 | resource "azurerm_storage_account" "storacc" {
		43 |   name                     = "${local.resource_prefix}tstsa"
		44 |   resource_group_name      = azurerm_resource_group.rg.name
		45 |   location                 = azurerm_resource_group.rg.location
		46 |   account_tier             = "Standard"
		47 |   account_replication_type = "LRS"
		48 | }


Check: CKV2_AZURE_8: "Ensure the storage container storing the activity logs is not publicly accessible"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:42-48
	Guide: https://docs.bridgecrew.io/docs/ensure-the-storage-container-storing-the-activity-logs-is-not-publicly-accessible

		42 | resource "azurerm_storage_account" "storacc" {
		43 |   name                     = "${local.resource_prefix}tstsa"
		44 |   resource_group_name      = azurerm_resource_group.rg.name
		45 |   location                 = azurerm_resource_group.rg.location
		46 |   account_tier             = "Standard"
		47 |   account_replication_type = "LRS"
		48 | }


Check: CKV2_AZURE_21: "Ensure Storage logging is enabled for Blob service for read requests"
	FAILED for resource: azurerm_storage_container.container
	File: /main.tf:50-54
	Guide: https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-blob-service-for-read-requests

		50 | resource "azurerm_storage_container" "container" {
		51 |   name                  = "vhds"
		52 |   storage_account_name  = azurerm_storage_account.storacc.name
		53 |   container_access_type = "private"
		54 | }


Check: CKV2_AZURE_10: "Ensure that Microsoft Antimalware is configured to automatically updates for Virtual Machines"
	FAILED for resource: azurerm_virtual_machine.main
	File: /main.tf:56-86
	Guide: https://docs.bridgecrew.io/docs/ensure-that-microsoft-antimalware-is-configured-to-automatically-updates-for-virtual-machines

		56 | resource "azurerm_virtual_machine" "main" {
		57 |   name                  = "${local.resource_prefix}-vm"
		58 |   location              = azurerm_resource_group.rg.location
		59 |   resource_group_name   = azurerm_resource_group.rg.name
		60 |   network_interface_ids = [azurerm_network_interface.nic.id]
		61 |   vm_size               = "Standard_B2s"
		62 | 
		63 |   delete_os_disk_on_termination = true
		64 |   delete_data_disks_on_termination = true
		65 | 
		66 |   storage_image_reference {
		67 |     publisher = "Canonical"
		68 |     offer     = "UbuntuServer"
		69 |     sku       = "16.04-LTS"
		70 |     version   = "latest"
		71 |   }
		72 |   storage_os_disk {
		73 |     name              = "myosdisk1"
		74 |     vhd_uri           = "${azurerm_storage_account.storacc.primary_blob_endpoint}${azurerm_storage_container.container.name}/myosdisk1.vhd"
		75 |     caching           = "ReadWrite"
		76 |     create_option     = "FromImage"
		77 |   }
		78 |   os_profile {
		79 |     computer_name  = "hostname"
		80 |     admin_username = "testadmin"
		81 |     admin_password = "Password1234!"
		82 |   }
		83 |   os_profile_linux_config {
		84 |     disable_password_authentication = false
		85 |   }
		86 | }



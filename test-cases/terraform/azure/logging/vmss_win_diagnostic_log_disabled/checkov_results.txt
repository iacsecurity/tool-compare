terraform scan results:

Passed checks: 6, Failed checks: 7, Skipped checks: 0

Check: CKV_AZURE_3: "Ensure that 'Secure transfer required' is set to 'Enabled'"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/ensure-secure-transfer-required-is-enabled

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/set-default-network-access-rule-for-storage-accounts-to-deny

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/bc_azr_storage_2

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/enable-requests-on-storage-logging-for-queue-service

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV_AZURE_97: "Ensure that Virtual machine scale sets have encryption at host enabled"
	FAILED for resource: azurerm_windows_virtual_machine_scale_set.vmss
	File: /main.tf:49-81
	Guide: https://docs.bridgecrew.io/docs/ensure-that-virtual-machine-scale-sets-have-encryption-at-host-enabled

		49 | resource "azurerm_windows_virtual_machine_scale_set" "vmss" {
		50 |   name                = "${local.resource_prefix}-vmss"
		51 |   location            = azurerm_resource_group.rg.location
		52 |   resource_group_name = azurerm_resource_group.rg.name
		53 |   sku                 = "Standard_B2s"
		54 |   instances           = 1
		55 |   admin_password      = "P@55w0rd1234!"
		56 |   admin_username      = "adminuser"
		57 |   computer_name_prefix = "winsrv"
		58 | 
		59 |   source_image_reference {
		60 |     publisher = "MicrosoftWindowsServer"
		61 |     offer     = "WindowsServer"
		62 |     sku       = "2016-Datacenter-Server-Core"
		63 |     version   = "latest"
		64 |   }
		65 | 
		66 |   os_disk {
		67 |     storage_account_type = "Standard_LRS"
		68 |     caching              = "ReadWrite"
		69 |   }
		70 | 
		71 |   network_interface {
		72 |     name    = "networkprofile"
		73 |     primary = true
		74 | 
		75 |     ip_configuration {
		76 |       name                                   = "TestIPConfiguration"
		77 |       primary                                = true
		78 |       subnet_id                              = azurerm_subnet.snet.id
		79 |     }
		80 |   }
		81 | }


Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }


Check: CKV2_AZURE_18: "Ensure that Storage Accounts use customer-managed key for encryption"
	FAILED for resource: azurerm_storage_account.storacc
	File: /main.tf:41-47
	Guide: https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-use-customer-managed-key-for-encryption

		41 | resource "azurerm_storage_account" "storacc" {
		42 |   name                     = "${local.resource_prefix}tstsa"
		43 |   resource_group_name      = azurerm_resource_group.rg.name
		44 |   location                 = azurerm_resource_group.rg.location
		45 |   account_tier             = "Standard"
		46 |   account_replication_type = "LRS"
		47 | }




Result #1 MEDIUM Access logging is not configured. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:44-48
────────────────────────────────────────────────────────────────────────────────
   44    resource "aws_api_gateway_stage" "api_gw_stage" {
   45      stage_name    = "prod"
   46      rest_api_id   = aws_api_gateway_rest_api.api_gw.id
   47      deployment_id = aws_api_gateway_deployment.api_gw_deploy.id
   48    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-api-gateway-enable-access-logging
      Impact Logging provides vital information about access and usage
  Resolution Enable logging for API Gateway stages

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/api-gateway/enable-access-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_stage#access_log_settings
────────────────────────────────────────────────────────────────────────────────


Result #2 MEDIUM Cache data is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:58
────────────────────────────────────────────────────────────────────────────────
   50    resource "aws_api_gateway_method_settings" "api_gw_method_sett" {
   51      rest_api_id = aws_api_gateway_rest_api.api_gw.id
   52      stage_name  = aws_api_gateway_stage.api_gw_stage.stage_name
   53      method_path = "${aws_api_gateway_resource.api_gw_resource.path_part}/${aws_api_gateway_method.api_gw_method.http_method}"
   54    
   55      settings {
   56        logging_level        = "OFF"
   57        caching_enabled      = true # This is required for cache encryption
   58  [     cache_data_encrypted = false # This is required for cache encryption (false)
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-api-gateway-enable-cache-encryption
      Impact Data stored in the cache that is unencrypted may be vulnerable to compromise
  Resolution Enable cache encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/api-gateway/enable-cache-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted
────────────────────────────────────────────────────────────────────────────────


Result #3 LOW Authorization is not enabled for this method. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:26
────────────────────────────────────────────────────────────────────────────────
   22    resource "aws_api_gateway_method" "api_gw_method" {
   23      rest_api_id   = aws_api_gateway_rest_api.api_gw.id
   24      resource_id   = aws_api_gateway_resource.api_gw_resource.id
   25      http_method   = "GET"
   26  [   authorization = "NONE" ("NONE")
   27    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-api-gateway-no-public-access
      Impact API gateway methods can be accessed without authorization.
  Resolution Use and authorization method or require API Key

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/api-gateway/no-public-access/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method#authorization
────────────────────────────────────────────────────────────────────────────────


Result #4 LOW X-Ray tracing is not enabled, 
────────────────────────────────────────────────────────────────────────────────
  main.tf:44-48
────────────────────────────────────────────────────────────────────────────────
   44    resource "aws_api_gateway_stage" "api_gw_stage" {
   45      stage_name    = "prod"
   46      rest_api_id   = aws_api_gateway_rest_api.api_gw.id
   47      deployment_id = aws_api_gateway_deployment.api_gw_deploy.id
   48    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-api-gateway-enable-tracing
      Impact Without full tracing enabled it is difficult to trace the flow of logs
  Resolution Enable tracing

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/api-gateway/enable-tracing/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             3.032625ms
  parsing              603.667µs
  adaptation           75.125µs
  checks               3.53225ms
  total                7.243667ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     8
  files read           1

  results
  ──────────────────────────────────────────
  passed               2
  ignored              0
  critical             0
  high                 0
  medium               2
  low                  2

  2 passed, 4 potential problem(s) detected.



Result #1 CRITICAL Public cluster access is enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:22-24
────────────────────────────────────────────────────────────────────────────────
   19    resource "aws_eks_cluster" "test" {
   20      name = "test"
   21      role_arn = aws_iam_role.eksrole.arn
   22  ┌   vpc_config {
   23  │     subnet_ids = [aws_subnet.subnet1.id]
   24  └   }
   25    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-eks-no-public-cluster-access
      Impact EKS can be access from the internet
  Resolution Don't enable public access to EKS Clusters

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/eks/no-public-cluster-access/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Cluster allows access from a public CIDR: 0.0.0.0/0. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:22-24
────────────────────────────────────────────────────────────────────────────────
   19    resource "aws_eks_cluster" "test" {
   20      name = "test"
   21      role_arn = aws_iam_role.eksrole.arn
   22  ┌   vpc_config {
   23  │     subnet_ids = [aws_subnet.subnet1.id]
   24  └   }
   25    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-eks-no-public-cluster-access-to-cidr
      Impact EKS can be accessed from the internet
  Resolution Don't enable public access to EKS Clusters

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/eks/no-public-cluster-access-to-cidr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Cluster does not have secret encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:19-25
────────────────────────────────────────────────────────────────────────────────
   19    resource "aws_eks_cluster" "test" {
   20      name = "test"
   21      role_arn = aws_iam_role.eksrole.arn
   22      vpc_config {
   23        subnet_ids = [aws_subnet.subnet1.id]
   24      }
   25    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-eks-encrypt-secrets
      Impact EKS secrets could be read if compromised
  Resolution Enable encryption of EKS secrets

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/eks/encrypt-secrets/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config
────────────────────────────────────────────────────────────────────────────────


Result #4 MEDIUM VPC Flow Logs is not enabled for VPC  
────────────────────────────────────────────────────────────────────────────────
  main.tf:10-12
────────────────────────────────────────────────────────────────────────────────
   10    resource "aws_vpc" "vpc" {
   11      cidr_block = "10.0.0.0/16"
   12    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-require-vpc-flow-logs-for-all-vpcs
      Impact Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
  Resolution Enable flow logs for VPC

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/
────────────────────────────────────────────────────────────────────────────────


Results #5-9 MEDIUM Control plane authenticator logging is not enabled. (5 similar results)
────────────────────────────────────────────────────────────────────────────────
  main.tf:19-25
────────────────────────────────────────────────────────────────────────────────
   19    resource "aws_eks_cluster" "test" {
   20      name = "test"
   21      role_arn = aws_iam_role.eksrole.arn
   22      vpc_config {
   23        subnet_ids = [aws_subnet.subnet1.id]
   24      }
   25    }
────────────────────────────────────────────────────────────────────────────────
  Individual Causes
  - main.tf:19-25 (aws_eks_cluster.test) 5 instances
────────────────────────────────────────────────────────────────────────────────
          ID aws-eks-enable-control-plane-logging
      Impact Logging provides valuable information about access and usage
  Resolution Enable logging for the EKS control plane

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/eks/enable-control-plane-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             4.114667ms
  parsing              308.334µs
  adaptation           63.75µs
  checks               2.5915ms
  total                7.078251ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     5
  files read           1

  results
  ──────────────────────────────────────────
  passed               3
  ignored              0
  critical             2
  high                 1
  medium               6
  low                  0

  3 passed, 9 potential problem(s) detected.



Result #1 CRITICAL Domain does not enforce HTTPS. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:1-16
────────────────────────────────────────────────────────────────────────────────
    1  ┌ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  └   snapshot_options {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enforce-https
      Impact HTTP traffic can be intercepted and the contents read
  Resolution Enforce the use of HTTPS for ElasticSearch

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enforce-https/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Domain does not have in-transit encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:1-16
────────────────────────────────────────────────────────────────────────────────
    1  ┌ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  └   snapshot_options {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-in-transit-encryption
      Impact In transit data between nodes could be read if intercepted
  Resolution Enable encrypted node to node communication

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enable-in-transit-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Domain does not have at-rest encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:1-16
────────────────────────────────────────────────────────────────────────────────
    1  ┌ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  └   snapshot_options {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-domain-encryption
      Impact Data will be readable if compromised
  Resolution Enable ElasticSearch domain encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enable-domain-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Domain does not have a secure TLS policy. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:1-16
────────────────────────────────────────────────────────────────────────────────
    1  ┌ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  └   snapshot_options {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-use-secure-tls-policy
      Impact Outdated SSL policies increase exposure to known vulnerabilities
  Resolution Use the most modern TLS/SSL policies available

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/use-secure-tls-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy
────────────────────────────────────────────────────────────────────────────────


Result #5 MEDIUM Domain audit logging is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:1-16
────────────────────────────────────────────────────────────────────────────────
    1  ┌ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  └   snapshot_options {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-domain-logging
      Impact Logging provides vital information about access and usage
  Resolution Enable logging for ElasticSearch domains

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enable-domain-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             3.182125ms
  parsing              228.626µs
  adaptation           62.209µs
  checks               5.353791ms
  total                8.826751ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     1
  files read           1

  results
  ──────────────────────────────────────────
  passed               2
  ignored              0
  critical             1
  high                 3
  medium               1
  low                  0

  2 passed, 5 potential problem(s) detected.


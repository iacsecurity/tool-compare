
Result #1 CRITICAL Domain does not enforce HTTPS. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:5-13
────────────────────────────────────────────────────────────────────────────────
    5    resource "aws_elasticsearch_domain" "es-not-secure-policy" {
    6      domain_name = "es-not-secure-policy"
    7    
    8      ebs_options {
    9        ebs_enabled = true
   10        volume_size = 10
   11        volume_type = "gp2"
   12      }
   13    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enforce-https
      Impact HTTP traffic can be intercepted and the contents read
  Resolution Enforce the use of HTTPS for ElasticSearch

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enforce-https/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Domain does not have in-transit encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:5-13
────────────────────────────────────────────────────────────────────────────────
    5    resource "aws_elasticsearch_domain" "es-not-secure-policy" {
    6      domain_name = "es-not-secure-policy"
    7    
    8      ebs_options {
    9        ebs_enabled = true
   10        volume_size = 10
   11        volume_type = "gp2"
   12      }
   13    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-in-transit-encryption
      Impact In transit data between nodes could be read if intercepted
  Resolution Enable encrypted node to node communication

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enable-in-transit-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Domain does not have at-rest encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:5-13
────────────────────────────────────────────────────────────────────────────────
    5    resource "aws_elasticsearch_domain" "es-not-secure-policy" {
    6      domain_name = "es-not-secure-policy"
    7    
    8      ebs_options {
    9        ebs_enabled = true
   10        volume_size = 10
   11        volume_type = "gp2"
   12      }
   13    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-domain-encryption
      Impact Data will be readable if compromised
  Resolution Enable ElasticSearch domain encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enable-domain-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Domain does not have a secure TLS policy. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:5-13
────────────────────────────────────────────────────────────────────────────────
    5    resource "aws_elasticsearch_domain" "es-not-secure-policy" {
    6      domain_name = "es-not-secure-policy"
    7    
    8      ebs_options {
    9        ebs_enabled = true
   10        volume_size = 10
   11        volume_type = "gp2"
   12      }
   13    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-use-secure-tls-policy
      Impact Outdated SSL policies increase exposure to known vulnerabilities
  Resolution Use the most modern TLS/SSL policies available

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/use-secure-tls-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy
────────────────────────────────────────────────────────────────────────────────


Result #5 MEDIUM Domain audit logging is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:5-13
────────────────────────────────────────────────────────────────────────────────
    5    resource "aws_elasticsearch_domain" "es-not-secure-policy" {
    6      domain_name = "es-not-secure-policy"
    7    
    8      ebs_options {
    9        ebs_enabled = true
   10        volume_size = 10
   11        volume_type = "gp2"
   12      }
   13    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-domain-logging
      Impact Logging provides vital information about access and usage
  Resolution Enable logging for ElasticSearch domains

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elastic-search/enable-domain-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             5.562958ms
  parsing              273.959µs
  adaptation           71.917µs
  checks               3.733833ms
  total                9.642667ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     3
  files read           1

  results
  ──────────────────────────────────────────
  passed               2
  ignored              0
  critical             1
  high                 3
  medium               1
  low                  0

  2 passed, 5 potential problem(s) detected.


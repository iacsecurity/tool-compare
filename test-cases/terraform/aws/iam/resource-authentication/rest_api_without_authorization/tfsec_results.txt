
  Result 1

  [aws-api-gateway-enable-cache-encryption][MEDIUM] Resource 'aws_api_gateway_method_settings.api_gw_method_sett' does not have settings.cache_data_encrypted set to true
  /src/main.tf:58


      55 |   settings {
      56 |     logging_level        = "OFF"
      57 |     caching_enabled      = true # This is required for cache encryption
      58 |     cache_data_encrypted = false # This is required for cache encryption    bool: false
      59 |   }
      60 | }
      61 | 

  Impact:     Data stored in the cache that is unencrypted may be vulnerable to compromise
  Resolution: Enable cache encryption

  More Info:
  - https://aquasecurity.github.io/tfsec/latest/checks/aws/api-gateway/enable-cache-encryption 
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted 

  Result 2

  [aws-api-gateway-enable-tracing][LOW] Resource 'aws_api_gateway_stage.api_gw_stage' uses default value for xray_tracing_enabled
  /src/main.tf:44-48


      41 |   }
      42 | }
      43 | 
      44 | resource "aws_api_gateway_stage" "api_gw_stage" {
      45 |   stage_name    = "prod"
      46 |   rest_api_id   = aws_api_gateway_rest_api.api_gw.id
      47 |   deployment_id = aws_api_gateway_deployment.api_gw_deploy.id
      48 | }
      49 | 
      50 | resource "aws_api_gateway_method_settings" "api_gw_method_sett" {
      51 |   rest_api_id = aws_api_gateway_rest_api.api_gw.id

  Impact:     WIthout full tracing enabled it is difficult to trace the flow of logs
  Resolution: Enable tracing

  More Info:
  - https://aquasecurity.github.io/tfsec/latest/checks/aws/api-gateway/enable-tracing 
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled 

  Result 3

  [aws-api-gateway-no-public-access][LOW] Resource 'aws_api_gateway_method.api_gw_method' has authorization set to NONE
  /src/main.tf:26


      23 |   rest_api_id   = aws_api_gateway_rest_api.api_gw.id
      24 |   resource_id   = aws_api_gateway_resource.api_gw_resource.id
      25 |   http_method   = "GET"
      26 |   authorization = "NONE"    string: "NONE"
      27 | }
      28 | 
      29 | resource "aws_api_gateway_integration" "api_gw_int" {

  Impact:     API gateway methods can be unauthorized accessed
  Resolution: Use and authorization method or require API Key

  More Info:
  - https://aquasecurity.github.io/tfsec/latest/checks/aws/api-gateway/no-public-access 
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method#authorization 

  Result 4

  [aws-api-gateway-enable-access-logging][MEDIUM] Resource 'aws_api_gateway_stage.api_gw_stage' is missing access log settings block.
  /src/main.tf:44-48


      41 |   }
      42 | }
      43 | 
      44 | resource "aws_api_gateway_stage" "api_gw_stage" {
      45 |   stage_name    = "prod"
      46 |   rest_api_id   = aws_api_gateway_rest_api.api_gw.id
      47 |   deployment_id = aws_api_gateway_deployment.api_gw_deploy.id
      48 | }
      49 | 
      50 | resource "aws_api_gateway_method_settings" "api_gw_method_sett" {
      51 |   rest_api_id = aws_api_gateway_rest_api.api_gw.id

  Legacy ID:  AWS061
  Impact:     Logging provides vital information about access and usage
  Resolution: Enable logging for API Gateway stages

  More Info:
  - https://aquasecurity.github.io/tfsec/latest/checks/aws/api-gateway/enable-access-logging 
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_stage#access_log_settings 
  - https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-logging.html 

  times
  ------------------------------------------
  disk i/o             27.182667ms
  parsing HCL          624.417Âµs
  evaluating values    4.724ms
  running checks       25.314292ms

  counts
  ------------------------------------------
  files loaded         1
  blocks               8
  modules              0

  results
  ------------------------------------------
  critical             0
  high                 0
  medium               2
  low                  2
  ignored              0

  4 potential problems detected.


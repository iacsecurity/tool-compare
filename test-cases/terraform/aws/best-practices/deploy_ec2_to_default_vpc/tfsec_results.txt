
Result #1 HIGH Default VPC is used. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:12-16
────────────────────────────────────────────────────────────────────────────────
   12    resource "aws_default_vpc" "default" {
   13      tags = {
   14        Name = "Default VPC"
   15      }
   16    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-default-vpc
      Impact The default VPC does not have critical security features applied
  Resolution Create a non-default vpc for resources to be created in

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/ec2/no-default-vpc/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:49-53
────────────────────────────────────────────────────────────────────────────────
   49    resource "aws_instance" "t2-instance" {
   50      ami = data.aws_ami.ubuntu.id
   51      instance_type = "t2.micro"
   52      subnet_id = aws_subnet.default-subnet.id
   53    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:49-53
────────────────────────────────────────────────────────────────────────────────
   49    resource "aws_instance" "t2-instance" {
   50      ami = data.aws_ami.ubuntu.id
   51      instance_type = "t2.micro"
   52      subnet_id = aws_subnet.default-subnet.id
   53    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #4 MEDIUM VPC Flow Logs is not enabled for VPC  
────────────────────────────────────────────────────────────────────────────────
  main.tf:12-16
────────────────────────────────────────────────────────────────────────────────
   12    resource "aws_default_vpc" "default" {
   13      tags = {
   14        Name = "Default VPC"
   15      }
   16    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-require-vpc-flow-logs-for-all-vpcs
      Impact Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
  Resolution Enable flow logs for VPC

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             3.837375ms
  parsing              439.001µs
  adaptation           58.375µs
  checks               4.887375ms
  total                9.222126ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     8
  files read           1

  results
  ──────────────────────────────────────────
  passed               4
  ignored              0
  critical             0
  high                 3
  medium               1
  low                  0

  4 passed, 4 potential problem(s) detected.


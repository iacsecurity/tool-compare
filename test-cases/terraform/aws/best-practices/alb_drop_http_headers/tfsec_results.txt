
Result #1 HIGH Application load balancer is not set to drop invalid headers. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:25-30
────────────────────────────────────────────────────────────────────────────────
   25    resource "aws_lb" "default" {
   26      internal           = false
   27      load_balancer_type = "application"
   28      name               = "alb"
   29      subnets            = module.vpc.public_subnets
   30    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-drop-invalid-headers
      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities
  Resolution Set drop_invalid_header_fields to true

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/drop-invalid-headers/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Load balancer is exposed publicly. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:26
────────────────────────────────────────────────────────────────────────────────
   25    resource "aws_lb" "default" {
   26  [   internal           = false (false)
   27      load_balancer_type = "application"
   28      name               = "alb"
   29      subnets            = module.vpc.public_subnets
   30    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-alb-not-public
      Impact The load balancer is exposed on the internet
  Resolution Switch to an internal load balancer or add a tfsec ignore

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/alb-not-public/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Application load balancer is not set to drop invalid headers. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:32-37
────────────────────────────────────────────────────────────────────────────────
   32    resource "aws_alb" "default" {
   33      internal           = false
   34      load_balancer_type = "application"
   35      name               = "alb"
   36      subnets            = module.vpc.public_subnets
   37    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-drop-invalid-headers
      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities
  Resolution Set drop_invalid_header_fields to true

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/drop-invalid-headers/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Load balancer is exposed publicly. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:33
────────────────────────────────────────────────────────────────────────────────
   32    resource "aws_alb" "default" {
   33  [   internal           = false (false)
   34      load_balancer_type = "application"
   35      name               = "alb"
   36      subnets            = module.vpc.public_subnets
   37    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-alb-not-public
      Impact The load balancer is exposed on the internet
  Resolution Switch to an internal load balancer or add a tfsec ignore

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/alb-not-public/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Load balancer is exposed publicly. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:40
────────────────────────────────────────────────────────────────────────────────
   39    resource "aws_lb" "disabled" {
   40  [   internal           = false (false)
   41      load_balancer_type = "application"
   42      name               = "alb"
   43      subnets            = module.vpc.public_subnets
   44    
   45      drop_invalid_header_fields = false
   46    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-alb-not-public
      Impact The load balancer is exposed on the internet
  Resolution Switch to an internal load balancer or add a tfsec ignore

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/alb-not-public/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb
────────────────────────────────────────────────────────────────────────────────


Result #6 HIGH Application load balancer is not set to drop invalid headers. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:45
────────────────────────────────────────────────────────────────────────────────
   39    resource "aws_lb" "disabled" {
   40      internal           = false
   41      load_balancer_type = "application"
   42      name               = "alb"
   43      subnets            = module.vpc.public_subnets
   44    
   45  [   drop_invalid_header_fields = false (false)
   46    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-drop-invalid-headers
      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities
  Resolution Set drop_invalid_header_fields to true

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/drop-invalid-headers/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields
────────────────────────────────────────────────────────────────────────────────


Result #7 HIGH Load balancer is exposed publicly. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:49
────────────────────────────────────────────────────────────────────────────────
   48    resource "aws_alb" "disabled" {
   49  [   internal           = false (false)
   50      load_balancer_type = "application"
   51      name               = "alb"
   52      subnets            = module.vpc.public_subnets
   53    
   54      drop_invalid_header_fields = false
   55    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-alb-not-public
      Impact The load balancer is exposed on the internet
  Resolution Switch to an internal load balancer or add a tfsec ignore

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/alb-not-public/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb
────────────────────────────────────────────────────────────────────────────────


Result #8 HIGH Application load balancer is not set to drop invalid headers. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:54
────────────────────────────────────────────────────────────────────────────────
   48    resource "aws_alb" "disabled" {
   49      internal           = false
   50      load_balancer_type = "application"
   51      name               = "alb"
   52      subnets            = module.vpc.public_subnets
   53    
   54  [   drop_invalid_header_fields = false (false)
   55    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-elb-drop-invalid-headers
      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities
  Resolution Set drop_invalid_header_fields to true

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/elb/drop-invalid-headers/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields
────────────────────────────────────────────────────────────────────────────────


Results #9-11 HIGH Subnet associates public IP address. (3 similar results)
────────────────────────────────────────────────────────────────────────────────
  terraform-aws-modules/vpc/aws/src/.terraform/modules/vpc/main.tf:366
   via main.tf:1-23 (module.vpc)
────────────────────────────────────────────────────────────────────────────────
  359    resource "aws_subnet" "public" {
  ...  
  366  [   map_public_ip_on_launch         = var.map_public_ip_on_launch (true)
  ...  
  381    }
────────────────────────────────────────────────────────────────────────────────
  Individual Causes
  - terraform-aws-modules/vpc/aws/src/.terraform/modules/vpc/main.tf:1-23 (module.vpc) 3 instances
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ip-subnet
      Impact The instance is publicly accessible
  Resolution Set the instance to not be publicly accessible

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/ec2/no-public-ip-subnet/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch
────────────────────────────────────────────────────────────────────────────────


Result #12 MEDIUM VPC Flow Logs is not enabled for VPC  
────────────────────────────────────────────────────────────────────────────────
  terraform-aws-modules/vpc/aws/src/.terraform/modules/vpc/main.tf:20-43
   via main.tf:1-23 (module.vpc)
────────────────────────────────────────────────────────────────────────────────
   20  ┌ resource "aws_vpc" "this" {
   21  │   count = local.create_vpc ? 1 : 0
   22  │ 
   23  │   cidr_block          = var.use_ipam_pool ? null : var.cidr
   24  │   ipv4_ipam_pool_id   = var.ipv4_ipam_pool_id
   25  │   ipv4_netmask_length = var.ipv4_netmask_length
   26  │ 
   27  │   assign_generated_ipv6_cidr_block = var.enable_ipv6 && !var.use_ipam_pool ? true : null
   28  └   ipv6_cidr_block                  = var.ipv6_cidr
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-require-vpc-flow-logs-for-all-vpcs
      Impact Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
  Resolution Enable flow logs for VPC

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.1/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             19.047793ms
  parsing              164.214791ms
  adaptation           76.167µs
  checks               5.857625ms
  total                189.196376ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    2
  blocks processed     378
  files read           6

  results
  ──────────────────────────────────────────
  passed               5
  ignored              0
  critical             0
  high                 11
  medium               1
  low                  0

  5 passed, 12 potential problem(s) detected.


Failed to run the process ...
{
  "meta": {
    "isPrivate": true,
    "isLicensesEnabled": false,
    "ignoreSettings": null,
    "org": "yi2020",
    "projectId": "",
    "policy": ""
  },
  "filesystemPolicy": false,
  "vulnerabilities": [],
  "dependencyCount": 0,
  "licensesPolicy": null,
  "ignoreSettings": null,
  "targetFile": "main.tf",
  "projectName": "project",
  "org": "yi2020",
  "policy": "",
  "isPrivate": true,
  "targetFilePath": "/project/main.tf",
  "packageManager": "terraformconfig",
  "path": "/project",
  "projectType": "terraformconfig",
  "ok": false,
  "infrastructureAsCodeIssues": [
    {
      "severity": "low",
      "resolve": "Set `drop_invalid_header_fields` to `true`",
      "id": "SNYK-CC-AWS-405",
      "impact": "Maliciously crafted headers may be accepted by the load balancer",
      "msg": "resource.aws_lb[test]",
      "remediation": {
        "cloudformation": "Set `Properties.LoadBalancerAttributes.Key` to `routing.http.drop_invalid_header_fields.enabled` and `Properties.LoadBalancerAttributes.Value` to `true`",
        "terraform": "Set `drop_invalid_header_fields` to `true`"
      },
      "subType": "Elastic Load Balancing v2 (ALB/NLB)",
      "issue": "The application load balancer is not set to drop invalid headers.",
      "publicId": "SNYK-CC-AWS-405",
      "title": "ALB does not drop invalid headers",
      "references": [
        "https://docs.aws.amazon.com/config/latest/developerguide/alb-http-drop-invalid-header-enabled.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "The application load balancer is not set to drop invalid headers.",
        "impact": "Maliciously crafted headers may be accepted by the load balancer",
        "resolve": "Set `drop_invalid_header_fields` to `true`"
      },
      "lineNumber": 49,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-AWS-405",
      "path": [
        "resource",
        "aws_lb[test]"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `disable_api_termination` attribute  with value `true`",
      "id": "SNYK-CC-AWS-426",
      "impact": "Without this setting enabled the instances can be terminated by accident. This setting should only be used for instances with high availability requirements. Enabling this may prevent IaC workflows from updating the instance, for example terraform will not be able to terminate the instance to update instance type",
      "msg": "resource.aws_instance[inst1].disable_api_termination",
      "remediation": {
        "cloudformation": "Set `DisableApiTermination` attribute with value `true`",
        "terraform": "Set `disable_api_termination` attribute  with value `true`"
      },
      "subType": "EC2",
      "issue": "To prevent instance from being accidentally terminated using Amazon EC2, you can enable termination protection for the instance",
      "publicId": "SNYK-CC-AWS-426",
      "title": "EC2 API termination protection is not enabled",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/terminating-instances.html#Using_ChangingDisableAPITermination"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "To prevent instance from being accidentally terminated using Amazon EC2, you can enable termination protection for the instance",
        "impact": "Without this setting enabled the instances can be terminated by accident. This setting should only be used for instances with high availability requirements. Enabling this may prevent IaC workflows from updating the instance, for example terraform will not be able to terminate the instance to update instance type",
        "resolve": "Set `disable_api_termination` attribute  with value `true`"
      },
      "lineNumber": 82,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-AWS-426",
      "path": [
        "resource",
        "aws_instance[inst1]",
        "disable_api_termination"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `metadata_options.http_tokens` attribute to `required`",
      "id": "SNYK-CC-TF-130",
      "impact": "Metadata service may be vulnerable to reverse proxy/open firewall misconfigurations and server side request forgery attacks",
      "msg": "resource.aws_instance[inst2].metadata_options",
      "subType": "EC2",
      "issue": "Instance Metadata Service v2 is not enforced",
      "publicId": "SNYK-CC-TF-130",
      "title": "EC2 instance accepts IMDSv1",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html",
        "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "Instance Metadata Service v2 is not enforced",
        "impact": "Metadata service may be vulnerable to reverse proxy/open firewall misconfigurations and server side request forgery attacks",
        "resolve": "Set `metadata_options.http_tokens` attribute to `required`"
      },
      "lineNumber": 95,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-130",
      "path": [
        "resource",
        "aws_instance[inst2]",
        "metadata_options"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `disable_api_termination` attribute  with value `true`",
      "id": "SNYK-CC-AWS-426",
      "impact": "Without this setting enabled the instances can be terminated by accident. This setting should only be used for instances with high availability requirements. Enabling this may prevent IaC workflows from updating the instance, for example terraform will not be able to terminate the instance to update instance type",
      "msg": "resource.aws_instance[inst2].disable_api_termination",
      "remediation": {
        "cloudformation": "Set `DisableApiTermination` attribute with value `true`",
        "terraform": "Set `disable_api_termination` attribute  with value `true`"
      },
      "subType": "EC2",
      "issue": "To prevent instance from being accidentally terminated using Amazon EC2, you can enable termination protection for the instance",
      "publicId": "SNYK-CC-AWS-426",
      "title": "EC2 API termination protection is not enabled",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/terminating-instances.html#Using_ChangingDisableAPITermination"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "To prevent instance from being accidentally terminated using Amazon EC2, you can enable termination protection for the instance",
        "impact": "Without this setting enabled the instances can be terminated by accident. This setting should only be used for instances with high availability requirements. Enabling this may prevent IaC workflows from updating the instance, for example terraform will not be able to terminate the instance to update instance type",
        "resolve": "Set `disable_api_termination` attribute  with value `true`"
      },
      "lineNumber": 95,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-AWS-426",
      "path": [
        "resource",
        "aws_instance[inst2]",
        "disable_api_termination"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `metadata_options.http_tokens` attribute to `required`",
      "id": "SNYK-CC-TF-130",
      "impact": "Metadata service may be vulnerable to reverse proxy/open firewall misconfigurations and server side request forgery attacks",
      "msg": "resource.aws_instance[inst3].metadata_options",
      "subType": "EC2",
      "issue": "Instance Metadata Service v2 is not enforced",
      "publicId": "SNYK-CC-TF-130",
      "title": "EC2 instance accepts IMDSv1",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html",
        "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "Instance Metadata Service v2 is not enforced",
        "impact": "Metadata service may be vulnerable to reverse proxy/open firewall misconfigurations and server side request forgery attacks",
        "resolve": "Set `metadata_options.http_tokens` attribute to `required`"
      },
      "lineNumber": 108,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-130",
      "path": [
        "resource",
        "aws_instance[inst3]",
        "metadata_options"
      ]
    },
    {
      "severity": "medium",
      "resolve": "Set `root_block_device.encrypted` attribute to `true`",
      "id": "SNYK-CC-TF-53",
      "impact": "That should someone gain unauthorized access to the data they would be able to read the contents.",
      "msg": "resource.aws_instance[inst1].root_block_device.encrypted",
      "remediation": {
        "cloudformation": "Set `BlockDeviceMappings.Encrypted` attribute of root device to `true`",
        "terraform": "Set `root_block_device.encrypted` attribute to `true`"
      },
      "subType": "EC2",
      "issue": "The root block device for ec2 instance is not encrypted",
      "publicId": "SNYK-CC-TF-53",
      "title": "Non-Encrypted root block device",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html",
        "https://aws.amazon.com/premiumsupport/knowledge-center/cloudformation-root-volume-property/",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/device_naming.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "The root block device for ec2 instance is not encrypted",
        "impact": "That should someone gain unauthorized access to the data they would be able to read the contents.",
        "resolve": "Set `root_block_device.encrypted` attribute to `true`"
      },
      "lineNumber": 82,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-53",
      "path": [
        "resource",
        "aws_instance[inst1]",
        "root_block_device",
        "encrypted"
      ]
    },
    {
      "severity": "medium",
      "resolve": "Set `root_block_device.encrypted` attribute to `true`",
      "id": "SNYK-CC-TF-53",
      "impact": "That should someone gain unauthorized access to the data they would be able to read the contents.",
      "msg": "resource.aws_instance[inst2].root_block_device.encrypted",
      "remediation": {
        "cloudformation": "Set `BlockDeviceMappings.Encrypted` attribute of root device to `true`",
        "terraform": "Set `root_block_device.encrypted` attribute to `true`"
      },
      "subType": "EC2",
      "issue": "The root block device for ec2 instance is not encrypted",
      "publicId": "SNYK-CC-TF-53",
      "title": "Non-Encrypted root block device",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html",
        "https://aws.amazon.com/premiumsupport/knowledge-center/cloudformation-root-volume-property/",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/device_naming.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "The root block device for ec2 instance is not encrypted",
        "impact": "That should someone gain unauthorized access to the data they would be able to read the contents.",
        "resolve": "Set `root_block_device.encrypted` attribute to `true`"
      },
      "lineNumber": 95,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-53",
      "path": [
        "resource",
        "aws_instance[inst2]",
        "root_block_device",
        "encrypted"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `metadata_options.http_tokens` attribute to `required`",
      "id": "SNYK-CC-TF-130",
      "impact": "Metadata service may be vulnerable to reverse proxy/open firewall misconfigurations and server side request forgery attacks",
      "msg": "resource.aws_instance[inst1].metadata_options",
      "subType": "EC2",
      "issue": "Instance Metadata Service v2 is not enforced",
      "publicId": "SNYK-CC-TF-130",
      "title": "EC2 instance accepts IMDSv1",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html",
        "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "Instance Metadata Service v2 is not enforced",
        "impact": "Metadata service may be vulnerable to reverse proxy/open firewall misconfigurations and server side request forgery attacks",
        "resolve": "Set `metadata_options.http_tokens` attribute to `required`"
      },
      "lineNumber": 82,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-130",
      "path": [
        "resource",
        "aws_instance[inst1]",
        "metadata_options"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `disable_api_termination` attribute  with value `true`",
      "id": "SNYK-CC-AWS-426",
      "impact": "Without this setting enabled the instances can be terminated by accident. This setting should only be used for instances with high availability requirements. Enabling this may prevent IaC workflows from updating the instance, for example terraform will not be able to terminate the instance to update instance type",
      "msg": "resource.aws_instance[inst3].disable_api_termination",
      "remediation": {
        "cloudformation": "Set `DisableApiTermination` attribute with value `true`",
        "terraform": "Set `disable_api_termination` attribute  with value `true`"
      },
      "subType": "EC2",
      "issue": "To prevent instance from being accidentally terminated using Amazon EC2, you can enable termination protection for the instance",
      "publicId": "SNYK-CC-AWS-426",
      "title": "EC2 API termination protection is not enabled",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/terminating-instances.html#Using_ChangingDisableAPITermination"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "To prevent instance from being accidentally terminated using Amazon EC2, you can enable termination protection for the instance",
        "impact": "Without this setting enabled the instances can be terminated by accident. This setting should only be used for instances with high availability requirements. Enabling this may prevent IaC workflows from updating the instance, for example terraform will not be able to terminate the instance to update instance type",
        "resolve": "Set `disable_api_termination` attribute  with value `true`"
      },
      "lineNumber": 108,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-AWS-426",
      "path": [
        "resource",
        "aws_instance[inst3]",
        "disable_api_termination"
      ]
    },
    {
      "severity": "medium",
      "resolve": "Set `root_block_device.encrypted` attribute to `true`",
      "id": "SNYK-CC-TF-53",
      "impact": "That should someone gain unauthorized access to the data they would be able to read the contents.",
      "msg": "resource.aws_instance[inst3].root_block_device.encrypted",
      "remediation": {
        "cloudformation": "Set `BlockDeviceMappings.Encrypted` attribute of root device to `true`",
        "terraform": "Set `root_block_device.encrypted` attribute to `true`"
      },
      "subType": "EC2",
      "issue": "The root block device for ec2 instance is not encrypted",
      "publicId": "SNYK-CC-TF-53",
      "title": "Non-Encrypted root block device",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html",
        "https://aws.amazon.com/premiumsupport/knowledge-center/cloudformation-root-volume-property/",
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/device_naming.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "The root block device for ec2 instance is not encrypted",
        "impact": "That should someone gain unauthorized access to the data they would be able to read the contents.",
        "resolve": "Set `root_block_device.encrypted` attribute to `true`"
      },
      "lineNumber": 108,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-53",
      "path": [
        "resource",
        "aws_instance[inst3]",
        "root_block_device",
        "encrypted"
      ]
    }
  ]
}
